// Licensed to the Apache Software Foundation (ASF) under one
// or more contributor license agreements.  See the NOTICE file
// distributed with this work for additional information
// regarding copyright ownership.  The ASF licenses this file
// to you under the Apache License, Version 2.0 (the
// "License"); you may not use this file except in compliance
// with the License.  You may obtain a copy of the License at
//
//   http://www.apache.org/licenses/LICENSE-2.0
//
// Unless required by applicable law or agreed to in writing,
// software distributed under the License is distributed on an
// "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
// KIND, either express or implied.  See the License for the
// specific language governing permissions and limitations
// under the License.
(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports) :
    typeof define === 'function' && define.amd ? define(['exports'], factory) :
    (factory(global.Arrow = global.Arrow || {}));
}(this, (function (exports) {var h;const aa=new TextDecoder("utf-8"),ba=aa.decode.bind(aa),ca=new TextEncoder;const l=a=>typeof a==="function",m=a=>a!=null&&Object(a)===a,da=a=>"_getDOMStream"in a&&"_getNodeStream"in a,ea=a=>m(a)&&l(a.cancel)&&l(a.getReader)&&!da(a),fa=a=>m(a)&&l(a.read)&&l(a.pipe)&&typeof a.readable==="boolean"&&!da(a);const ha=typeof SharedArrayBuffer!=="undefined"?SharedArrayBuffer:ArrayBuffer;function ia(a){const b=a[0]?[a[0]]:[];let c,d,e,f;for(let g,k,n=0,q=0,t=a.length;++n<t;)g=b[q],k=a[n],!g||!k||g.buffer!==k.buffer||k.byteOffset<g.byteOffset?k&&(b[++q]=k):({byteOffset:c,byteLength:e}=g,{byteOffset:d,byteLength:f}=k,c+e<d||d+f<c?k&&(b[++q]=k):b[q]=new Uint8Array(g.buffer,c,d-c+f));return b}
function ja(a,b,c=0,d=b.byteLength){const e=a.byteLength,f=new Uint8Array(a.buffer,a.byteOffset,e);b=new Uint8Array(b.buffer,b.byteOffset,Math.min(d,e));f.set(b,c);return a}
function ka(a,b){a=ia(a);const c=a.reduce((n,q)=>n+q.byteLength,0);let d,e,f=0,g=-1;const k=Math.min(b||Number.POSITIVE_INFINITY,c);for(const n=a.length;++g<n;){b=a[g];d=b.subarray(0,Math.min(b.length,k-f));if(k<=f+d.length){d.length<b.length?a[g]=b.subarray(d.length):d.length===b.length&&g++;e?ja(e,d,f):e=d;break}ja(e||=new Uint8Array(k),d,f);f+=d.length}return[e||new Uint8Array(0),a.slice(g),c-(e?e.byteLength:0)]}
function p(a,b){b=m(b)&&"done"in b&&"value"in b?b.value:b;if(b instanceof a)return a===Uint8Array?new a(b.buffer,b.byteOffset,b.byteLength):b;if(!b)return new a(0);typeof b==="string"&&(b=ca.encode(b));return b instanceof ArrayBuffer||b instanceof ha?new a(b):m(b)&&l(b.clear)&&l(b.bytes)&&l(b.position)&&l(b.setPosition)&&l(b.capacity)&&l(b.getBufferIdentifier)&&l(b.createLong)?p(a,b.bytes()):ArrayBuffer.isView(b)?b.byteLength<=0?new a(0):new a(b.buffer,b.byteOffset,b.byteLength/a.BYTES_PER_ELEMENT):
a.from(b)}const la=a=>p(Uint8Array,a),ma=a=>{a.next();return a};function*na(a,b){function*c(d){yield d}b=typeof b==="string"?c(b):ArrayBuffer.isView(b)?c(b):b instanceof ArrayBuffer?c(b):b instanceof ha?c(b):m(b)&&l(b[Symbol.iterator])?b:c(b);yield*ma(function*(d){let e=null;do e=d.next(yield p(a,e));while(!e.done)}(b[Symbol.iterator]()));return new a}
async function*oa(a,b){async function*c(e){yield*ma(function*(f){let g=null;do g=f.next(yield g?.value);while(!g.done)}(e[Symbol.iterator]()))}async function*d(e){yield await e}if(m(b)&&l(b.then))return yield*oa(a,await b);b=typeof b==="string"?d(b):ArrayBuffer.isView(b)?d(b):b instanceof ArrayBuffer?d(b):b instanceof ha?d(b):m(b)&&l(b[Symbol.iterator])?c(b):m(b)&&l(b[Symbol.asyncIterator])?b:d(b);yield*ma(async function*(e){let f=null;do f=await e.next(yield p(a,f));while(!f.done)}(b[Symbol.asyncIterator]()));
return new a}function pa(a,b,c){if(a!==0){c=c.slice(0,b);for(let d=-1,e=c.length;++d<e;)c[d]+=a}return c.subarray(0,b)}function qa(a,b){let c=0;const d=a.length;if(d!==b.length)return!1;if(d>0){do if(a[c]!==b[c])return!1;while(++c<d)}return!0}var r={};r.compareArrayLike=qa;r.joinUint8Arrays=ka;r.memcpy=ja;r.rebaseValueOffsets=pa;r.toArrayBufferView=p;r.toArrayBufferViewAsyncIterator=oa;r.toArrayBufferViewIterator=na;r.toBigInt64Array=a=>p(BigInt64Array,a);r.toBigUint64Array=a=>p(BigUint64Array,a);
r.toFloat32Array=a=>p(Float32Array,a);r.toFloat32ArrayAsyncIterator=a=>oa(Float32Array,a);r.toFloat32ArrayIterator=a=>na(Float32Array,a);r.toFloat64Array=a=>p(Float64Array,a);r.toFloat64ArrayAsyncIterator=a=>oa(Float64Array,a);r.toFloat64ArrayIterator=a=>na(Float64Array,a);r.toInt16Array=a=>p(Int16Array,a);r.toInt16ArrayAsyncIterator=a=>oa(Int16Array,a);r.toInt16ArrayIterator=a=>na(Int16Array,a);r.toInt32Array=a=>p(Int32Array,a);r.toInt32ArrayAsyncIterator=a=>oa(Int32Array,a);
r.toInt32ArrayIterator=a=>na(Int32Array,a);r.toInt8Array=a=>p(Int8Array,a);r.toInt8ArrayAsyncIterator=a=>oa(Int8Array,a);r.toInt8ArrayIterator=a=>na(Int8Array,a);r.toUint16Array=a=>p(Uint16Array,a);r.toUint16ArrayAsyncIterator=a=>oa(Uint16Array,a);r.toUint16ArrayIterator=a=>na(Uint16Array,a);r.toUint32Array=a=>p(Uint32Array,a);r.toUint32ArrayAsyncIterator=a=>oa(Uint32Array,a);r.toUint32ArrayIterator=a=>na(Uint32Array,a);r.toUint8Array=la;r.toUint8ArrayAsyncIterator=a=>oa(Uint8Array,a);
r.toUint8ArrayIterator=a=>na(Uint8Array,a);r.toUint8ClampedArray=a=>p(Uint8ClampedArray,a);r.toUint8ClampedArrayAsyncIterator=a=>oa(Uint8ClampedArray,a);r.toUint8ClampedArrayIterator=a=>na(Uint8ClampedArray,a);function ra(){throw Error('"toDOMStream" not available in this environment');}function sa(){throw Error('"toNodeStream" not available in this environment');}const ta=a=>{a.next();return a};
function*ua(a){let b,c=!1,d=[],e,f,g,k=0;({N:f,size:g}=(yield null)||{N:"read",size:0});a=na(Uint8Array,a)[Symbol.iterator]();try{do if({done:b,value:e}=Number.isNaN(g-k)?a.next():a.next(g-k),!b&&e.byteLength>0&&(d.push(e),k+=e.byteLength),b||g<=k){do{if(f==="peek")var n=ka(d,g)[0];else[e,d,k]=ka(d,g),n=e;({N:f,size:g}=yield n)}while(g<k)}while(!b)}catch(q){c=!0,typeof a.throw==="function"&&a.throw(q)}finally{c===!1&&typeof a.return==="function"&&a.return(null)}return null}
async function*wa(a){let b,c=!1,d=[],e,f,g,k=0;({N:f,size:g}=(yield null)||{N:"read",size:0});a=oa(Uint8Array,a)[Symbol.asyncIterator]();try{do if({done:b,value:e}=Number.isNaN(g-k)?await a.next():await a.next(g-k),!b&&e.byteLength>0&&(d.push(e),k+=e.byteLength),b||g<=k){do{if(f==="peek")var n=ka(d,g)[0];else[e,d,k]=ka(d,g),n=e;({N:f,size:g}=yield n)}while(g<k)}while(!b)}catch(q){c=!0,typeof a.throw==="function"&&await a.throw(q)}finally{c===!1&&typeof a.return==="function"&&await a.return(new Uint8Array(0))}return null}
async function*xa(a){let b=!1,c=!1,d=[],e,f,g,k=0;({N:f,size:g}=(yield null)||{N:"read",size:0});const n=new ya(a);try{do if({done:b,value:e}=Number.isNaN(g-k)?await n.read():await n.read(g-k),!b&&e.byteLength>0&&(d.push(p(Uint8Array,e)),k+=e.byteLength),b||g<=k){do{if(f==="peek")var q=ka(d,g)[0];else[e,d,k]=ka(d,g),q=e;({N:f,size:g}=yield q)}while(g<k)}while(!b)}catch(t){c=!0,await n.cancel(t)}finally{c===!1?await n.cancel():a.locked&&n.releaseLock()}return null}
class ya{constructor(a){this.source=a;this.U=null;this.U=this.source.getReader();this.U.closed.catch(()=>{})}get closed(){return this.U?this.U.closed.catch(()=>{}):Promise.resolve()}releaseLock(){this.U&&this.U.releaseLock();this.U=null}async cancel(a){const b=this.U,c=this.source;b&&await b.cancel(a).catch(()=>{});c&&c.locked&&this.releaseLock()}async read(a){if(a===0)return{done:this.U==null,value:new Uint8Array(0)};a=await this.U.read();!a.done&&(a.value=p(Uint8Array,a));return a}}
const za=(a,b)=>{const c=e=>d([b,e]);let d;return[b,c,new Promise(e=>(d=e)&&a.once(b,c))]};
async function*Aa(a){function b(mb,Ab){t=q=null;return new Promise((Zi,$i)=>{for(const [Bb,aj]of mb)a.off(Bb,aj);try{const Bb=a.destroy;Bb&&Bb.call(a,Ab);Ab=void 0}catch(Bb){Ab=Bb||Ab}finally{Ab!=null?$i(Ab):Zi()}})}const c=[];let d="error",e=!1,f=null,g,k,n=0,q=[],t;({N:g,size:k}=(yield null)||{N:"read",size:0});if(a.isTTY)return yield new Uint8Array(0),null;try{c[0]=za(a,"end");c[1]=za(a,"error");do{c[2]=za(a,"readable");[d,f]=await Promise.race(c.map(mb=>mb[2]));if(d==="error")break;(e=d==="end")||
(Number.isFinite(k-n)?(t=la(a.read(k-n)),t.byteLength<k-n&&(t=la(a.read()))):t=la(a.read()),t.byteLength>0&&(q.push(t),n+=t.byteLength));if(e||k<=n){do{if(g==="peek")var va=ka(q,k)[0];else[t,q,n]=ka(q,k),va=t;({N:g,size:k}=yield va)}while(k<n)}}while(!e)}finally{await b(c,d==="error"?f:null)}return null};var u,Ba=u||={};Ba[Ba.V1=0]="V1";Ba[Ba.V2=1]="V2";Ba[Ba.V3=2]="V3";Ba[Ba.V4=3]="V4";Ba[Ba.V5=4]="V5";var v,Ca=v||={};Ca[Ca.Sparse=0]="Sparse";Ca[Ca.Dense=1]="Dense";var w,Da=w||={};Da[Da.HALF=0]="HALF";Da[Da.SINGLE=1]="SINGLE";Da[Da.DOUBLE=2]="DOUBLE";var Ea,Fa=Ea||={};Fa[Fa.DAY=0]="DAY";Fa[Fa.MILLISECOND=1]="MILLISECOND";var x,Ga=x||={};Ga[Ga.SECOND=0]="SECOND";Ga[Ga.MILLISECOND=1]="MILLISECOND";Ga[Ga.MICROSECOND=2]="MICROSECOND";Ga[Ga.NANOSECOND=3]="NANOSECOND";var y,Ha=y||={};Ha[Ha.YEAR_MONTH=0]="YEAR_MONTH";Ha[Ha.DAY_TIME=1]="DAY_TIME";Ha[Ha.MONTH_DAY_NANO=2]="MONTH_DAY_NANO";const Ia=new Int32Array(2);new Float32Array(Ia.buffer);new Float64Array(Ia.buffer);new Uint16Array((new Uint8Array([1,0])).buffer);var Ja,Ka=Ja||={};Ka[Ka.UTF8_BYTES=1]="UTF8_BYTES";Ka[Ka.UTF16_STRING=2]="UTF16_STRING";function La(a,b){return(a.l[b]|a.l[b+1]<<8)<<16>>16}function Ma(a,b){return BigInt.asIntN(64,BigInt(a.v(b)>>>0)+(BigInt(a.v(b+4)>>>0)<<BigInt(32)))}function z(a,b,c){b-=a.v(b);return c<La(a,b)?La(a,b+c):0}function Na(a,b,c){b.h=c+a.v(c);b.g=a;return b}function Oa(a,b,c){b+=a.v(b);const d=a.v(b);b+=4;b=a.l.subarray(b,b+d);return c===Ja.UTF8_BYTES?b:a.dc.decode(b)}function Pa(a,b){return b+a.v(b)}function Qa(a,b){return b+a.v(b)+4}function Ra(a,b){return a.v(b+a.v(b))}
class Sa{constructor(a){this.l=a;this.hb=0;this.dc=new TextDecoder}clear(){this.hb=0}bytes(){return this.l}position(){return this.hb}setPosition(a){this.hb=a}v(a){return this.l[a]|this.l[a+1]<<8|this.l[a+2]<<16|this.l[a+3]<<24}ha(a,b){this.l[a]=b}mb(a,b){this.l[a]=b;this.l[a+1]=b>>8}W(a,b){this.l[a]=b;this.l[a+1]=b>>8;this.l[a+2]=b>>16;this.l[a+3]=b>>24}X(a,b){this.W(a,Number(BigInt.asIntN(32,b)));this.W(a+4,Number(BigInt.asIntN(32,b>>BigInt(32))))}};function Ta(a){return a.g.bytes().subarray(a.g.position(),a.g.position()+a.offset())}function Ua(a,b,c){b>a.ua&&(a.ua=b);const d=~(a.g.l.length-a.C+c)+1&b-1;for(;a.C<d+b+c;){const g=a.g.l.length;var e=a,f=a.g;const k=f.l.length;if(k&3221225472)throw Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=k<<1,q=new Sa(new Uint8Array(n));q.setPosition(n-k);q.bytes().set(f.bytes(),n-k);e.g=q;a.C+=a.g.l.length-g}a.pad(d)}function Va(a,b){Ua(a,2,0);a.mb(b)}
function Wa(a,b){Ua(a,4,0);a.W(b)}function Xa(a,b,c,d){if(a.da||c!=d)Ua(a,1,0),a.ha(c),a.slot(b)}function Ya(a,b,c){if(a.da||b!=c)Va(a,b),a.slot(0)}function Za(a,b,c,d){if(a.da||c!=d)Wa(a,c),a.slot(b)}function $a(a,b,c){var d=BigInt("0");if(a.da||c!==d)Ua(a,8,0),a.X(c),a.slot(b)}function ab(a,b){Ua(a,4,0);a.W(a.offset()-b+4)}function A(a,b,c){if(a.da||c!=0)ab(a,c),a.slot(b)}function bb(a){if(a.sa)throw new TypeError("FlatBuffers: object serialization must not be nested.");}
function B(a,b){bb(a);a.V==null&&(a.V=[]);a.lb=b;for(let c=0;c<b;c++)a.V[c]=0;a.sa=!0;a.gb=a.offset()}
function C(a){if(a.V==null||!a.sa)throw Error("FlatBuffers: endObject called without startObject");Wa(a,0);const b=a.offset();let c=a.lb-1;for(;c>=0&&a.V[c]==0;c--);for(var d=c+1;c>=0;c--)Va(a,a.V[c]!=0?b-a.V[c]:0);Va(a,b-a.gb);d=(d+2)*2;Va(a,d);let e=0;const f=a.C;c=0;a:for(;c<a.va.length;c++){const g=a.g.l.length-a.va[c];if(d==La(a.g,g)){for(let k=2;k<d;k+=2)if(La(a.g,f+k)!=La(a.g,g+k))continue a;e=a.va[c];break}}e?(a.C=a.g.l.length-b,a.g.W(a.C,e-b)):(a.va.push(a.offset()),a.g.W(a.g.l.length-b,
a.offset()-b));a.sa=!1;return b}function cb(a,b,c,d){bb(a);a.kb=c;Ua(a,4,b*c);Ua(a,d,b*c)}function db(a){a.W(a.kb);return a.offset()}function eb(a,b){if(b===null||b===void 0)return 0;b=b instanceof Uint8Array?b:a.ec.encode(b);Ua(a,1,0);a.ha(0);cb(a,1,b.length,1);a.g.setPosition(a.C-=b.length);a.g.bytes().set(b,a.C);return db(a)}
class fb{constructor(){this.ua=1;this.V=null;this.lb=0;this.sa=!1;this.gb=0;this.va=[];this.kb=0;this.da=!1;this.ec=new TextEncoder;this.g=new Sa(new Uint8Array(1024));this.C=1024}clear(){this.g.clear();this.C=this.g.l.length;this.ua=1;this.V=null;this.lb=0;this.sa=!1;this.gb=0;this.va=[];this.kb=0;this.da=!1}pad(a){for(let b=0;b<a;b++)this.g.ha(--this.C,0)}ha(a){this.g.ha(--this.C,a)}mb(a){this.g.mb(this.C-=2,a)}W(a){this.g.W(this.C-=4,a)}X(a){this.g.X(this.C-=8,a)}slot(a){this.V!==null&&(this.V[a]=
this.offset())}offset(){return this.g.l.length-this.C}finish(a,b,c){c=c?4:0;if(b){Ua(this,this.ua,8+c);if(b.length!=4)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let d=3;d>=0;d--)this.ha(b.charCodeAt(d))}Ua(this,this.ua,4+c);ab(this,a);c&&Wa(this,this.g.l.length-this.C);this.g.setPosition(this.C)}};var gb,hb=gb||={};hb[hb.BUFFER=0]="BUFFER";var ib,jb=ib||={};jb[jb.LZ4_FRAME=0]="LZ4_FRAME";jb[jb.ZSTD=1]="ZSTD";class kb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}codec(){const a=z(this.g,this.h,4);return a?this.g.l[this.h+a]<<24>>24:ib.LZ4_FRAME}method(){const a=z(this.g,this.h,6);return a?this.g.l[this.h+a]<<24>>24:gb.nb}};class lb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return Ma(this.g,this.h)}length(){return Ma(this.g,this.h+8)}};class nb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){return Ma(this.g,this.h)}nullCount(){return Ma(this.g,this.h+8)}};function ob(a){const b=z(a.g,a.h,6);return b?Ra(a.g,a.h+b):0}function pb(a){const b=z(a.g,a.h,8);return b?Ra(a.g,a.h+b):0}
class qb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}length(){const a=z(this.g,this.h,4);return a?Ma(this.g,this.h+a):BigInt("0")}H(a,b){const c=z(this.g,this.h,6);return c?(b||new nb).i(Qa(this.g,this.h+c)+a*16,this.g):null}buffers(a,b){const c=z(this.g,this.h,8);return c?(b||new lb).i(Qa(this.g,this.h+c)+a*16,this.g):null}compression(a){const b=z(this.g,this.h,10);return b?(a||new kb).i(Pa(this.g,this.h+b),this.g):null}};class rb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=z(this.g,this.h,4);return a?Ma(this.g,this.h+a):BigInt("0")}data(a){const b=z(this.g,this.h,6);return b?(a||new qb).i(Pa(this.g,this.h+b),this.g):null}Ka(){const a=z(this.g,this.h,8);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};var sb,tb=sb||={};tb[tb.Little=0]="Little";tb[tb.Big=1]="Big";var ub,vb=ub||={};vb[vb.DenseArray=0]="DenseArray";class wb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}bitWidth(){const a=z(this.g,this.h,4);return a?this.g.v(this.h+a):0}isSigned(){const a=z(this.g,this.h,6);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};function xb(a){const b=z(a.g,a.h,6);return b?(new wb).i(Pa(a.g,a.h+b),a.g):null}class yb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}id(){const a=z(this.g,this.h,4);return a?Ma(this.g,this.h+a):BigInt("0")}isOrdered(){const a=z(this.g,this.h,8);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};class zb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}key(a){const b=z(this.g,this.h,4);return b?Oa(this.g,this.h+b,a):null}value(a){const b=z(this.g,this.h,6);return b?Oa(this.g,this.h+b,a):null}};class Cb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):Ea.MILLISECOND}};class Db{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=z(this.g,this.h,4);return a?this.g.v(this.h+a):0}scale(){const a=z(this.g,this.h,6);return a?this.g.v(this.h+a):0}bitWidth(){const a=z(this.g,this.h,8);return a?this.g.v(this.h+a):128}};class Eb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):x.MILLISECOND}};class Fb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}byteWidth(){const a=z(this.g,this.h,4);return a?this.g.v(this.h+a):0}};class Gb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}listSize(){const a=z(this.g,this.h,4);return a?this.g.v(this.h+a):0}};class Hb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}precision(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):w.HALF}};class Ib{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):y.YEAR_MONTH}};class Jb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}keysSorted(){const a=z(this.g,this.h,4);return a?!!(this.g.l[this.h+a]<<24>>24):!1}};class Kb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):x.MILLISECOND}bitWidth(){const a=z(this.g,this.h,6);return a?this.g.v(this.h+a):32}};class Lb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}unit(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):x.SECOND}timezone(a){const b=z(this.g,this.h,6);return b?Oa(this.g,this.h+b,a):null}};class Mb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}mode(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):v.Sparse}typeIds(a){const b=z(this.g,this.h,6);return b?this.g.v(Qa(this.g,this.h+b)+a*4):0}};var D,E=D||={};E[E.NONE=0]="NONE";E[E.Null=1]="Null";E[E.Int=2]="Int";E[E.FloatingPoint=3]="FloatingPoint";E[E.Binary=4]="Binary";E[E.Utf8=5]="Utf8";E[E.Bool=6]="Bool";E[E.Decimal=7]="Decimal";E[E.Date=8]="Date";E[E.Time=9]="Time";E[E.Timestamp=10]="Timestamp";E[E.Interval=11]="Interval";E[E.List=12]="List";E[E.Struct_=13]="Struct_";E[E.Union=14]="Union";E[E.FixedSizeBinary=15]="FixedSizeBinary";E[E.FixedSizeList=16]="FixedSizeList";E[E.Map=17]="Map";E[E.Duration=18]="Duration";
E[E.LargeBinary=19]="LargeBinary";E[E.LargeUtf8=20]="LargeUtf8";E[E.LargeList=21]="LargeList";E[E.RunEndEncoded=22]="RunEndEncoded";function Nb(a,b){cb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ab(a,b[c]);return db(a)}function Ob(a,b){cb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ab(a,b[c]);return db(a)}function Pb(a){const b=z(a.g,a.h,14);return b?Ra(a.g,a.h+b):0}
class Qb{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}name(a){const b=z(this.g,this.h,4);return b?Oa(this.g,this.h+b,a):null}nullable(){const a=z(this.g,this.h,6);return a?!!(this.g.l[this.h+a]<<24>>24):!1}type(a){const b=z(this.g,this.h,10);return b?Na(this.g,a,this.h+b):null}dictionary(a){const b=z(this.g,this.h,12);return b?(a||new yb).i(Pa(this.g,this.h+b),this.g):null}children(a,b){const c=z(this.g,this.h,14);return c?(b||new Qb).i(Pa(this.g,Qa(this.g,this.h+c)+a*4),
this.g):null}Ha(a){const b=z(this.g,this.h,16);return b?(new zb).i(Pa(this.g,Qa(this.g,this.h+b)+a*4),this.g):null}Ia(){const a=z(this.g,this.h,16);return a?Ra(this.g,this.h+a):0}};function Rb(a,b){cb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ab(a,b[c]);return db(a)}function Sb(a,b){cb(a,4,b.length,4);for(let c=b.length-1;c>=0;c--)ab(a,b[c]);return db(a)}function Tb(a){const b=z(a.g,a.h,6);return b?Ra(a.g,a.h+b):0}
class Ub{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}fields(a,b){const c=z(this.g,this.h,6);return c?(b||new Qb).i(Pa(this.g,Qa(this.g,this.h+c)+a*4),this.g):null}Ha(a){const b=z(this.g,this.h,8);return b?(new zb).i(Pa(this.g,Qa(this.g,this.h+b)+a*4),this.g):null}Ia(){const a=z(this.g,this.h,8);return a?Ra(this.g,this.h+a):0}features(a){const b=z(this.g,this.h,10);return b?Ma(this.g,Qa(this.g,this.h+b)+a*8):BigInt(0)}};var Vb,Wb=Vb||={};Wb[Wb.Row=0]="Row";Wb[Wb.Column=1]="Column";var Xb,Yb=Xb||={};Yb[Yb.NONE=0]="NONE";Yb[Yb.SparseTensorIndexCOO=1]="SparseTensorIndexCOO";Yb[Yb.SparseMatrixIndexCSX=2]="SparseMatrixIndexCSX";Yb[Yb.SparseTensorIndexCSF=3]="SparseTensorIndexCSF";var F,Zb=F||={};Zb[Zb.NONE=0]="NONE";Zb[Zb.Schema=1]="Schema";Zb[Zb.DictionaryBatch=2]="DictionaryBatch";Zb[Zb.RecordBatch=3]="RecordBatch";Zb[Zb.Tensor=4]="Tensor";Zb[Zb.SparseTensor=5]="SparseTensor";var G,H=G||={};H[H.NONE=0]="NONE";H[H.Null=1]="Null";H[H.Int=2]="Int";H[H.Float=3]="Float";H[H.Binary=4]="Binary";H[H.Utf8=5]="Utf8";H[H.Bool=6]="Bool";H[H.Decimal=7]="Decimal";H[H.Date=8]="Date";H[H.Time=9]="Time";H[H.Timestamp=10]="Timestamp";H[H.Interval=11]="Interval";H[H.List=12]="List";H[H.Struct=13]="Struct";H[H.Union=14]="Union";H[H.FixedSizeBinary=15]="FixedSizeBinary";H[H.FixedSizeList=16]="FixedSizeList";H[H.Map=17]="Map";H[H.Duration=18]="Duration";H[H.LargeBinary=19]="LargeBinary";
H[H.LargeUtf8=20]="LargeUtf8";H[H.Dictionary=-1]="Dictionary";H[H.Int8=-2]="Int8";H[H.Int16=-3]="Int16";H[H.Int32=-4]="Int32";H[H.Int64=-5]="Int64";H[H.Uint8=-6]="Uint8";H[H.Uint16=-7]="Uint16";H[H.Uint32=-8]="Uint32";H[H.Uint64=-9]="Uint64";H[H.Float16=-10]="Float16";H[H.Float32=-11]="Float32";H[H.Float64=-12]="Float64";H[H.DateDay=-13]="DateDay";H[H.DateMillisecond=-14]="DateMillisecond";H[H.TimestampSecond=-15]="TimestampSecond";H[H.TimestampMillisecond=-16]="TimestampMillisecond";
H[H.TimestampMicrosecond=-17]="TimestampMicrosecond";H[H.TimestampNanosecond=-18]="TimestampNanosecond";H[H.TimeSecond=-19]="TimeSecond";H[H.TimeMillisecond=-20]="TimeMillisecond";H[H.TimeMicrosecond=-21]="TimeMicrosecond";H[H.TimeNanosecond=-22]="TimeNanosecond";H[H.DenseUnion=-23]="DenseUnion";H[H.SparseUnion=-24]="SparseUnion";H[H.IntervalDayTime=-25]="IntervalDayTime";H[H.IntervalYearMonth=-26]="IntervalYearMonth";H[H.DurationSecond=-27]="DurationSecond";H[H.DurationMillisecond=-28]="DurationMillisecond";
H[H.DurationMicrosecond=-29]="DurationMicrosecond";H[H.DurationNanosecond=-30]="DurationNanosecond";H[H.IntervalMonthDayNano=-31]="IntervalMonthDayNano";var $b,ac=$b||={};ac[ac.OFFSET=0]="OFFSET";ac[ac.DATA=1]="DATA";ac[ac.VALIDITY=2]="VALIDITY";ac[ac.TYPE=3]="TYPE";function bc(a){if(a===null)return"null";if(a===void 0)return"undefined";switch(typeof a){case "number":return`${a}`;case "bigint":return`${a}`;case "string":return`"${a}"`}return typeof a[Symbol.toPrimitive]==="function"?a[Symbol.toPrimitive]("string"):ArrayBuffer.isView(a)?a instanceof BigInt64Array||a instanceof BigUint64Array?`[${[...a].map(b=>bc(b))}]`:`[${a}]`:ArrayBuffer.isView(a)?`[${a}]`:JSON.stringify(a,(b,c)=>typeof c==="bigint"?`${c}`:c)}var cc={};cc.valueToString=bc;function I(a){if(typeof a==="bigint"&&(a<Number.MIN_SAFE_INTEGER||a>Number.MAX_SAFE_INTEGER))throw new TypeError(`${a} is not safe to convert to a number.`);return Number(a)}function dc(a,b){return I(a/b)+I(a%b)/I(b)};const ec=Symbol.for("isArrowBigNum");function fc(a,...b){return b.length===0?Object.setPrototypeOf(p(this.TypedArray,a),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(a,...b),this.constructor.prototype)}fc.prototype[ec]=!0;fc.prototype.toJSON=function(){return`"${hc(this)}"`};fc.prototype.valueOf=function(a){return ic(this,a)};fc.prototype.toString=function(){return hc(this)};fc.prototype[Symbol.toPrimitive]=function(a="default"){switch(a){case "number":return ic(this);case "default":return jc(this)}return hc(this)};
function kc(...a){return fc.apply(this,a)}function lc(...a){return fc.apply(this,a)}function mc(...a){return fc.apply(this,a)}Object.setPrototypeOf(kc.prototype,Object.create(Int32Array.prototype));Object.setPrototypeOf(lc.prototype,Object.create(Uint32Array.prototype));Object.setPrototypeOf(mc.prototype,Object.create(Uint32Array.prototype));Object.assign(kc.prototype,fc.prototype,{constructor:kc,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array});
Object.assign(lc.prototype,fc.prototype,{constructor:lc,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array});Object.assign(mc.prototype,fc.prototype,{constructor:mc,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const nc=BigInt(4294967296)*BigInt(4294967296)-BigInt(1);
function ic(a,b){const {buffer:c,byteOffset:d,byteLength:e,signed:f}=a,g=new BigUint64Array(c,d,e/8);a=f&&g.at(-1)&BigInt(1)<<BigInt(63);var k=BigInt(0);let n=0;if(a){for(var q of g)k|=(q^nc)*(BigInt(1)<<BigInt(64*n++));k*=BigInt(-1);k-=BigInt(1)}else for(var t of g)k|=t*(BigInt(1)<<BigInt(64*n++));return typeof b==="number"&&b>0?(t=BigInt("1".padEnd(b+1,"0")),q=a?-(k%t):k%t,k=I(k/t),+`${a&&k===0?"-":""}${k}.${`${q}`.padStart(b,"0")}`):I(k)}
function hc(a){if(a.byteLength===8)return`${(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]}`;if(!a.signed)return oc(a);let b=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);if((new Int16Array([b.at(-1)]))[0]>=0)return oc(a);b=b.slice();a=1;for(let c=0;c<b.length;c++){const d=b[c];b[c]=~d+a;a&=d===0?1:0}return`-${oc(b)}`}function jc(a){return a.byteLength===8?(new a.BigIntArray(a.buffer,a.byteOffset,1))[0]:hc(a)}
function oc(a){let b="";const c=new Uint32Array(2);a=new Uint16Array(a.buffer,a.byteOffset,a.byteLength/2);const d=new Uint32Array((a=(new Uint16Array(a)).reverse()).buffer);let e;const f=a.length-1;do{for(c[0]=a[e=0];e<f;)a[e++]=c[1]=c[0]/10,c[0]=(c[0]-c[1]*10<<16)+a[e];a[e]=c[1]=c[0]/10;c[0]-=c[1]*10;b=`${c[0]}${b}`}while(d[0]||d[1]||d[2]||d[3]);return b??"0"}
class pc{static new(a,b){switch(b){case !0:return new kc(a);case !1:return new lc(a)}switch(a.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new kc(a)}return a.byteLength===16?new mc(a):new lc(a)}static lc(a){return new kc(a)}constructor(a,b){return pc.new(a,b)}}var qc={};qc.BN=pc;qc.bigNumToBigInt=jc;qc.bigNumToNumber=ic;qc.bigNumToString=hc;qc.isArrowBigNumSymbol=ec;class J{static isNull(a){return a?.typeId===G.Null}static isInt(a){return a?.typeId===G.Int}static isFloat(a){return a?.typeId===G.Float}static isBinary(a){return a?.typeId===G.Binary}static isLargeBinary(a){return a?.typeId===G.LargeBinary}static isUtf8(a){return a?.typeId===G.Utf8}static isLargeUtf8(a){return a?.typeId===G.LargeUtf8}static isBool(a){return a?.typeId===G.Bool}static isDecimal(a){return a?.typeId===G.Decimal}static isDate(a){return a?.typeId===G.Date}static isTime(a){return a?.typeId===
G.Time}static isTimestamp(a){return a?.typeId===G.Timestamp}static isInterval(a){return a?.typeId===G.Interval}static isDuration(a){return a?.typeId===G.Duration}static isList(a){return a?.typeId===G.List}static isStruct(a){return a?.typeId===G.Struct}static isUnion(a){return a?.typeId===G.Union}static isFixedSizeBinary(a){return a?.typeId===G.FixedSizeBinary}static isFixedSizeList(a){return a?.typeId===G.FixedSizeList}static isMap(a){return a?.typeId===G.Map}static isDictionary(a){return a?.typeId===
G.Dictionary}static isDenseUnion(a){return J.isUnion(a)&&a.mode===v.Dense}static isSparseUnion(a){return J.isUnion(a)&&a.mode===v.Sparse}constructor(a){this.typeId=a}}var rc=Symbol.toStringTag,sc,tc=J.prototype;tc.children=null;tc.ArrayType=Array;tc.OffsetArrayType=Int32Array;sc=tc[Symbol.toStringTag]="DataType";J[rc]=sc;class uc extends J{constructor(){super(G.Null)}toString(){return"Null"}}uc[Symbol.toStringTag]=uc.prototype[Symbol.toStringTag]="Null";
class vc extends J{constructor(a,b){super(G.Int);this.isSigned=a;this.bitWidth=b}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}var wc=Symbol.toStringTag,xc,yc=vc.prototype;
yc.isSigned=null;yc.bitWidth=null;xc=yc[Symbol.toStringTag]="Int";vc[wc]=xc;class zc extends vc{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class Ac extends vc{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class Bc extends vc{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class Cc extends vc{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class Dc extends vc{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}
class Ec extends vc{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class Fc extends vc{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class Gc extends vc{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(zc.prototype,"ArrayType",{value:Int8Array});Object.defineProperty(Ac.prototype,"ArrayType",{value:Int16Array});Object.defineProperty(Bc.prototype,"ArrayType",{value:Int32Array});Object.defineProperty(Cc.prototype,"ArrayType",{value:BigInt64Array});
Object.defineProperty(Dc.prototype,"ArrayType",{value:Uint8Array});Object.defineProperty(Ec.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Fc.prototype,"ArrayType",{value:Uint32Array});Object.defineProperty(Gc.prototype,"ArrayType",{value:BigUint64Array});
class Hc extends J{constructor(a){super(G.Float);this.precision=a}get ArrayType(){switch(this.precision){case w.HALF:return Uint16Array;case w.SINGLE:return Float32Array;case w.DOUBLE:return Float64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}toString(){return`Float${this.precision<<5||16}`}}var Ic=Symbol.toStringTag,Jc,Kc=Hc.prototype;Kc.precision=null;Jc=Kc[Symbol.toStringTag]="Float";Hc[Ic]=Jc;class Lc extends Hc{constructor(){super(w.HALF)}}
class Mc extends Hc{constructor(){super(w.SINGLE)}}class Nc extends Hc{constructor(){super(w.DOUBLE)}}Object.defineProperty(Lc.prototype,"ArrayType",{value:Uint16Array});Object.defineProperty(Mc.prototype,"ArrayType",{value:Float32Array});Object.defineProperty(Nc.prototype,"ArrayType",{value:Float64Array});class Oc extends J{constructor(){super(G.Binary)}toString(){return"Binary"}}var Pc=Symbol.toStringTag,Qc,Rc=Oc.prototype;Rc.ArrayType=Uint8Array;Qc=Rc[Symbol.toStringTag]="Binary";Oc[Pc]=Qc;
class Sc extends J{constructor(){super(G.LargeBinary)}toString(){return"LargeBinary"}}var Tc=Symbol.toStringTag,Uc,Vc=Sc.prototype;Vc.ArrayType=Uint8Array;Vc.OffsetArrayType=BigInt64Array;Uc=Vc[Symbol.toStringTag]="LargeBinary";Sc[Tc]=Uc;class Wc extends J{constructor(){super(G.Utf8)}toString(){return"Utf8"}}var Xc=Symbol.toStringTag,Yc,Zc=Wc.prototype;Zc.ArrayType=Uint8Array;Yc=Zc[Symbol.toStringTag]="Utf8";Wc[Xc]=Yc;
class $c extends J{constructor(){super(G.LargeUtf8)}toString(){return"LargeUtf8"}}var ad=Symbol.toStringTag,bd,cd=$c.prototype;cd.ArrayType=Uint8Array;cd.OffsetArrayType=BigInt64Array;bd=cd[Symbol.toStringTag]="LargeUtf8";$c[ad]=bd;class dd extends J{constructor(){super(G.Bool)}toString(){return"Bool"}}var ed=Symbol.toStringTag,fd,gd=dd.prototype;gd.ArrayType=Uint8Array;fd=gd[Symbol.toStringTag]="Bool";dd[ed]=fd;
class hd extends J{constructor(a,b,c=128){super(G.Decimal);this.scale=a;this.precision=b;this.bitWidth=c}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}var id=Symbol.toStringTag,jd,kd=hd.prototype;kd.scale=null;kd.precision=null;kd.ArrayType=Uint32Array;jd=kd[Symbol.toStringTag]="Decimal";hd[id]=jd;
class ld extends J{constructor(a){super(G.Date);this.unit=a}toString(){return`Date${(this.unit+1)*32}<${Ea[this.unit]}>`}get ArrayType(){return this.unit===Ea.DAY?Int32Array:BigInt64Array}}var md=Symbol.toStringTag,nd,od=ld.prototype;od.unit=null;nd=od[Symbol.toStringTag]="Date";ld[md]=nd;class pd extends ld{constructor(){super(Ea.DAY)}}class qd extends ld{constructor(){super(Ea.MILLISECOND)}}
class rd extends J{constructor(a,b){super(G.Time);this.unit=a;this.bitWidth=b}toString(){return`Time${this.bitWidth}<${x[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw Error(`Unrecognized ${this[Symbol.toStringTag]} type`);}}var sd=Symbol.toStringTag,td,ud=rd.prototype;ud.unit=null;ud.bitWidth=null;td=ud[Symbol.toStringTag]="Time";rd[sd]=td;class vd extends rd{constructor(){super(x.SECOND,32)}}
class wd extends rd{constructor(){super(x.MILLISECOND,32)}}class xd extends rd{constructor(){super(x.MICROSECOND,64)}}class yd extends rd{constructor(){super(x.NANOSECOND,64)}}class zd extends J{constructor(a,b){super(G.Timestamp);this.unit=a;this.timezone=b}toString(){return`Timestamp<${x[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}var Ad=Symbol.toStringTag,Bd,Cd=zd.prototype;Cd.unit=null;Cd.timezone=null;Cd.ArrayType=BigInt64Array;Bd=Cd[Symbol.toStringTag]="Timestamp";zd[Ad]=Bd;
class Dd extends zd{constructor(a){super(x.SECOND,a)}}class Ed extends zd{constructor(a){super(x.MILLISECOND,a)}}class Fd extends zd{constructor(a){super(x.MICROSECOND,a)}}class Gd extends zd{constructor(a){super(x.NANOSECOND,a)}}class Hd extends J{constructor(a){super(G.Interval);this.unit=a}toString(){return`Interval<${y[this.unit]}>`}}var Id=Symbol.toStringTag,Jd,Kd=Hd.prototype;Kd.unit=null;Kd.ArrayType=Int32Array;Jd=Kd[Symbol.toStringTag]="Interval";Hd[Id]=Jd;
class Ld extends Hd{constructor(){super(y.DAY_TIME)}}class Md extends Hd{constructor(){super(y.YEAR_MONTH)}}class Nd extends Hd{constructor(){super(y.MONTH_DAY_NANO)}}class Od extends J{constructor(a){super(G.Duration);this.unit=a}toString(){return`Duration<${x[this.unit]}>`}}var Pd=Symbol.toStringTag,Qd,Rd=Od.prototype;Rd.unit=null;Rd.ArrayType=BigInt64Array;Qd=Rd[Symbol.toStringTag]="Duration";Od[Pd]=Qd;class Sd extends Od{constructor(){super(x.SECOND)}}
class Td extends Od{constructor(){super(x.MILLISECOND)}}class Ud extends Od{constructor(){super(x.MICROSECOND)}}class Vd extends Od{constructor(){super(x.NANOSECOND)}}class Wd extends J{constructor(a){super(G.List);this.children=[a]}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}var Xd=Symbol.toStringTag,Yd,Zd=Wd.prototype;Zd.children=null;Yd=Zd[Symbol.toStringTag]="List";
Wd[Xd]=Yd;class K extends J{constructor(a){super(G.Struct);this.children=a}toString(){return`Struct<{${this.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}var $d=Symbol.toStringTag,ae,be=K.prototype;be.children=null;ae=be[Symbol.toStringTag]="Struct";K[$d]=ae;
class ce extends J{constructor(a,b,c){super(G.Union);this.mode=a;this.children=c;this.typeIds=b=Int32Array.from(b);this.typeIdToChildIndex=b.reduce((d,e,f)=>(d[e]=f)&&d||d,Object.create(null))}toString(){return`${this[Symbol.toStringTag]}<${this.children.map(a=>`${a.type}`).join(" | ")}>`}}var de=Symbol.toStringTag,ee,fe=ce.prototype;fe.mode=null;fe.typeIds=null;fe.children=null;fe.typeIdToChildIndex=null;fe.ArrayType=Int8Array;ee=fe[Symbol.toStringTag]="Union";ce[de]=ee;
class ge extends ce{constructor(a,b){super(v.Dense,a,b)}}class he extends ce{constructor(a,b){super(v.Sparse,a,b)}}class ie extends J{constructor(a){super(G.FixedSizeBinary);this.byteWidth=a}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}var je=Symbol.toStringTag,ke,le=ie.prototype;le.byteWidth=null;le.ArrayType=Uint8Array;ke=le[Symbol.toStringTag]="FixedSizeBinary";ie[je]=ke;
class me extends J{constructor(a,b){super(G.FixedSizeList);this.listSize=a;this.children=[b]}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}var ne=Symbol.toStringTag,oe,pe=me.prototype;pe.children=null;pe.listSize=null;oe=pe[Symbol.toStringTag]="FixedSizeList";me[ne]=oe;
class qe extends J{constructor(a,b=!1){super(G.Map);this.children=[a];this.keysSorted=b;a&&(a.name="entries",a?.type?.children&&((b=a?.type?.children[0])&&(b.name="key"),(a=a?.type?.children[1])&&(a.name="value")))}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map(a=>`${a.name}:${a.type}`).join(", ")}}>`}}
var re=Symbol.toStringTag,se,te=qe.prototype;te.children=null;te.keysSorted=null;se=te[Symbol.toStringTag]="Map_";qe[re]=se;const ue=(a=>()=>++a)(-1);class ve extends J{constructor(a,b,c,d){super(G.Dictionary);this.indices=b;this.dictionary=a;this.isOrdered=d||!1;this.id=c==null?ue():I(c)}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}
var we=Symbol.toStringTag,xe,ye=ve.prototype;ye.id=null;ye.indices=null;ye.isOrdered=null;ye.dictionary=null;xe=ye[Symbol.toStringTag]="Dictionary";ve[we]=xe;function ze(a){switch(a.typeId){case G.Decimal:return a.bitWidth/32;case G.Interval:return a.unit===y.MONTH_DAY_NANO?4:1+a.unit;case G.FixedSizeList:return a.listSize;case G.FixedSizeBinary:return a.byteWidth;default:return 1}};class Ae{visitMany(a,...b){return a.map((c,d)=>this.visit(c,...b.map(e=>e[d])))}visit(...a){return this.getVisitFn(a[0],!1).apply(this,a)}getVisitFn(a,b=!0){return Be(this,a,b)}getVisitFnByTypeId(a,b=!0){return Ce(this,a,b)}visitNull(){return null}visitBool(){return null}visitInt(){return null}visitFloat(){return null}visitUtf8(){return null}visitLargeUtf8(){return null}visitBinary(){return null}visitLargeBinary(){return null}visitFixedSizeBinary(){return null}visitDate(){return null}visitTimestamp(){return null}visitTime(){return null}visitDecimal(){return null}visitList(){return null}visitStruct(){return null}visitUnion(){return null}visitDictionary(){return null}visitInterval(){return null}visitDuration(){return null}visitFixedSizeList(){return null}visitMap(){return null}}
function Be(a,b,c=!0){return typeof b==="number"?Ce(a,b,c):typeof b==="string"&&b in G?Ce(a,G[b],c):b&&b instanceof J?Ce(a,De(b),c):b?.type&&b.type instanceof J?Ce(a,De(b.type),c):Ce(a,G.NONE,c)}
function Ce(a,b,c=!0){let d=null;switch(b){case G.Null:d=a.visitNull;break;case G.Bool:d=a.visitBool;break;case G.Int:d=a.visitInt;break;case G.Int8:d=a.visitInt8||a.visitInt;break;case G.Int16:d=a.visitInt16||a.visitInt;break;case G.Int32:d=a.visitInt32||a.visitInt;break;case G.Int64:d=a.visitInt64||a.visitInt;break;case G.Uint8:d=a.visitUint8||a.visitInt;break;case G.Uint16:d=a.visitUint16||a.visitInt;break;case G.Uint32:d=a.visitUint32||a.visitInt;break;case G.Uint64:d=a.visitUint64||a.visitInt;
break;case G.Float:d=a.visitFloat;break;case G.Float16:d=a.visitFloat16||a.visitFloat;break;case G.Float32:d=a.visitFloat32||a.visitFloat;break;case G.Float64:d=a.visitFloat64||a.visitFloat;break;case G.Utf8:d=a.visitUtf8;break;case G.LargeUtf8:d=a.visitLargeUtf8;break;case G.Binary:d=a.visitBinary;break;case G.LargeBinary:d=a.visitLargeBinary;break;case G.FixedSizeBinary:d=a.visitFixedSizeBinary;break;case G.Date:d=a.visitDate;break;case G.DateDay:d=a.visitDateDay||a.visitDate;break;case G.DateMillisecond:d=
a.visitDateMillisecond||a.visitDate;break;case G.Timestamp:d=a.visitTimestamp;break;case G.TimestampSecond:d=a.visitTimestampSecond||a.visitTimestamp;break;case G.TimestampMillisecond:d=a.visitTimestampMillisecond||a.visitTimestamp;break;case G.TimestampMicrosecond:d=a.visitTimestampMicrosecond||a.visitTimestamp;break;case G.TimestampNanosecond:d=a.visitTimestampNanosecond||a.visitTimestamp;break;case G.Time:d=a.visitTime;break;case G.TimeSecond:d=a.visitTimeSecond||a.visitTime;break;case G.TimeMillisecond:d=
a.visitTimeMillisecond||a.visitTime;break;case G.TimeMicrosecond:d=a.visitTimeMicrosecond||a.visitTime;break;case G.TimeNanosecond:d=a.visitTimeNanosecond||a.visitTime;break;case G.Decimal:d=a.visitDecimal;break;case G.List:d=a.visitList;break;case G.Struct:d=a.visitStruct;break;case G.Union:d=a.visitUnion;break;case G.DenseUnion:d=a.visitDenseUnion||a.visitUnion;break;case G.SparseUnion:d=a.visitSparseUnion||a.visitUnion;break;case G.Dictionary:d=a.visitDictionary;break;case G.Interval:d=a.visitInterval;
break;case G.IntervalDayTime:d=a.visitIntervalDayTime||a.visitInterval;break;case G.IntervalYearMonth:d=a.visitIntervalYearMonth||a.visitInterval;break;case G.IntervalMonthDayNano:d=a.visitIntervalMonthDayNano||a.visitInterval;break;case G.Duration:d=a.visitDuration;break;case G.DurationSecond:d=a.visitDurationSecond||a.visitDuration;break;case G.DurationMillisecond:d=a.visitDurationMillisecond||a.visitDuration;break;case G.DurationMicrosecond:d=a.visitDurationMicrosecond||a.visitDuration;break;case G.DurationNanosecond:d=
a.visitDurationNanosecond||a.visitDuration;break;case G.FixedSizeList:d=a.visitFixedSizeList;break;case G.Map:d=a.visitMap}if(typeof d==="function")return d;if(!c)return()=>null;throw Error(`Unrecognized type '${G[b]}'`);}
function De(a){switch(a.typeId){case G.Null:return G.Null;case G.Int:const b=a.isSigned;switch(a.bitWidth){case 8:return b?G.Int8:G.Uint8;case 16:return b?G.Int16:G.Uint16;case 32:return b?G.Int32:G.Uint32;case 64:return b?G.Int64:G.Uint64}return G.Int;case G.Float:switch(a.precision){case w.HALF:return G.Float16;case w.SINGLE:return G.Float32;case w.DOUBLE:return G.Float64}return G.Float;case G.Binary:return G.Binary;case G.LargeBinary:return G.LargeBinary;case G.Utf8:return G.Utf8;case G.LargeUtf8:return G.LargeUtf8;
case G.Bool:return G.Bool;case G.Decimal:return G.Decimal;case G.Time:switch(a.unit){case x.SECOND:return G.TimeSecond;case x.MILLISECOND:return G.TimeMillisecond;case x.MICROSECOND:return G.TimeMicrosecond;case x.NANOSECOND:return G.TimeNanosecond}return G.Time;case G.Timestamp:switch(a.unit){case x.SECOND:return G.TimestampSecond;case x.MILLISECOND:return G.TimestampMillisecond;case x.MICROSECOND:return G.TimestampMicrosecond;case x.NANOSECOND:return G.TimestampNanosecond}return G.Timestamp;case G.Date:switch(a.unit){case Ea.DAY:return G.DateDay;
case Ea.MILLISECOND:return G.DateMillisecond}return G.Date;case G.Interval:switch(a.unit){case y.DAY_TIME:return G.IntervalDayTime;case y.YEAR_MONTH:return G.IntervalYearMonth;case y.MONTH_DAY_NANO:return G.IntervalMonthDayNano}return G.Interval;case G.Duration:switch(a.unit){case x.SECOND:return G.DurationSecond;case x.MILLISECOND:return G.DurationMillisecond;case x.MICROSECOND:return G.DurationMicrosecond;case x.NANOSECOND:return G.DurationNanosecond}return G.Duration;case G.Map:return G.Map;case G.List:return G.List;
case G.Struct:return G.Struct;case G.Union:switch(a.mode){case v.Dense:return G.DenseUnion;case v.Sparse:return G.SparseUnion}return G.Union;case G.FixedSizeBinary:return G.FixedSizeBinary;case G.FixedSizeList:return G.FixedSizeList;case G.Dictionary:return G.Dictionary}throw Error(`Unrecognized type '${G[a.typeId]}'`);}h=Ae.prototype;h.visitInt8=null;h.visitInt16=null;h.visitInt32=null;h.visitInt64=null;h.visitUint8=null;h.visitUint16=null;h.visitUint32=null;h.visitUint64=null;h.visitFloat16=null;
h.visitFloat32=null;h.visitFloat64=null;h.visitDateDay=null;h.visitDateMillisecond=null;h.visitTimestampSecond=null;h.visitTimestampMillisecond=null;h.visitTimestampMicrosecond=null;h.visitTimestampNanosecond=null;h.visitTimeSecond=null;h.visitTimeMillisecond=null;h.visitTimeMicrosecond=null;h.visitTimeNanosecond=null;h.visitDenseUnion=null;h.visitSparseUnion=null;h.visitIntervalDayTime=null;h.visitIntervalYearMonth=null;h.visitIntervalMonthDayNano=null;h.visitDuration=null;
h.visitDurationSecond=null;h.visitDurationMillisecond=null;h.visitDurationMicrosecond=null;h.visitDurationNanosecond=null;const Ee=new Float64Array(1),Fe=new Uint32Array(Ee.buffer);function Ge(a){const b=(a&31744)>>10,c=(a&1023)/1024;a=(-1)**((a&32768)>>15);switch(b){case 31:return a*(c?Number.NaN:1/0);case 0:return a*(c?6.103515625E-5*c:0)}return a*2**(b-15)*(1+c)}
function He(a){if(a!==a)return 32256;Ee[0]=a;a=(Fe[1]&2147483648)>>16&65535;let b=Fe[1]&2146435072,c=0;b>=1089470464?Fe[0]>0?b=31744:(b=(b&2080374784)>>16,c=(Fe[1]&1048575)>>10):b<=1056964608?(c=1048576+(Fe[1]&1048575),c=1048576+(c<<(b>>20)-998)>>21,b=0):(b=b-1056964608>>10,c=(Fe[1]&1048575)+512>>10);return a|b|c&65535}var Ie={};Ie.float64ToUint16=He;Ie.uint16ToFloat64=Ge;class Je extends Ae{}function L(a){return(b,c,d)=>{if(b.setValid(c,d!=null))return a(b,c,d)}}
const Ke=(a,b,c,d)=>{if(c+1<b.length){const e=I(b[c]);b=I(b[c+1]);a.set(d.subarray(0,b-e),e)}},Le=({values:a},b,c)=>{a[b]=c},Me=({values:a},b,c)=>{a[b]=c},Ne=({values:a},b,c)=>{a[b]=He(c)},Oe=({values:a},b,c)=>{a[b]=Math.floor(c.valueOf()/864E5)},Pe=({values:a},b,c)=>{a[b]=BigInt(c)},Qe=({stride:a,values:b},c,d)=>{b.set(d.subarray(0,a),a*c)},Re=({values:a,valueOffsets:b},c,d)=>Ke(a,b,c,d),Se=({values:a,valueOffsets:b},c,d)=>Ke(a,b,c,ca.encode(d)),Te=(a,b,c)=>{a.type.unit===Ea.DAY?Oe(a,b,c):Pe(a,b,
c)},Ue=({values:a},b,c)=>{a[b]=BigInt(c/1E3)},Ve=({values:a},b,c)=>{a[b]=BigInt(c)},We=({values:a},b,c)=>{a[b]=BigInt(c*1E3)},Xe=({values:a},b,c)=>{a[b]=BigInt(c*1E6)},Ye=(a,b,c)=>{switch(a.type.unit){case x.SECOND:return Ue(a,b,c);case x.MILLISECOND:return Ve(a,b,c);case x.MICROSECOND:return We(a,b,c);case x.NANOSECOND:return Xe(a,b,c)}},Ze=({values:a},b,c)=>{a[b]=c},$e=({values:a},b,c)=>{a[b]=c},af=({values:a},b,c)=>{a[b]=c},bf=({values:a},b,c)=>{a[b]=c},cf=(a,b,c)=>{switch(a.type.unit){case x.SECOND:return Ze(a,
b,c);case x.MILLISECOND:return $e(a,b,c);case x.MICROSECOND:return af(a,b,c);case x.NANOSECOND:return bf(a,b,c)}},df=({values:a,stride:b},c,d)=>{a.set(d.subarray(0,b),b*c)},ef=(a,b)=>(c,d,e,f)=>d&&c(d,a,b[f]),ff=(a,b)=>(c,d,e,f)=>d&&c(d,a,b.get(f)),gf=(a,b)=>(c,d,e)=>d&&c(d,a,b.get(e.name)),hf=(a,b)=>(c,d,e)=>d&&c(d,a,b[e.name]),kf=(a,b,c)=>{jf.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],a.valueOffsets[b],c)},lf=(a,b,c)=>{jf.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],
b,c)},pf=(a,b,c)=>{switch(a.type.unit){case y.YEAR_MONTH:return mf(a,b,c);case y.DAY_TIME:return nf(a,b,c);case y.MONTH_DAY_NANO:return of(a,b,c)}},nf=({values:a},b,c)=>{a.set(c.subarray(0,2),2*b)},mf=({values:a},b,c)=>{a[b]=c[0]*12+c[1]%12},of=({values:a,stride:b},c,d)=>{a.set(d.subarray(0,b),b*c)},qf=({values:a},b,c)=>{a[b]=c},rf=({values:a},b,c)=>{a[b]=c},sf=({values:a},b,c)=>{a[b]=c},tf=({values:a},b,c)=>{a[b]=c},uf=(a,b,c)=>{switch(a.type.unit){case x.SECOND:return qf(a,b,c);case x.MILLISECOND:return rf(a,
b,c);case x.MICROSECOND:return sf(a,b,c);case x.NANOSECOND:return tf(a,b,c)}};h=Je.prototype;h.visitBool=L(({offset:a,values:b},c,d)=>{a+=c;d?b[a>>3]|=1<<a%8:b[a>>3]&=~(1<<a%8)});h.visitInt=L(Le);h.visitInt8=L(Le);h.visitInt16=L(Le);h.visitInt32=L(Le);h.visitInt64=L(Le);h.visitUint8=L(Le);h.visitUint16=L(Le);h.visitUint32=L(Le);h.visitUint64=L(Le);h.visitFloat=L((a,b,c)=>{switch(a.type.precision){case w.HALF:return Ne(a,b,c);case w.SINGLE:case w.DOUBLE:return Me(a,b,c)}});h.visitFloat16=L(Ne);
h.visitFloat32=L(Me);h.visitFloat64=L(Me);h.visitUtf8=L(Se);h.visitLargeUtf8=L(Se);h.visitBinary=L(Re);h.visitLargeBinary=L(Re);h.visitFixedSizeBinary=L(Qe);h.visitDate=L(Te);h.visitDateDay=L(Oe);h.visitDateMillisecond=L(Pe);h.visitTimestamp=L(Ye);h.visitTimestampSecond=L(Ue);h.visitTimestampMillisecond=L(Ve);h.visitTimestampMicrosecond=L(We);h.visitTimestampNanosecond=L(Xe);h.visitTime=L(cf);h.visitTimeSecond=L(Ze);h.visitTimeMillisecond=L($e);h.visitTimeMicrosecond=L(af);h.visitTimeNanosecond=L(bf);
h.visitDecimal=L(df);h.visitList=L((a,b,c)=>{const d=a.children[0];a=a.valueOffsets;const e=jf.getVisitFn(d);if(Array.isArray(c))for(let f=-1,g=a[b],k=a[b+1];g<k;)e(d,g++,c[++f]);else for(let f=-1,g=a[b],k=a[b+1];g<k;)e(d,g++,c.get(++f))});h.visitStruct=L((a,b,c)=>{const d=a.type.children.map(f=>jf.getVisitFn(f.type)),e=c instanceof Map?gf(b,c):c instanceof M?ff(b,c):Array.isArray(c)?ef(b,c):hf(b,c);a.type.children.forEach((f,g)=>e(d[g],a.children[g],f,g))});
h.visitUnion=L((a,b,c)=>{a.type.mode===v.Dense?kf(a,b,c):lf(a,b,c)});h.visitDenseUnion=L(kf);h.visitSparseUnion=L(lf);h.visitDictionary=L((a,b,c)=>{a.dictionary?.set(a.values[b],c)});h.visitInterval=L(pf);h.visitIntervalDayTime=L(nf);h.visitIntervalYearMonth=L(mf);h.visitIntervalMonthDayNano=L(of);h.visitDuration=L(uf);h.visitDurationSecond=L(qf);h.visitDurationMillisecond=L(rf);h.visitDurationMicrosecond=L(sf);h.visitDurationNanosecond=L(tf);
h.visitFixedSizeList=L((a,b,c)=>{const d=a.stride;a=a.children[0];const e=jf.getVisitFn(a);if(Array.isArray(c))for(let f=-1,g=b*d;++f<d;)e(a,g+f,c[f]);else for(let f=-1,g=b*d;++f<d;)e(a,g+f,c.get(f))});h.visitMap=L((a,b,c)=>{const d=a.children[0],e=a.valueOffsets;a=jf.getVisitFn(d);let {[b]:f,[b+1]:g}=e;b=c instanceof Map?c.entries():Object.entries(c);for(const k of b)if(a(d,f,k),++f>=g)break});const jf=new Je;const vf=Symbol.for("parent"),wf=Symbol.for("rowIndex");
class xf{constructor(a,b){this[vf]=a;this[wf]=b;return new Proxy(this,yf)}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[wf],b=this[vf],c=b.type.children,d={};for(let e=-1,f=c.length;++e<f;)d[c[e].name]=zf.visit(b.children[e],a);return d}toString(){return`{${[...this].map(([a,b])=>`${bc(a)}: ${bc(b)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Af(this[vf],this[wf])}}
class Af{constructor(a,b){this.Db=0;this.children=a.children;this.rowIndex=b;this.Cb=a.type.children;this.numChildren=this.Cb.length}[Symbol.iterator](){return this}next(){const a=this.Db;return a<this.numChildren?(this.Db=a+1,{done:!1,value:[this.Cb[a].name,zf.visit(this.children[a],this.rowIndex)]}):{done:!0,value:null}}}
Object.defineProperties(xf.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[vf]:{writable:!0,enumerable:!1,configurable:!1,value:null},[wf]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});
class Bf{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[vf].type.children.map(b=>b.name)}has(a,b){return a[vf].type.children.some(c=>c.name===b)}getOwnPropertyDescriptor(a,b){if(a[vf].type.children.some(c=>c.name===b))return{writable:!0,enumerable:!0,configurable:!0}}get(a,b){if(Reflect.has(a,b))return a[b];var c=a[vf].type.children.findIndex(d=>d.name===b);if(c!==-1)return c=zf.visit(a[vf].children[c],a[wf]),Reflect.set(a,b,c),c}set(a,b,c){const d=
a[vf].type.children.findIndex(e=>e.name===b);return d!==-1?(jf.visit(a[vf].children[d],a[wf],c),Reflect.set(a,b,c)):Reflect.has(a,b)||typeof b==="symbol"?Reflect.set(a,b,c):!1}}const yf=new Bf;class Cf extends Ae{}function N(a){return(b,c)=>b.getValid(c)?a(b,c):null}
const Df=(a,b,c)=>{if(c+1>=b.length)return null;const d=I(b[c]);b=I(b[c+1]);return a.subarray(d,b)},Ef=({values:a},b)=>864E5*a[b],Ff=({values:a},b)=>I(a[b]),Gf=({stride:a,values:b},c)=>b[a*c],Hf=({values:a},b)=>a[b],If=({values:a,valueOffsets:b},c)=>Df(a,b,c),Jf=({values:a,valueOffsets:b},c)=>{a=Df(a,b,c);return a!==null?ba(a):null},Kf=({values:a},b)=>1E3*I(a[b]),Lf=({values:a},b)=>I(a[b]),Mf=({values:a},b)=>dc(a[b],BigInt(1E3)),Nf=({values:a},b)=>dc(a[b],BigInt(1E6)),Of=({values:a},b)=>a[b],Pf=({values:a},
b)=>a[b],Qf=({values:a},b)=>a[b],Rf=({values:a},b)=>a[b],Sf=(a,b)=>zf.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],a.valueOffsets[b]),Tf=(a,b)=>zf.visit(a.children[a.type.typeIdToChildIndex[a.typeIds[b]]],b),Uf=({values:a},b)=>a.subarray(2*b,2*(b+1)),Vf=({values:a},b)=>{a=a[b];b=new Int32Array(2);b[0]=Math.trunc(a/12);b[1]=Math.trunc(a%12);return b},Wf=({values:a},b)=>a.subarray(4*b,4*(b+1)),Xf=({values:a},b)=>a[b],Yf=({values:a},b)=>a[b],Zf=({values:a},b)=>a[b],$f=({values:a},b)=>a[b];
h=Cf.prototype;h.visitNull=N(()=>null);h.visitBool=N(({offset:a,values:b},c)=>{a+=c;return(b[a>>3]&1<<a%8)!==0});h.visitInt=N(({values:a},b)=>a[b]);h.visitInt8=N(Gf);h.visitInt16=N(Gf);h.visitInt32=N(Gf);h.visitInt64=N(Hf);h.visitUint8=N(Gf);h.visitUint16=N(Gf);h.visitUint32=N(Gf);h.visitUint64=N(Hf);h.visitFloat=N(({type:a,values:b},c)=>a.precision!==w.HALF?b[c]:Ge(b[c]));h.visitFloat16=N(({stride:a,values:b},c)=>Ge(b[a*c]));h.visitFloat32=N(Gf);h.visitFloat64=N(Gf);h.visitUtf8=N(Jf);
h.visitLargeUtf8=N(Jf);h.visitBinary=N(If);h.visitLargeBinary=N(If);h.visitFixedSizeBinary=N(({stride:a,values:b},c)=>b.subarray(a*c,a*(c+1)));h.visitDate=N((a,b)=>a.type.unit===Ea.DAY?Ef(a,b):Ff(a,b));h.visitDateDay=N(Ef);h.visitDateMillisecond=N(Ff);h.visitTimestamp=N((a,b)=>{switch(a.type.unit){case x.SECOND:return Kf(a,b);case x.MILLISECOND:return Lf(a,b);case x.MICROSECOND:return Mf(a,b);case x.NANOSECOND:return Nf(a,b)}});h.visitTimestampSecond=N(Kf);h.visitTimestampMillisecond=N(Lf);
h.visitTimestampMicrosecond=N(Mf);h.visitTimestampNanosecond=N(Nf);h.visitTime=N((a,b)=>{switch(a.type.unit){case x.SECOND:return Of(a,b);case x.MILLISECOND:return Pf(a,b);case x.MICROSECOND:return Qf(a,b);case x.NANOSECOND:return Rf(a,b)}});h.visitTimeSecond=N(Of);h.visitTimeMillisecond=N(Pf);h.visitTimeMicrosecond=N(Qf);h.visitTimeNanosecond=N(Rf);h.visitDecimal=N(({values:a,stride:b},c)=>new mc(a.subarray(b*c,b*(c+1))));
h.visitList=N((a,b)=>{const c=a.stride,d=a.children,{[b*c]:e,[b*c+1]:f}=a.valueOffsets;a=d[0].slice(e,f-e);return new M([a])});h.visitStruct=N((a,b)=>new xf(a,b));h.visitUnion=N((a,b)=>a.type.mode===v.Dense?Sf(a,b):Tf(a,b));h.visitDenseUnion=N(Sf);h.visitSparseUnion=N(Tf);h.visitDictionary=N((a,b)=>a.dictionary?.get(a.values[b]));h.visitInterval=N((a,b)=>a.type.unit===y.MONTH_DAY_NANO?Wf(a,b):a.type.unit===y.DAY_TIME?Uf(a,b):Vf(a,b));h.visitIntervalDayTime=N(Uf);h.visitIntervalYearMonth=N(Vf);
h.visitIntervalMonthDayNano=N(Wf);h.visitDuration=N((a,b)=>{switch(a.type.unit){case x.SECOND:return Xf(a,b);case x.MILLISECOND:return Yf(a,b);case x.MICROSECOND:return Zf(a,b);case x.NANOSECOND:return $f(a,b)}});h.visitDurationSecond=N(Xf);h.visitDurationMillisecond=N(Yf);h.visitDurationMicrosecond=N(Zf);h.visitDurationNanosecond=N($f);h.visitFixedSizeList=N((a,b)=>{const c=a.stride;a=a.children[0].slice(b*c,c);return new M([a])});
h.visitMap=N((a,b)=>{const c=a.children,{[b]:d,[b+1]:e}=a.valueOffsets;return new ag(c[0].slice(d,e-d))});const zf=new Cf;const bg=Symbol.for("keys"),cg=Symbol.for("vals"),dg=Symbol.for("kKeysAsStrings"),eg=Symbol.for("_kKeysAsStrings");
class ag{constructor(a){this[bg]=(new M([a.children[0]])).memoize();this[cg]=a.children[1];return new Proxy(this,new fg)}get [dg](){return this[eg]||(this[eg]=Array.from(this[bg].toArray(),String))}[Symbol.iterator](){return new gg(this[bg],this[cg])}get size(){return this[bg].length}toArray(){return Object.values(this.toJSON())}toJSON(){const a=this[bg],b=this[cg],c={};for(let d=-1,e=a.length;++d<e;)c[a.get(d)]=zf.visit(b,d);return c}toString(){return`{${[...this].map(([a,b])=>`${bc(a)}: ${bc(b)}`).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}
class gg{constructor(a,b){this.keys=a;this.fc=b;this.Ib=0;this.cc=a.length}[Symbol.iterator](){return this}next(){const a=this.Ib;if(a===this.cc)return{done:!0,value:null};this.Ib++;return{done:!1,value:[this.keys.get(a),zf.visit(this.fc,a)]}}}
class fg{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(a){return a[dg]}has(a,b){return a[dg].includes(b)}getOwnPropertyDescriptor(a,b){if(a[dg].indexOf(b)!==-1)return{writable:!0,enumerable:!0,configurable:!0}}get(a,b){if(Reflect.has(a,b))return a[b];var c=a[dg].indexOf(b);if(c!==-1)return c=zf.visit(Reflect.get(a,cg),c),Reflect.set(a,b,c),c}set(a,b,c){const d=a[dg].indexOf(b);return d!==-1?(jf.visit(Reflect.get(a,cg),d,c),Reflect.set(a,b,c)):Reflect.has(a,
b)?Reflect.set(a,b,c):!1}}Object.defineProperties(ag.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[bg]:{writable:!0,enumerable:!1,configurable:!1,value:null},[cg]:{writable:!0,enumerable:!1,configurable:!1,value:null},[eg]:{writable:!0,enumerable:!1,configurable:!1,value:null}});let hg;function ig(a,b,c,d){const {length:e=0}=a;b=typeof b!=="number"?0:b;c=typeof c!=="number"?e:c;b<0&&(b=(b%e+e)%e);c<0&&(c=(c%e+e)%e);c<b&&(hg=b,b=c,c=hg);c>e&&(c=e);return d?d(a,b,c):[b,c]}const jg=a=>a!==a;function kg(a){if(typeof a!=="object"||a===null)return a!==a?jg:b=>b===a;if(a instanceof Date){const b=a.valueOf();return c=>c instanceof Date?c.valueOf()===b:!1}return ArrayBuffer.isView(a)?b=>b?qa(a,b):!1:a instanceof Map?lg(a):Array.isArray(a)?mg(a):a instanceof M?ng(a):og(a)}
function mg(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=kg(a[c]);return pg(b)}function lg(a){let b=-1;const c=[];for(const d of a.values())c[++b]=kg(d);return pg(c)}function ng(a){const b=[];for(let c=-1,d=a.length;++c<d;)b[c]=kg(a.get(c));return pg(b)}function og(a){const b=Object.keys(a),c=[];for(let d=-1,e=b.length;++d<e;)c[d]=kg(a[b[d]]);return pg(c,b)}
function pg(a,b){return c=>{if(!c||typeof c!=="object")return!1;switch(c.constructor){case Array:a:{var d=a.length;if(c.length!==d)c=!1;else{for(var e=-1;++e<d;)if(!a[e](c[e])){c=!1;break a}c=!0}}return c;case Map:return qg(a,c,c.keys());case ag:case xf:case Object:case void 0:return qg(a,c,b||Object.keys(c))}if(c instanceof M)a:if(d=a.length,c.length!==d)c=!1;else{for(e=-1;++e<d;)if(!a[e](c.get(e))){c=!1;break a}c=!0}else c=!1;return c}}
function qg(a,b,c){c=c[Symbol.iterator]();const d=b instanceof Map?b.keys():Object.keys(b)[Symbol.iterator]();b=b instanceof Map?b.values():Object.values(b)[Symbol.iterator]();let e=0;const f=a.length;let g=b.next(),k=c.next(),n=d.next();for(;e<f&&!k.done&&!n.done&&!g.done&&k.value===n.value&&a[e](g.value);++e,k=c.next(),n=d.next(),g=b.next());if(e===f&&k.done&&n.done&&g.done)return!0;c.return&&c.return();d.return&&d.return();b.return&&b.return();return!1}var rg={};rg.clampRange=ig;
rg.createElementComparator=kg;rg.wrapIndex=(a,b)=>a<0?b+a:a;function sg(a,b,c,d){return(c&1<<d)!==0}function tg(a,b,c,d){return(c&1<<d)>>d}function ug(a,b,c){const d=c.byteLength+7&-8;if(a>0||c.byteLength<d){const e=new Uint8Array(d);e.set(a%8===0?c.subarray(a>>3):vg(new wg(c,a,b,null,sg)).subarray(0,d));return e}return c}function vg(a){const b=[];let c=0,d=0,e=0;for(const f of a)f&&(e|=1<<d),++d===8&&(b[c++]=e,e=d=0);if(c===0||d>0)b[c++]=e;a=new Uint8Array(b.length+7&-8);a.set(b);return a}
class wg{constructor(a,b,c,d,e){this.bytes=a;this.length=c;this.context=d;this.get=e;this.bb=b%8;this.Bb=b>>3;this.Ab=a[this.Bb++];this.index=0}next(){return this.index<this.length?(this.bb===8&&(this.bb=0,this.Ab=this.bytes[this.Bb++]),{value:this.get(this.context,this.index++,this.Ab,this.bb++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}
function xg(a,b,c){if(c-b<=0)return 0;if(c-b<8){var d=0;for(var e of new wg(a,b,c-b,a,tg))d+=e;return d}d=c>>3<<3;e=b+(b%8===0?0:8-b%8);return xg(a,b,e)+xg(a,d,c)+yg(a,e>>3,d-e>>3)}function yg(a,b,c){let d=0;b=Math.trunc(b);const e=new DataView(a.buffer,a.byteOffset,a.byteLength);for(a=c===void 0?a.byteLength:b+c;a-b>=4;)d+=zg(e.getUint32(b)),b+=4;for(;a-b>=2;)d+=zg(e.getUint16(b)),b+=2;for(;a-b>=1;)d+=zg(e.getUint8(b)),b+=1;return d}
function zg(a){a=Math.trunc(a);a-=a>>>1&1431655765;a=(a&858993459)+(a>>>2&858993459);return(a+(a>>>4)&252645135)*16843009>>>24}var Ag={};Ag.BitIterator=wg;Ag.getBit=tg;Ag.getBool=sg;Ag.packBools=vg;Ag.popcnt_array=yg;Ag.popcnt_bit_range=xg;Ag.popcnt_uint32=zg;Ag.setBool=function(a,b,c){return c?!!(a[b>>3]|=1<<b%8)||!0:!(a[b>>3]&=~(1<<b%8))&&!1};Ag.truncateBitmap=ug;function Bg(a,b,c){return a.map(d=>d.slice(b,c))}
class O{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(this.P!==0){const a=this.type;return J.isSparseUnion(a)?this.children.some(b=>b.nullable):J.isDenseUnion(a)?this.children.some(b=>b.nullable):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let a=0;const b=this.valueOffsets,c=this.values,d=this.nullBitmap,e=this.typeIds;b&&(a+=b.byteLength);
c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return this.children.reduce((f,g)=>f+g.byteLength,a)}get nullCount(){if(J.isUnion(this.type))return this.children.reduce((c,d)=>c+d.nullCount,0);let a=this.P,b;a<=-1&&(b=this.nullBitmap)&&(this.P=a=b.length===0?0:this.length-xg(b,this.offset,this.offset+this.length));return a}constructor(a,b,c,d,e,f=[],g){this.type=a;this.children=f;this.dictionary=g;this.offset=Math.floor(Math.max(b||0,0));this.length=Math.floor(Math.max(c||0,0));this.P=
Math.floor(Math.max(d||0,-1));let k;e instanceof O?(this.stride=e.stride,this.values=e.values,this.typeIds=e.typeIds,this.nullBitmap=e.nullBitmap,this.valueOffsets=e.valueOffsets):(this.stride=ze(a),e&&((k=e[0])&&(this.valueOffsets=k),(k=e[1])&&(this.values=k),(k=e[2])&&(this.nullBitmap=k),(k=e[3])&&(this.typeIds=k)))}getValid(a){const b=this.type;return J.isUnion(b)?this.children[b.typeIdToChildIndex[this.typeIds[a]]].getValid(b.mode===v.Dense?this.valueOffsets[a]:a):this.nullable&&this.nullCount>
0?(a=this.offset+a,(this.nullBitmap[a>>3]&1<<a%8)!==0):!0}setValid(a,b){var c=this.type;if(J.isUnion(c)){var d=this.children[c.typeIdToChildIndex[this.typeIds[a]]];a=c.mode===v.Dense?this.valueOffsets[a]:a;c=d.getValid(a);d.setValid(a,b)}else{({nullBitmap:d}=this);c=this.offset;var e=this.length,f=c+a;a=1<<f%8;f>>=3;if(!d||d.byteLength<=f)d=(new Uint8Array((c+e+63&-64)>>3)).fill(255),this.nullCount>0?(d.set(ug(c,e,this.nullBitmap),0),Object.assign(this,{nullBitmap:d})):Object.assign(this,{nullBitmap:d,
P:0});e=d[f];c=(e&a)!==0;d[f]=b?e|a:e&~a}c!==!!b&&(this.P=this.nullCount+(b?-1:1));return b}clone(a=this.type,b=this.offset,c=this.length,d=this.P,e=this,f=this.children){return new O(a,b,c,d,e,f,this.dictionary)}slice(a,b){const c=this.stride,d=this.typeId,e=this.children,f=+(this.P===0)-1,g=d===16?c:1;let k;const n=this.buffers;(k=n[$b.TYPE])&&(n[$b.TYPE]=k.subarray(a,a+b));(k=n[$b.OFFSET])&&(n[$b.OFFSET]=k.subarray(a,a+b+1))||(k=n[$b.DATA])&&(n[$b.DATA]=d===6?k:k.subarray(c*a,c*(a+b)));return this.clone(this.type,
this.offset+a,b,f,n,e.length===0||this.valueOffsets?e:Bg(e,g*a,g*b))}Oa(a){if(this.typeId===G.Null)return this.clone(this.type,0,a,0);const b=this.length,c=this.nullCount,d=(new Uint8Array((a+63&-64)>>3)).fill(255,0,b>>3);d[b>>3]=(1<<b-(b&-8))-1;c>0&&d.set(ug(this.offset,b,this.nullBitmap),0);const e=this.buffers;e[$b.VALIDITY]=d;return this.clone(this.type,0,a,c+(a-b),e)}}O.prototype.children=Object.freeze([]);
class Cg extends Ae{visit(a){return this.getVisitFn(a.type).call(this,a)}visitNull(a){const {type:b,offset:c=0,length:d=0}=a;return new O(b,c,d,d)}visitBool(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length>>3,nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitInt(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,
e,d])}visitFloat(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitUtf8(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.data),e=p(Uint8Array,a.nullBitmap),f=p(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,c,g,k,[f,d,e])}visitLargeUtf8(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.data),e=p(Uint8Array,a.nullBitmap),f=p(BigInt64Array,
a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,c,g,k,[f,d,e])}visitBinary(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.data),e=p(Uint8Array,a.nullBitmap),f=p(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,c,g,k,[f,d,e])}visitLargeBinary(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.data),e=p(Uint8Array,a.nullBitmap),f=p(BigInt64Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,
c,g,k,[f,d,e])}visitFixedSizeBinary(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length/ze(b),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitDate(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length/ze(b),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitTimestamp(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=
e.length/ze(b),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitTime(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length/ze(b),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitDecimal(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length/ze(b),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitList(a){const {type:b,offset:c=0,child:d}=
a,e=p(Uint8Array,a.nullBitmap),f=p(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,c,g,k,[f,void 0,e],[d])}visitStruct(a){const {type:b,offset:c=0,children:d=[]}=a,e=p(Uint8Array,a.nullBitmap),{length:f=d.reduce((k,{length:n})=>Math.max(k,n),0),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,void 0,e],d)}visitUnion(a){const {type:b,offset:c=0,children:d=[]}=a,e=p(b.ArrayType,a.typeIds),{length:f=e.length,nullCount:g=-1}=a;if(J.isSparseUnion(b))return new O(b,
c,f,g,[void 0,void 0,void 0,e],d);a=p(Int32Array,a.valueOffsets);return new O(b,c,f,g,[a,void 0,void 0,e],d)}visitDictionary(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.indices.ArrayType,a.data),{dictionary:f=new M([(new Cg).visit({type:b.dictionary})])}=a,{length:g=e.length,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,c,g,k,[void 0,e,d],[],f)}visitInterval(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length/ze(b),nullCount:g=
a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitDuration(a){const {type:b,offset:c=0}=a,d=p(Uint8Array,a.nullBitmap),e=p(b.ArrayType,a.data),{length:f=e.length,nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,e,d])}visitFixedSizeList(a){const {type:b,offset:c=0,child:d=(new Cg).visit({type:b.valueType})}=a,e=p(Uint8Array,a.nullBitmap),{length:f=d.length/ze(b),nullCount:g=a.nullBitmap?-1:0}=a;return new O(b,c,f,g,[void 0,void 0,e],[d])}visitMap(a){const {type:b,offset:c=0,
child:d=(new Cg).visit({type:b.childType})}=a,e=p(Uint8Array,a.nullBitmap),f=p(Int32Array,a.valueOffsets),{length:g=f.length-1,nullCount:k=a.nullBitmap?-1:0}=a;return new O(b,c,g,k,[f,void 0,e],[d])}}const Dg=new Cg;function P(a){return Dg.visit(a)};class Eg{constructor(a=0,b){this.Jb=a;this.Gb=b;this.cb=0;this.Eb=this.Gb(0)}next(){for(;this.cb<this.Jb;){const a=this.Eb.next();if(!a.done)return a;++this.cb<this.Jb&&(this.Eb=this.Gb(this.cb))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Fg(a){return a.some(b=>b.nullable)}function Gg(a){return a.reduce((b,c)=>b+c.nullCount,0)}function Hg(a){return a.reduce((b,c,d)=>{b[d+1]=b[d]+c.length;return b},new Uint32Array(a.length+1))}
function Ig(a,b,c,d){const e=[];for(let f=-1,g=a.length;++f<g;){const k=a[f],n=b[f],q=k.length;if(n>=d)break;if(c>=n+q)continue;if(n>=c&&n+q<=d){e.push(k);continue}const t=Math.max(0,c-n);e.push(k.slice(t,Math.min(d-n,q)-t))}e.length===0&&e.push(a[0].slice(0,0));return e}function Jg(a,b,c,d){let e=0,f,g=b.length-1;do{if(e>=g-1)return c<b[g]?d(a,e,c-b[e]):null;f=e+Math.trunc((g-e)*.5);c<b[f]?g=f:e=f}while(e<g)}function Kg(a,b){return a.getValid(b)}
function Lg(a){function b(c,d,e){return a(c[d],e)}return function(c){return Jg(this.data,this.j,c,b)}}function Mg(a){function b(d,e,f){return a(d[e],f,c)}let c;return function(d,e){const f=this.data;c=e;d=Jg(f,this.j,d,b);c=void 0;return d}}function Ng(a){function b(d,e,f){var g=f;f=0;for(let k=e-1,n=d.length;++k<n;){e=d[k];if(~(g=a(e,c,g)))return f+g;g=0;f+=e.length}return-1}let c;return function(d,e){c=d;d=this.data;e=typeof e!=="number"?b(d,0,0):Jg(d,this.j,e,b);c=void 0;return e}};class Og extends Ae{}function Q(a,b,c){if(b===void 0)return-1;if(b===null)switch(a.typeId){case G.Union:break;case G.Dictionary:break;default:a:{const e=a.nullBitmap;if(e&&!(a.nullCount<=0)){b=0;for(var d of new wg(e,a.offset+(c||0),a.length,e,sg)){if(!d){a=b;break a}++b}}a=-1}return a}d=zf.getVisitFn(a);b=kg(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(b(d(a,e)))return e;return-1}
function Pg(a,b,c){const d=zf.getVisitFn(a);b=kg(b);for(let e=(c||0)-1,f=a.length;++e<f;)if(b(d(a,e)))return e;return-1}h=Og.prototype;h.visitNull=function(a,b){return b===null&&a.length>0?0:-1};h.visitBool=Q;h.visitInt=Q;h.visitInt8=Q;h.visitInt16=Q;h.visitInt32=Q;h.visitInt64=Q;h.visitUint8=Q;h.visitUint16=Q;h.visitUint32=Q;h.visitUint64=Q;h.visitFloat=Q;h.visitFloat16=Q;h.visitFloat32=Q;h.visitFloat64=Q;h.visitUtf8=Q;h.visitLargeUtf8=Q;h.visitBinary=Q;h.visitLargeBinary=Q;
h.visitFixedSizeBinary=Q;h.visitDate=Q;h.visitDateDay=Q;h.visitDateMillisecond=Q;h.visitTimestamp=Q;h.visitTimestampSecond=Q;h.visitTimestampMillisecond=Q;h.visitTimestampMicrosecond=Q;h.visitTimestampNanosecond=Q;h.visitTime=Q;h.visitTimeSecond=Q;h.visitTimeMillisecond=Q;h.visitTimeMicrosecond=Q;h.visitTimeNanosecond=Q;h.visitDecimal=Q;h.visitList=Q;h.visitStruct=Q;h.visitUnion=Q;h.visitDenseUnion=Pg;h.visitSparseUnion=Pg;h.visitDictionary=Q;h.visitInterval=Q;h.visitIntervalDayTime=Q;
h.visitIntervalYearMonth=Q;h.visitIntervalMonthDayNano=Q;h.visitDuration=Q;h.visitDurationSecond=Q;h.visitDurationMillisecond=Q;h.visitDurationMicrosecond=Q;h.visitDurationNanosecond=Q;h.visitFixedSizeList=Q;h.visitMap=Q;const Qg=new Og;class Rg extends Ae{}function R(a){const b=a.type;if(a.nullCount===0&&a.stride===1&&(J.isInt(b)&&b.bitWidth!==64||J.isTime(b)&&b.bitWidth!==64||J.isFloat(b)&&b.precision!==w.HALF))return new Eg(a.data.length,d=>{d=a.data[d];return d.values.subarray(0,d.length)[Symbol.iterator]()});let c=0;return new Eg(a.data.length,d=>{d=a.data[d].length;const e=a.slice(c,c+d);c+=d;return new Sg(e)})}
class Sg{constructor(a){this.Kb=a;this.index=0}next(){return this.index<this.Kb.length?{value:this.Kb.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}h=Rg.prototype;h.visitNull=R;h.visitBool=R;h.visitInt=R;h.visitInt8=R;h.visitInt16=R;h.visitInt32=R;h.visitInt64=R;h.visitUint8=R;h.visitUint16=R;h.visitUint32=R;h.visitUint64=R;h.visitFloat=R;h.visitFloat16=R;h.visitFloat32=R;h.visitFloat64=R;h.visitUtf8=R;h.visitLargeUtf8=R;h.visitBinary=R;h.visitLargeBinary=R;
h.visitFixedSizeBinary=R;h.visitDate=R;h.visitDateDay=R;h.visitDateMillisecond=R;h.visitTimestamp=R;h.visitTimestampSecond=R;h.visitTimestampMillisecond=R;h.visitTimestampMicrosecond=R;h.visitTimestampNanosecond=R;h.visitTime=R;h.visitTimeSecond=R;h.visitTimeMillisecond=R;h.visitTimeMicrosecond=R;h.visitTimeNanosecond=R;h.visitDecimal=R;h.visitList=R;h.visitStruct=R;h.visitUnion=R;h.visitDenseUnion=R;h.visitSparseUnion=R;h.visitDictionary=R;h.visitInterval=R;h.visitIntervalDayTime=R;
h.visitIntervalYearMonth=R;h.visitIntervalMonthDayNano=R;h.visitDuration=R;h.visitDurationSecond=R;h.visitDurationMillisecond=R;h.visitDurationMicrosecond=R;h.visitDurationNanosecond=R;h.visitFixedSizeList=R;h.visitMap=R;const Tg=new Rg;const Ug={},Vg={};
class M{constructor(a){a=a[0]instanceof M?a.flatMap(c=>c.data):a;if(a.length===0||a.some(c=>!(c instanceof O)))throw new TypeError("Vector constructor expects an Array of Data instances.");const b=a[0]?.type;switch(a.length){case 0:this.j=[0];break;case 1:const {get:c,set:d,indexOf:e}=Ug[b.typeId],f=a[0];this.isValid=g=>f.getValid(g);this.get=g=>c(f,g);this.set=(g,k)=>d(f,g,k);this.indexOf=g=>e(f,g);this.j=[0,f.length];break;default:Object.setPrototypeOf(this,Vg[b.typeId]),this.j=Hg(a)}this.data=
a;this.type=b;this.stride=ze(b);this.numChildren=b.children?.length??0;this.length=this.j.at(-1)}get byteLength(){return this.data.reduce((a,b)=>a+b.byteLength,0)}get nullable(){return Fg(this.data)}get nullCount(){return Gg(this.data)}get ArrayType(){return this.type.ArrayType}get [Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${G[this.type.typeId]}Vector`}isValid(){return!1}get(){return null}at(a){return this.get(a<0?this.length+a:a)}set(){}indexOf(){return-1}includes(a,
b){return this.indexOf(a,b)>-1}[Symbol.iterator](){return Tg.visit(this)}concat(...a){return new M(this.data.concat(a.flatMap(b=>b.data).flat(Number.POSITIVE_INFINITY)))}slice(a,b){return new M(ig(this,a,b,({data:c,j:d},e,f)=>Ig(c,d,e,f)))}toJSON(){return[...this]}toArray(){const a=this.data,b=this.length,c=this.stride,d=this.ArrayType;switch(this.type.typeId){case G.Int:case G.Float:case G.Decimal:case G.Time:case G.Timestamp:switch(a.length){case 0:return new d;case 1:return a[0].values.subarray(0,
b*c);default:return a.reduce((e,{values:f,length:g})=>{e.yb.set(f.subarray(0,g*c),e.offset);e.offset+=g*c;return e},{yb:new d(b*c),offset:0}).yb}}return[...this]}toString(){return`[${[...this].join()}]`}getChild(a){return this.getChildAt(this.type.children?.findIndex(b=>b.name===a))}getChildAt(a){return a>-1&&a<this.numChildren?new M(this.data.map(({children:b})=>b[a])):null}get isMemoized(){return J.isDictionary(this.type)?this.data[0].dictionary.isMemoized:!1}memoize(){if(J.isDictionary(this.type)){const a=
new Wg(this.data[0].dictionary),b=this.data.map(c=>{c=c.clone();c.dictionary=a;return c});return new M(b)}return new Wg(this)}unmemoize(){if(J.isDictionary(this.type)&&this.isMemoized){const a=this.data[0].dictionary.unmemoize(),b=this.data.map(c=>{c=c.clone();c.dictionary=a;return c});return new M(b)}return this}}
M[Symbol.toStringTag]=(a=>{a.type=J.prototype;a.data=[];a.length=0;a.stride=1;a.numChildren=0;a.j=new Uint32Array([0]);a[Symbol.isConcatSpreadable]=!0;var b=Object.keys(G).map(c=>G[c]).filter(c=>typeof c==="number"&&c!==G.NONE);for(const c of b){b=zf.getVisitFnByTypeId(c);const d=jf.getVisitFnByTypeId(c),e=Qg.getVisitFnByTypeId(c);Ug[c]={get:b,set:d,indexOf:e};Vg[c]=Object.create(a,{isValid:{value:Lg(Kg)},get:{value:Lg(zf.getVisitFnByTypeId(c))},set:{value:Mg(jf.getVisitFnByTypeId(c))},indexOf:{value:Ng(Qg.getVisitFnByTypeId(c))}})}return"Vector"})(M.prototype);
class Wg extends M{constructor(a){super(a.data);const b=this.get,c=this.set,d=this.slice,e=Array(this.length);Object.defineProperty(this,"get",{value(f){var g=e[f];if(g!==void 0)return g;g=b.call(this,f);return e[f]=g}});Object.defineProperty(this,"set",{value(f,g){c.call(this,f,g);e[f]=g}});Object.defineProperty(this,"slice",{value:(f,g)=>new Wg(d.call(this,f,g))});Object.defineProperty(this,"isMemoized",{value:!0});Object.defineProperty(this,"unmemoize",{value:()=>new M(this.data)});Object.defineProperty(this,
"memoize",{value:()=>this})}}
function Xg(a){if(a){if(a instanceof O)return new M([a]);if(a instanceof M)return new M(a.data);if(a.type instanceof J)return new M([P(a)]);if(Array.isArray(a))return new M(a.flatMap(b=>b instanceof O?[b]:b instanceof M?b.data:Xg(b).data));if(ArrayBuffer.isView(a)){a instanceof DataView&&(a=new Uint8Array(a.buffer));const b={offset:0,length:a.length,nullCount:-1,data:a};if(a instanceof Int8Array)return new M([P({...b,type:new zc})]);if(a instanceof Int16Array)return new M([P({...b,type:new Ac})]);
if(a instanceof Int32Array)return new M([P({...b,type:new Bc})]);if(a instanceof BigInt64Array)return new M([P({...b,type:new Cc})]);if(a instanceof Uint8Array||a instanceof Uint8ClampedArray)return new M([P({...b,type:new Dc})]);if(a instanceof Uint16Array)return new M([P({...b,type:new Ec})]);if(a instanceof Uint32Array)return new M([P({...b,type:new Fc})]);if(a instanceof BigUint64Array)return new M([P({...b,type:new Gc})]);if(a instanceof Float32Array)return new M([P({...b,type:new Mc})]);if(a instanceof
Float64Array)return new M([P({...b,type:new Nc})])}}throw Error("Unrecognized input");};function Yg(a){if(!a||a.length<=0)return function(){return!0};let b="";const c=a.filter(d=>d===d);c.length>0&&(b=`
    switch (x) {${c.map(d=>`
        case ${typeof d!=="bigint"?bc(d):`${bc(d)}n`}:`).join("")}
            return false;
    }`);a.length!==c.length&&(b=`if (x !== x) return false;\n${b}`);return new Function("x",`${b}\nreturn true;`)};function Zg(a,b){a=Math.ceil(a)*b-1;return(a-a%64+64||64)/b}function $g(a,b=0){return a.length>=b?a.subarray(0,b):ja(new a.constructor(b),a,0)}function ah(a,b){if(b>0){a.length+=b;b=a.length*a.stride;const c=a.buffer.length;b>=c&&(a.buffer=$g(a.buffer,c===0?Zg(b*1,a.BYTES_PER_ELEMENT):Zg(b*2,a.BYTES_PER_ELEMENT)))}return a}
class bh{constructor(a,b=0,c=1){this.length=Math.ceil(b/c);this.buffer=new a(this.length);this.stride=c;this.BYTES_PER_ELEMENT=a.BYTES_PER_ELEMENT;this.ArrayType=a}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(){return this}append(a){return this.set(this.length,a)}flush(a=this.length){a=Zg(a*this.stride,this.BYTES_PER_ELEMENT);a=$g(this.buffer,a);
this.clear();return a}clear(){this.length=0;this.buffer=new this.ArrayType;return this}}class ch extends bh{get(a){return this.buffer[a]}set(a,b){ah(this,a-this.length+1);this.buffer[a*this.stride]=b;return this}}
class dh extends ch{constructor(){super(Uint8Array,0,.125);this.La=0}get bc(){return this.length-this.La}get(a){return this.buffer[a>>3]>>a%8&1}set(a,b){const {buffer:c}=ah(this,a-this.length+1),d=a>>3;a%=8;const e=c[d]>>a&1;b?e===0&&(c[d]|=1<<a,++this.La):e===1&&(c[d]&=~(1<<a),--this.La);return this}clear(){this.La=0;return super.clear()}}
class eh extends ch{constructor(a){super(a.OffsetArrayType,1,1)}append(a){return this.set(this.length-1,a)}set(a,b){const c=this.length-1,d=ah(this,a-c+1).buffer;c<a++&&c>=0&&d.fill(d[c],c,a);d[a]=d[a-1]+b;return this}flush(a=this.length-1){a>this.length&&this.set(a-1,this.BYTES_PER_ELEMENT>4?BigInt(0):0);return super.flush(a+1)}};class fh{static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}constructor({type:a,nullValues:b}){this.length=0;this.finished=!1;this.type=a;this.children=[];this.nullValues=b;this.stride=ze(a);this.G=new dh;b&&b.length>0&&(this.sb=Yg(b))}toVector(){return new M([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this.G.bc}get numChildren(){return this.children.length}get byteLength(){let a=
0;const b=this.j,c=this.o,d=this.G,e=this.Z,f=this.children;b&&(a+=b.byteLength);c&&(a+=c.byteLength);d&&(a+=d.byteLength);e&&(a+=e.byteLength);return f.reduce((g,k)=>g+k.byteLength,a)}get reservedLength(){return this.G.reservedLength}get reservedByteLength(){let a=0;this.j&&(a+=this.j.reservedByteLength);this.o&&(a+=this.o.reservedByteLength);this.G&&(a+=this.G.reservedByteLength);this.Z&&(a+=this.Z.reservedByteLength);return this.children.reduce((b,c)=>b+c.reservedByteLength,a)}get valueOffsets(){return this.j?
this.j.buffer:null}get values(){return this.o?this.o.buffer:null}get nullBitmap(){return this.G?this.G.buffer:null}get typeIds(){return this.Z?this.Z.buffer:null}append(a){return this.set(this.length,a)}isValid(a){return this.sb(a)}set(a,b){this.setValid(a,this.isValid(b))&&this.setValue(a,b);return this}setValue(a,b){this.B(this,a,b)}setValid(a,b){this.length=this.G.set(a,+b).length;return b}addChild(){throw Error(`Cannot append children to non-nested type "${this.type}"`);}getChildAt(a){return this.children[a]||
null}flush(){let a,b,c,d;const e=this.type,f=this.length,g=this.nullCount;var k=this.j;const n=this.o,q=this.G;(b=this.Z?.flush(f))?d=k?.flush(f):a=(d=k?.flush(f))?n?.flush(k.get(k.length-1)):n?.flush(f);g>0&&(c=q?.flush(f));k=this.children.map(t=>t.flush());this.clear();return P({type:e,length:f,nullCount:g,children:k,child:k[0],data:a,typeIds:b,nullBitmap:c,valueOffsets:d})}finish(){this.finished=!0;for(const a of this.children)a.finish();return this}clear(){this.length=0;this.G?.clear();this.o?.clear();
this.j?.clear();this.Z?.clear();for(const a of this.children)a.clear();return this}}h=fh.prototype;h.length=1;h.stride=1;h.children=null;h.finished=!1;h.nullValues=null;h.sb=()=>!0;class gh extends fh{constructor(a){super(a);this.o=new ch(this.ArrayType,0,this.stride)}setValue(a,b){const c=this.o;ah(c,a-c.length+1);return super.setValue(a,b)}}function hh(a){const b=a.I,c=a.L;a.L=0;a.I=void 0;b&&b.size>0&&a.T(b,c)}
class ih extends fh{constructor(a){super(a);this.L=0;this.j=new eh(a.type)}setValue(a,b){const c=this.I||(this.I=new Map),d=c.get(a);d&&(this.L-=d.length);this.L+=b instanceof ag?b[bg].length:b.length;c.set(a,b)}setValid(a,b){return super.setValid(a,b)?!0:((this.I||(this.I=new Map)).set(a,void 0),!1)}clear(){this.L=0;this.I=void 0;return super.clear()}flush(){hh(this);return super.flush()}finish(){hh(this);return super.finish()}};class jh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}offset(){return Ma(this.g,this.h)}eb(){return this.g.v(this.h+8)}bodyLength(){return Ma(this.g,this.h+16)}};class kh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):u.V1}schema(a){const b=z(this.g,this.h,6);return b?(a||new Ub).i(Pa(this.g,this.h+b),this.g):null}dictionaries(a,b){const c=z(this.g,this.h,8);return c?(b||new jh).i(Qa(this.g,this.h+c)+a*24,this.g):null}jb(a){const b=z(this.g,this.h,10);return b?(new jh).i(Qa(this.g,this.h+b)+a*24,this.g):null}Ha(a){const b=z(this.g,this.h,12);return b?(new zb).i(Pa(this.g,
Qa(this.g,this.h+b)+a*4),this.g):null}Ia(){const a=z(this.g,this.h,12);return a?Ra(this.g,this.h+a):0}};class S{constructor(a=[],b,c,d=u.V5){this.fields=a||[];this.metadata=b||new Map;c||=lh(this.fields);this.dictionaries=c;this.ta=d}get [Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map(a=>a.name)}toString(){return`Schema<{ ${this.fields.map((a,b)=>`${b}: ${a}`).join(", ")} }>`}select(a){const b=new Set(a);a=this.fields.filter(c=>b.has(c.name));return new S(a,this.metadata)}selectAt(a){a=a.map(b=>this.fields[b]).filter(Boolean);return new S(a,this.metadata)}assign(...a){var b=
a[0]instanceof S?a[0]:Array.isArray(a[0])?new S(a[0]):new S(a);const c=[...this.fields];a=mh(mh(new Map,this.metadata),b.metadata);b=b.fields.filter(e=>{const f=c.findIndex(g=>g.name===e.name);return~f?(c[f]=e.clone({metadata:mh(mh(new Map,c[f].metadata),e.metadata)}))&&!1:!0});const d=lh(b,new Map);return new S([...c,...b],a,new Map([...this.dictionaries,...d]))}}S.prototype.fields=null;S.prototype.metadata=null;S.prototype.dictionaries=null;
class T{static new(...a){let [b,c,d,e]=a;a[0]&&typeof a[0]==="object"&&({name:b}=a[0],c===void 0&&(c=a[0].type),d===void 0&&(d=a[0].nullable),e===void 0&&(e=a[0].metadata));return new T(`${b}`,c,d,e)}constructor(a,b,c=!1,d){this.name=a;this.type=b;this.nullable=c;this.metadata=d||new Map}get typeId(){return this.type.typeId}get [Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...a){let [b,c,d,e]=a;a[0]&&typeof a[0]==="object"?{name:b=this.name,type:c=this.type,
nullable:d=this.nullable,metadata:e=this.metadata}=a[0]:[b=this.name,c=this.type,d=this.nullable,e=this.metadata]=a;return T.new(b,c,d,e)}}T.prototype.type=null;T.prototype.name=null;T.prototype.nullable=null;T.prototype.metadata=null;function mh(a,b){return new Map([...(a||new Map),...(b||new Map)])}
function lh(a,b=new Map){for(let c=-1,d=a.length;++c<d;){const e=a[c].type;if(J.isDictionary(e))if(!b.has(e.id))b.set(e.id,e.dictionary);else if(b.get(e.id)!==e.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");e.children&&e.children.length>0&&lh(e.children,b)}return b};function*nh(a){for(let b,c=-1,d=a.numDictionaries;++c<d;)if(b=a.Ja(c))yield b}
class oh{static decode(a){a=new Sa(p(Uint8Array,a));a=(new kh).i(a.v(a.position())+a.position(),a);const b=S.decode(a.schema(),new Map,a.version());return new ph(b,a)}static encode(a){const b=new fb;var c=S.encode(b,a.schema);cb(b,24,a.numRecordBatches,8);for(var d of[...a.jb()].slice().reverse())qh.encode(b,d);d=db(b);cb(b,24,a.numDictionaries,8);for(const e of[...nh(a)].slice().reverse())qh.encode(b,e);a=db(b);B(b,5);A(b,1,c);Ya(b,u.V5,u.V1);A(b,3,d);A(b,2,a);c=C(b);b.finish(c);return Ta(b)}get numRecordBatches(){return this.$.length}get numDictionaries(){return this.qb.length}constructor(a,
b=u.V5,c,d){this.schema=a;this.version=b;c&&(this.$=c);d&&(this.qb=d)}*jb(){for(let a,b=-1,c=this.numRecordBatches;++b<c;)if(a=this.ea(b))yield a}ea(a){return a>=0&&a<this.numRecordBatches&&this.$[a]||null}Ja(a){return a>=0&&a<this.numDictionaries&&this.qb[a]||null}}
class ph extends oh{get numRecordBatches(){var a=this.m;const b=z(a.g,a.h,10);return b?Ra(a.g,a.h+b):0}get numDictionaries(){var a=this.m;const b=z(a.g,a.h,8);return b?Ra(a.g,a.h+b):0}constructor(a,b){super(a,b.version());this.m=b}ea(a){return a>=0&&a<this.numRecordBatches&&(a=this.m.jb(a))?qh.decode(a):null}Ja(a){return a>=0&&a<this.numDictionaries&&(a=this.m.dictionaries(a))?qh.decode(a):null}}
class qh{static decode(a){return new qh(a.eb(),a.bodyLength(),a.offset())}static encode(a,b){var c=BigInt(b.offset),d=b.eb;b=BigInt(b.bodyLength);Ua(a,8,24);a.X(BigInt(b??0));a.pad(4);a.W(d);a.X(BigInt(c??0));return a.offset()}constructor(a,b,c){this.eb=a;this.offset=I(c);this.bodyLength=I(b)}};class rh{constructor(){this.g=null;this.h=0}i(a,b){this.h=a;this.g=b;return this}version(){const a=z(this.g,this.h,4);return a?La(this.g,this.h+a):u.V1}headerType(){const a=z(this.g,this.h,6);return a?this.g.l[this.h+a]:F.NONE}header(a){const b=z(this.g,this.h,8);return b?Na(this.g,a,this.h+b):null}bodyLength(){const a=z(this.g,this.h,10);return a?Ma(this.g,this.h+a):BigInt("0")}Ha(a){const b=z(this.g,this.h,12);return b?(new zb).i(Pa(this.g,Qa(this.g,this.h+b)+a*4),this.g):null}Ia(){const a=z(this.g,
this.h,12);return a?Ra(this.g,this.h+a):0}};class sh extends Ae{visit(a,b){return a==null||b==null?void 0:super.visit(a,b)}visitNull(a,b){B(b,0);return C(b)}visitInt(a,b){B(b,2);Za(b,0,a.bitWidth,0);Xa(b,1,+a.isSigned,0);return C(b)}visitFloat(a,b){B(b,1);Ya(b,a.precision,w.HALF);return C(b)}visitBinary(a,b){B(b,0);return C(b)}visitLargeBinary(a,b){B(b,0);return C(b)}visitBool(a,b){B(b,0);return C(b)}visitUtf8(a,b){B(b,0);return C(b)}visitLargeUtf8(a,b){B(b,0);return C(b)}visitDecimal(a,b){B(b,3);Za(b,1,a.scale,0);Za(b,0,a.precision,0);Za(b,
2,a.bitWidth,128);return C(b)}visitDate(a,b){B(b,1);Ya(b,a.unit,Ea.MILLISECOND);return C(b)}visitTime(a,b){B(b,2);Ya(b,a.unit,x.MILLISECOND);Za(b,1,a.bitWidth,32);return C(b)}visitTimestamp(a,b){const c=a.timezone&&eb(b,a.timezone)||void 0;B(b,2);Ya(b,a.unit,x.SECOND);c!==void 0&&A(b,1,c);return C(b)}visitInterval(a,b){B(b,1);Ya(b,a.unit,y.YEAR_MONTH);return C(b)}visitDuration(a,b){B(b,1);Ya(b,a.unit,x.MILLISECOND);return C(b)}visitList(a,b){B(b,0);return C(b)}visitStruct(a,b){B(b,0);return C(b)}visitUnion(a,
b){cb(b,4,a.typeIds.length,4);var c=a.typeIds;cb(b,4,c.length,4);for(let d=c.length-1;d>=0;d--)Wa(b,c[d]);c=db(b);B(b,2);Ya(b,a.mode,v.Sparse);A(b,1,c);return C(b)}visitDictionary(a,b){const c=this.visit(a.indices,b);B(b,4);$a(b,0,BigInt(a.id));Xa(b,2,+a.isOrdered,0);c!==void 0&&A(b,1,c);return C(b)}visitFixedSizeBinary(a,b){B(b,1);Za(b,0,a.byteWidth,0);return C(b)}visitFixedSizeList(a,b){B(b,1);Za(b,0,a.listSize,0);return C(b)}visitMap(a,b){B(b,1);Xa(b,0,+a.keysSorted,0);return C(b)}}const th=new sh;function uh(a){return new vh(a.count,wh(a.columns),xh(a.columns),null)}function yh(a,b){return(a.fields||[]).filter(Boolean).map(c=>T.fromJSON(c,b))}function zh(a,b){return(a.children||[]).filter(Boolean).map(c=>T.fromJSON(c,b))}function wh(a){return(a||[]).reduce((b,c)=>[...b,new Ah(c.count,Bh(c.VALIDITY)),...wh(c.children)],[])}
function xh(a,b=[]){for(let c=-1,d=(a||[]).length;++c<d;){const e=a[c];e.VALIDITY&&b.push(new Ch(b.length,e.VALIDITY.length));e.TYPE_ID&&b.push(new Ch(b.length,e.TYPE_ID.length));e.OFFSET&&b.push(new Ch(b.length,e.OFFSET.length));e.DATA&&b.push(new Ch(b.length,e.DATA.length));b=xh(e.children,b)}return b}function Bh(a){return(a||[]).reduce((b,c)=>b+ +(c===0),0)}function Dh(a=[]){return new Map(a.map(({key:b,value:c})=>[b,c]))}function Eh(a){return new vc(a.isSigned,a.bitWidth)}
function Fh(a,b){const c=a.type.name;switch(c){case "NONE":return new uc;case "null":return new uc;case "binary":return new Oc;case "largebinary":return new Sc;case "utf8":return new Wc;case "largeutf8":return new $c;case "bool":return new dd;case "list":return new Wd((b||[])[0]);case "struct":return new K(b||[]);case "struct_":return new K(b||[])}switch(c){case "int":return b=a.type,new vc(b.isSigned,b.bitWidth);case "floatingpoint":return new Hc(w[a.type.precision]);case "decimal":return b=a.type,
new hd(b.scale,b.precision,b.bitWidth);case "date":return new ld(Ea[a.type.unit]);case "time":return b=a.type,new rd(x[b.unit],b.bitWidth);case "timestamp":return b=a.type,new zd(x[b.unit],b.timezone);case "interval":return new Hd(y[a.type.unit]);case "duration":return new Od(x[a.type.unit]);case "union":a=a.type;const [d,...e]=(a.mode+"").toLowerCase();return new ce(v[d.toUpperCase()+e.join("")],a.typeIds||[],b||[]);case "fixedsizebinary":return new ie(a.type.byteWidth);case "fixedsizelist":return new me(a.type.listSize,
(b||[])[0]);case "map":return new qe((b||[])[0],a.type.keysSorted)}throw Error(`Unrecognized type: "${c}"`);};class Gh{static fromJSON(a,b){const c=new Gh(0,u.V5,b);c.Qa=Hh(a,b);return c}static decode(a){a=new Sa(p(Uint8Array,a));a=(new rh).i(a.v(a.position())+a.position(),a);var b=a.bodyLength();const c=a.version(),d=a.headerType();b=new Gh(b,c,d);b.Qa=Ih(a,d);return b}static encode(a){const b=new fb;let c=-1;a.isSchema()?c=S.encode(b,a.header()):a.isRecordBatch()?c=vh.encode(b,a.header()):a.isDictionaryBatch()&&(c=Jh.encode(b,a.header()));B(b,5);Ya(b,u.V5,u.V1);A(b,2,c);Xa(b,1,a.headerType,F.NONE);$a(b,
3,BigInt(a.bodyLength));a=C(b);b.finish(a);return Ta(b)}static from(a,b=0){if(a instanceof S)return new Gh(0,u.V5,F.Schema,a);if(a instanceof vh)return new Gh(b,u.V5,F.RecordBatch,a);if(a instanceof Jh)return new Gh(b,u.V5,F.DictionaryBatch,a);throw Error(`Unrecognized Message header: ${a}`);}get type(){return this.headerType}get version(){return this.Zb}get headerType(){return this.Vb}get compression(){return this.O}get bodyLength(){return this.Pb}header(){return this.Qa()}isSchema(){return this.headerType===
F.Schema}isRecordBatch(){return this.headerType===F.RecordBatch}isDictionaryBatch(){return this.headerType===F.DictionaryBatch}constructor(a,b,c,d){this.Zb=b;this.Vb=c;this.body=new Uint8Array(0);this.O=d?.compression;d&&(this.Qa=()=>d);this.Pb=I(a)}}class vh{get H(){return this.Xa}get length(){return this.Yb}get buffers(){return this.Na}get compression(){return this.O}constructor(a,b,c,d){this.Xa=b;this.Na=c;this.Yb=I(a);this.O=d}}
class Jh{get id(){return this.Wb}get data(){return this.Rb}get Ka(){return this.Xb}get length(){return this.data.length}get H(){return this.data.H}get buffers(){return this.data.buffers}constructor(a,b,c=!1){this.Rb=a;this.Xb=c;this.Wb=I(b)}}class Ch{constructor(a,b){this.offset=I(a);this.length=I(b)}}class Ah{constructor(a,b){this.length=I(a);this.nullCount=I(b)}}class Kh{constructor(a,b=gb.nb){this.type=a;this.method=b}}
function Hh(a,b){return()=>{switch(b){case F.Schema:return S.fromJSON(a);case F.RecordBatch:return vh.fromJSON(a);case F.DictionaryBatch:return Jh.fromJSON(a)}throw Error(`Unrecognized Message type: { name: ${F[b]}, type: ${b} }`);}}
function Ih(a,b){return()=>{switch(b){case F.Schema:return S.decode(a.header(new Ub),new Map,a.version());case F.RecordBatch:return vh.decode(a.header(new qb),a.version());case F.DictionaryBatch:return Jh.decode(a.header(new rb),a.version())}throw Error(`Unrecognized Message type: { name: ${F[b]}, type: ${b} }`);}}T.encode=Lh;T.decode=Mh;
T.fromJSON=function(a,b){var c;let d,e;b&&(e=a.dictionary)?(b.has(c=e.id)?(d=(d=e.indexType)?Eh(d):new Bc,c=new ve(b.get(c),d,c,e.isOrdered)):(d=(d=e.indexType)?Eh(d):new Bc,b.set(c,b=Fh(a,zh(a,b))),c=new ve(b,d,c,e.isOrdered)),a=new T(a.name,c,a.nullable,Dh(a.metadata))):(b=Fh(a,zh(a,b)),a=new T(a.name,b,a.nullable,Dh(a.metadata)));return a||null};S.encode=Nh;S.decode=Oh;S.fromJSON=function(a,b=new Map){return new S(yh(a,b),Dh(a.metadata),b)};vh.encode=Ph;vh.decode=Qh;vh.fromJSON=uh;Jh.encode=Rh;
Jh.decode=Sh;Jh.fromJSON=function(a){return new Jh(uh(a.data),a.id,a.isDelta)};Ah.encode=Th;Ah.decode=Uh;Ch.encode=Vh;Ch.decode=Wh;Kh.encode=Xh;Kh.decode=Yh;function Oh(a,b=new Map,c=u.V5){const d=[];for(let e,f=-1,g=-1,k=Tb(a);++f<k;)if(e=a.fields(f))d[++g]=T.decode(e,b);return new S(d,Zh(a),b,c)}
function Qh(a,b=u.V5){var c=a.length();const d=[];for(let f,g=-1,k=-1,n=ob(a);++g<n;)if(f=a.H(g))d[++k]=Ah.decode(f);const e=[];for(let f,g=-1,k=-1,n=pb(a);++g<n;)if(f=a.buffers(g))b<u.V4&&(f.h+=8*(g+1)),e[++k]=Ch.decode(f);return new vh(c,d,e,Yh(a.compression()))}function Sh(a,b=u.V5){return new Jh(vh.decode(a.data(),b),a.id(),a.Ka())}function Wh(a){return new Ch(a.offset(),a.length())}function Uh(a){return new Ah(a.length(),a.nullCount())}
function $h(a,b){const c=[];for(let d,e=-1,f=-1,g=Pb(a);++e<g;)if(d=a.children(e))c[++f]=T.decode(d,b);return c}function Mh(a,b){var c;let d,e;b&&(e=a.dictionary())?(b.has(c=I(e.id()))?(d=(d=xb(e))?ai(d):new Bc,c=new ve(b.get(c),d,c,e.isOrdered())):(d=(d=xb(e))?ai(d):new Bc,b.set(c,b=bi(a,$h(a,b))),c=new ve(b,d,c,e.isOrdered())),a=new T(a.name(),c,a.nullable(),Zh(a))):(b=bi(a,$h(a,b)),a=new T(a.name(),b,a.nullable(),Zh(a)));return a||null}
function Zh(a){const b=new Map;if(a)for(let c,d,e=-1,f=Math.trunc(a.Ia());++e<f;)(c=a.Ha(e))&&(d=c.key())!=null&&b.set(d,c.value());return b}function ai(a){return new vc(a.isSigned(),a.bitWidth())}
function bi(a,b){var c=(c=z(a.g,a.h,8))?a.g.l[a.h+c]:D.NONE;switch(c){case D.NONE:return new uc;case D.Null:return new uc;case D.Binary:return new Oc;case D.LargeBinary:return new Sc;case D.Utf8:return new Wc;case D.LargeUtf8:return new $c;case D.Bool:return new dd;case D.List:return new Wd((b||[])[0]);case D.Struct_:return new K(b||[])}switch(c){case D.Int:return b=a.type(new wb),new vc(b.isSigned(),b.bitWidth());case D.FloatingPoint:return b=a.type(new Hb),new Hc(b.precision());case D.Decimal:return b=
a.type(new Db),new hd(b.scale(),b.precision(),b.bitWidth());case D.Date:return b=a.type(new Cb),new ld(b.unit());case D.Time:return b=a.type(new Kb),new rd(b.unit(),b.bitWidth());case D.Timestamp:return b=a.type(new Lb),new zd(b.unit(),b.timezone());case D.Interval:return b=a.type(new Ib),new Hd(b.unit());case D.Duration:return b=a.type(new Eb),new Od(b.unit());case D.Union:c=a.type(new Mb);a=c.mode();const d=z(c.g,c.h,6);c=d?new Int32Array(c.g.bytes().buffer,c.g.bytes().byteOffset+Qa(c.g,c.h+d),
Ra(c.g,c.h+d)):null;return new ce(a,c||[],b||[]);case D.FixedSizeBinary:return b=a.type(new Fb),new ie(b.byteWidth());case D.FixedSizeList:return a=a.type(new Gb),new me(a.listSize(),(b||[])[0]);case D.Map:return a=a.type(new Jb),new qe((b||[])[0],a.keysSorted())}throw Error(`Unrecognized type: "${D[c]}" (${c})`);}function Yh(a){return a?new Kh(a.codec(),a.method()):null}
function Nh(a,b){var c=b.fields.map(d=>T.encode(a,d));cb(a,4,c.length,4);c=Rb(a,c);b=b.metadata&&b.metadata.size>0?Sb(a,[...b.metadata].map(([d,e])=>{d=eb(a,`${d}`);e=eb(a,`${e}`);B(a,2);A(a,0,d);A(a,1,e);return C(a)})):-1;B(a,4);A(a,1,c);Ya(a,ci?sb.Nb:sb.hc,sb.Nb);b!==-1&&A(a,2,b);return C(a)}
function Lh(a,b){let c=-1,d=-1,e=-1;var f=b.type;let g=b.typeId;J.isDictionary(f)?(g=f.dictionary.typeId,e=th.visit(f,a),d=th.visit(f.dictionary,a)):d=th.visit(f,a);f=(f.children||[]).map(n=>T.encode(a,n));f=Nb(a,f);const k=b.metadata&&b.metadata.size>0?Ob(a,[...b.metadata].map(([n,q])=>{n=eb(a,`${n}`);q=eb(a,`${q}`);B(a,2);A(a,0,n);A(a,1,q);return C(a)})):-1;b.name&&(c=eb(a,b.name));B(a,7);A(a,3,d);Xa(a,2,g,D.NONE);A(a,5,f);Xa(a,1,+!!b.nullable,0);c!==-1&&A(a,0,c);e!==-1&&A(a,4,e);k!==-1&&A(a,6,
k);return C(a)}function Ph(a,b){var c=b.H||[],d=b.buffers||[];cb(a,16,c.length,8);for(const f of c.slice().reverse())Ah.encode(a,f);c=db(a);cb(a,16,d.length,8);for(var e of d.slice().reverse())Ch.encode(a,e);d=db(a);e=null;b.compression!==null&&(e=Xh(a,b.compression));B(a,4);$a(a,0,BigInt(b.length));A(a,1,c);A(a,2,d);b.compression!==null&&e&&A(a,3,e);return C(a)}function Xh(a,b){B(a,2);Xa(a,0,b.type,ib.LZ4_FRAME);Xa(a,1,b.method,gb.nb);return C(a)}
function Rh(a,b){const c=vh.encode(a,b.data);B(a,3);$a(a,0,BigInt(b.id));Xa(a,2,+b.Ka,0);A(a,1,c);return C(a)}function Th(a,b){var c=BigInt(b.length);b=BigInt(b.nullCount);Ua(a,8,16);a.X(BigInt(b??0));a.X(BigInt(c??0));return a.offset()}function Vh(a,b){var c=BigInt(b.offset);b=BigInt(b.length);Ua(a,8,16);a.X(BigInt(b??0));a.X(BigInt(c??0));return a.offset()}const di=new ArrayBuffer(2);(new DataView(di)).setInt16(0,256,!0);const ci=(new Int16Array(di))[0]===256;const U=Object.freeze({done:!0,value:void 0});class ei{constructor(a){this.la=a}get schema(){return this.la.schema}get batches(){return this.la.batches||[]}get dictionaries(){return this.la.dictionaries||[]}}function fi(a){return a.ob||(a.ob=a.toDOMStream())}function gi(a,b,c){return gi(a.ub||(a.ub=a.toNodeStream()),b,c)}class hi{tee(){return fi(this).tee()}pipeTo(a,b){return fi(this).pipeTo(a,b)}pipeThrough(a,b){return fi(this).pipeThrough(a,b)}}
class ii extends hi{constructor(){super();this.o=[];this.ga=[];this.Pa=new Promise(a=>this.M=a)}get closed(){return this.Pa}async cancel(a){await this.return(a)}write(a){if(!this.M)throw Error("AsyncQueue is closed");this.ga.length<=0?this.o.push(a):this.ga.shift().resolve({done:!1,value:a})}abort(a){this.M&&(this.ga.length<=0?this.Sa={error:a}:this.ga.shift().reject({done:!0,value:a}))}close(){if(this.M){const a=this.ga;for(;a.length>0;)a.shift().resolve(U);this.M();this.M=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(a){return ra(this.M||
this.Sa?this:this.o,a)}toNodeStream(){return sa()}async throw(a){await this.abort(a);return U}async return(){await this.close();return U}async read(a){return(await this.next(a,"read")).value}async peek(a){return(await this.next(a,"peek")).value}next(){return this.o.length>0?Promise.resolve({done:!1,value:this.o.shift()}):this.Sa?Promise.reject({done:!0,value:this.Sa.error}):this.M?new Promise((a,b)=>{this.ga.push({resolve:a,reject:b})}):Promise.resolve(U)}};class ji extends ii{write(a){if((a=p(Uint8Array,a)).byteLength>0)return super.write(a)}toString(a=!1){return a?ba(this.toUint8Array(!0)):this.toUint8Array(!1).then(ba)}toUint8Array(a=!1){return a?ka(this.o)[0]:(async()=>{const b=[];let c=0;for await(const d of this)b.push(d),c+=d.byteLength;return ka(b,c)[0]})()}}
class ki{constructor(a){a&&(this.source=new li(ta(ua(a))))}[Symbol.iterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class mi{constructor(a){a instanceof mi?this.source=a.source:a instanceof ji?this.source=new ni(ta(wa(a))):fa(a)?this.source=new ni(ta(Aa(a))):ea(a)?this.source=new ni(ta(xa(a))):m(a)&&ea(a.body)?this.source=new ni(ta(xa(a.body))):m(a)&&l(a[Symbol.iterator])?this.source=new ni(ta(ua(a))):m(a)&&l(a.then)?this.source=new ni(ta(wa(a))):m(a)&&l(a[Symbol.asyncIterator])&&(this.source=new ni(ta(wa(a))))}[Symbol.asyncIterator](){return this}next(a){return this.source.next(a)}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}get closed(){return this.source.closed}cancel(a){return this.source.cancel(a)}peek(a){return this.source.peek(a)}read(a){return this.source.read(a)}}
class li{constructor(a){this.source=a}cancel(a){this.return(a)}peek(a){return this.next(a,"peek").value}read(a){return this.next(a,"read").value}next(a,b="read"){return this.source.next({N:b,size:a})}throw(a){return Object.create(this.source.throw&&this.source.throw(a)||U)}return(a){return Object.create(this.source.return&&this.source.return(a)||U)}}
class ni{constructor(a){this.source=a;this.Pa=new Promise(b=>this.M=b)}async cancel(a){await this.return(a)}get closed(){return this.Pa}async read(a){return(await this.next(a,"read")).value}async peek(a){return(await this.next(a,"peek")).value}async next(a,b="read"){return await this.source.next({N:b,size:a})}async throw(a){a=this.source.throw&&await this.source.throw(a)||U;this.M&&this.M();this.M=void 0;return Object.create(a)}async return(a){a=this.source.return&&await this.source.return(a)||U;
this.M&&this.M();this.M=void 0;return Object.create(a)}};class oi extends ki{constructor(a){super();this.position=0;this.buffer=p(Uint8Array,a);this.size=this.buffer.byteLength}v(a){const {buffer:b,byteOffset:c}=this.fa(a,4);return(new DataView(b,c)).getInt32(0,!0)}seek(a){this.position=Math.min(a,this.size);return a<this.size}read(a){const b=this.buffer,c=this.size,d=this.position;return b&&d<c?(typeof a!=="number"&&(a=Number.POSITIVE_INFINITY),this.position=Math.min(c,d+Math.min(c-d,a)),b.subarray(d,this.position)):null}fa(a,b){const c=this.buffer,d=
Math.min(this.size,a+b);return c?c.subarray(a,d):new Uint8Array(b)}close(){this.buffer&&(this.buffer=null)}throw(a){this.close();return{done:!0,value:a}}return(a){this.close();return{done:!0,value:a}}}
class pi extends mi{constructor(a,b){super();this.position=0;this.K=a;typeof b==="number"?this.size=b:this.I=(async()=>{this.size=(await a.stat()).size;delete this.I})()}async v(a){const {buffer:b,byteOffset:c}=await this.fa(a,4);return(new DataView(b,c)).getInt32(0,!0)}async seek(a){this.I&&await this.I;this.position=Math.min(a,this.size);return a<this.size}async read(a){this.I&&await this.I;const b=this.K;var c=this.size,d=this.position;if(b&&d<c){typeof a!=="number"&&(a=Number.POSITIVE_INFINITY);
let e=0,f=0;a=Math.min(c,d+Math.min(c-d,a));for(c=new Uint8Array(Math.max(0,(this.position=a)-d));(d+=f)<a&&(e+=f)<c.byteLength;)({jc:f}=await b.read(c,e,c.byteLength-e,d));return c}return null}async fa(a,b){this.I&&await this.I;const c=this.K;var d=this.size;return c&&a+b<d?(d=new Uint8Array(Math.min(d,a+b)-a),(await c.read(d,0,b,a)).buffer):new Uint8Array(b)}async close(){const a=this.K;this.K=null;a&&await a.close()}async throw(a){await this.close();return{done:!0,value:a}}async return(a){await this.close();
return{done:!0,value:a}}};function qi(a){a<0&&(a=4294967295+a+1);return`0x${a.toString(16)}`}const ri=[1,10,100,1E3,1E4,1E5,1E6,1E7,1E8];
function si(a,b){const c=new Uint32Array([a.buffer[1]>>>16,a.buffer[1]&65535,a.buffer[0]>>>16,a.buffer[0]&65535]);b=new Uint32Array([b.buffer[1]>>>16,b.buffer[1]&65535,b.buffer[0]>>>16,b.buffer[0]&65535]);let d=c[3]*b[3];a.buffer[0]=d&65535;let e=d>>>16;d=c[2]*b[3];e+=d;d=c[3]*b[2]>>>0;e+=d;a.buffer[0]+=e<<16;a.buffer[1]=e>>>0<d?65536:0;a.buffer[1]+=e>>>16;a.buffer[1]+=c[1]*b[3]+c[2]*b[2]+c[3]*b[1];a.buffer[1]+=c[0]*b[3]+c[1]*b[2]+c[2]*b[1]+c[3]*b[0]<<16}
function ti(a,b){const c=a.buffer[0]+b.buffer[0]>>>0;a.buffer[1]+=b.buffer[1];c<a.buffer[0]>>>0&&++a.buffer[1];a.buffer[0]=c}class ui{constructor(a){this.buffer=a}high(){return this.buffer[1]}low(){return this.buffer[0]}lessThan(a){return this.buffer[1]<a.buffer[1]||this.buffer[1]===a.buffer[1]&&this.buffer[0]<a.buffer[0]}equals(a){return this.buffer[1]===a.buffer[1]&&this.buffer[0]==a.buffer[0]}greaterThan(a){return a.lessThan(this)}hex(){return`${qi(this.buffer[1])} ${qi(this.buffer[0])}`}}
class V extends ui{times(a){si(this,a);return this}plus(a){ti(this,a);return this}static from(a,b=new Uint32Array(2)){return V.fromString(typeof a==="string"?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return V.fromString(a.toString(),b)}static fromString(a,b=new Uint32Array(2)){const c=a.length;b=new V(b);for(let d=0;d<c;){const e=8<c-d?8:c-d,f=new V(new Uint32Array([Number.parseInt(a.slice(d,d+e),10),0])),g=new V(new Uint32Array([ri[e],0]));b.times(g);b.plus(f);d+=e}return b}static convertArray(a){const b=
new Uint32Array(a.length*2);for(let c=-1,d=a.length;++c<d;)V.from(a[c],new Uint32Array(b.buffer,b.byteOffset+2*c*4,2));return b}static multiply(a,b){return(new V(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new V(new Uint32Array(a.buffer))).plus(b)}}
class vi extends ui{negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[0]==0&&++this.buffer[1];return this}times(a){si(this,a);return this}plus(a){ti(this,a);return this}lessThan(a){const b=this.buffer[1]<<0,c=a.buffer[1]<<0;return b<c||b===c&&this.buffer[0]<a.buffer[0]}static from(a,b=new Uint32Array(2)){return vi.fromString(typeof a==="string"?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(2)){return vi.fromString(a.toString(),b)}static fromString(a,b=
new Uint32Array(2)){const c=a.startsWith("-"),d=a.length;b=new vi(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,g=new vi(new Uint32Array([Number.parseInt(a.slice(e,e+f),10),0])),k=new vi(new Uint32Array([ri[f],0]));b.times(k);b.plus(g);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(a.length*2);for(let c=-1,d=a.length;++c<d;)vi.from(a[c],new Uint32Array(b.buffer,b.byteOffset+2*c*4,2));return b}static multiply(a,b){return(new vi(new Uint32Array(a.buffer))).times(b)}static add(a,
b){return(new vi(new Uint32Array(a.buffer))).plus(b)}}
class wi{constructor(a){this.buffer=a}high(){return new vi(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new vi(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){this.buffer[0]=~this.buffer[0]+1;this.buffer[1]=~this.buffer[1];this.buffer[2]=~this.buffer[2];this.buffer[3]=~this.buffer[3];this.buffer[0]==0&&++this.buffer[1];this.buffer[1]==0&&++this.buffer[2];this.buffer[2]==0&&++this.buffer[3];return this}times(a){const b=new V(new Uint32Array([this.buffer[3],
0])),c=new V(new Uint32Array([this.buffer[2],0])),d=new V(new Uint32Array([this.buffer[1],0])),e=new V(new Uint32Array([this.buffer[0],0])),f=new V(new Uint32Array([a.buffer[3],0])),g=new V(new Uint32Array([a.buffer[2],0])),k=new V(new Uint32Array([a.buffer[1],0]));a=new V(new Uint32Array([a.buffer[0],0]));let n=V.multiply(e,a);this.buffer[0]=n.low();const q=new V(new Uint32Array([n.high(),0]));n=V.multiply(d,a);q.plus(n);n=V.multiply(e,k);q.plus(n);this.buffer[1]=q.low();this.buffer[3]=q.lessThan(n)?
1:0;this.buffer[2]=q.high();(new V(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))).plus(V.multiply(c,a)).plus(V.multiply(d,k)).plus(V.multiply(e,g));this.buffer[3]+=V.multiply(b,a).plus(V.multiply(c,k)).plus(V.multiply(d,g)).plus(V.multiply(e,f)).low();return this}plus(a){const b=new Uint32Array(4);b[3]=this.buffer[3]+a.buffer[3]>>>0;b[2]=this.buffer[2]+a.buffer[2]>>>0;b[1]=this.buffer[1]+a.buffer[1]>>>0;b[0]=this.buffer[0]+a.buffer[0]>>>0;b[0]<this.buffer[0]>>>0&&++b[1];b[1]<this.buffer[1]>>>
0&&++b[2];b[2]<this.buffer[2]>>>0&&++b[3];this.buffer[3]=b[3];this.buffer[2]=b[2];this.buffer[1]=b[1];this.buffer[0]=b[0];return this}hex(){return`${qi(this.buffer[3])} ${qi(this.buffer[2])} ${qi(this.buffer[1])} ${qi(this.buffer[0])}`}static multiply(a,b){return(new wi(new Uint32Array(a.buffer))).times(b)}static add(a,b){return(new wi(new Uint32Array(a.buffer))).plus(b)}static from(a,b=new Uint32Array(4)){return wi.fromString(typeof a==="string"?a:a.toString(),b)}static fromNumber(a,b=new Uint32Array(4)){return wi.fromString(a.toString(),
b)}static fromString(a,b=new Uint32Array(4)){const c=a.startsWith("-"),d=a.length;b=new wi(b);for(let e=c?1:0;e<d;){const f=8<d-e?8:d-e,g=new wi(new Uint32Array([Number.parseInt(a.slice(e,e+f),10),0,0,0])),k=new wi(new Uint32Array([ri[f],0,0,0]));b.times(k);b.plus(g);e+=f}return c?b.negate():b}static convertArray(a){const b=new Uint32Array(a.length*4);for(let c=-1,d=a.length;++c<d;)wi.from(a[c],new Uint32Array(b.buffer,b.byteOffset+16*c,4));return b}}var xi={};xi.BaseInt64=ui;xi.Int128=wi;
xi.Int64=vi;xi.Uint64=V;function yi(a){const b=a.length,c=new Int32Array(b*2);for(let d=0,e=0;d<b;d++){const f=a[d];c[e++]=f.days??0;c[e++]=f.milliseconds??0}return c}function zi(a){const b=a.length,c=new Int32Array(b*4);for(let e=0,f=0;e<b;e++){var d=a[e];c[f++]=d.months??0;c[f++]=d.days??0;(d=d.nanoseconds)?(c[f++]=Number(BigInt(d)&BigInt(4294967295)),c[f++]=Number(BigInt(d)>>BigInt(32))):f+=2}return c}
function Ai(a){const b=a.length,c=Array(b/2);for(let d=0,e=0;d<b;d+=2)c[e++]={days:a[d],milliseconds:a[d+1]};return c}function Bi(a,b){const c=a.length,d=Array(c/4);for(let e=0,f=0;e<c;e+=4){const g=BigInt(a[e+3])<<BigInt(32)|BigInt(a[e+2]>>>0);d[f++]={months:a[e],days:a[e+1],nanoseconds:b?`${g}`:g}}return d}var Ci={};Ci.toIntervalDayTimeInt32Array=yi;Ci.toIntervalDayTimeObjects=Ai;Ci.toIntervalMonthDayNanoInt32Array=zi;Ci.toIntervalMonthDayNanoObjects=Bi;function W(a){return a.H[++a.ac]}function Di(a){return a.buffers[++a.zb]}
class Ei extends Ae{constructor(a,b,c,d,e=u.V5){super();this.zb=this.ac=-1;this.bytes=a;this.H=b;this.buffers=c;this.dictionaries=d;this.ta=e}visit(a){return super.visit(a instanceof T?a.type:a)}visitNull(a,{length:b}=W(this)){return P({type:a,length:b})}visitBool(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitInt(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitFloat(a,
{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitUtf8(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.aa(a),data:this.F(a)})}visitLargeUtf8(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.aa(a),data:this.F(a)})}visitBinary(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,
c),valueOffsets:this.aa(a),data:this.F(a)})}visitLargeBinary(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.aa(a),data:this.F(a)})}visitFixedSizeBinary(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitDate(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitTimestamp(a,{length:b,nullCount:c}=W(this)){return P({type:a,
length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitTime(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitDecimal(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitList(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.aa(a),child:this.visit(a.children[0])})}visitStruct(a,{length:b,nullCount:c}=
W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),children:this.visitMany(a.children)})}visitUnion(a,{length:b,nullCount:c}=W(this)){this.ta<u.V5&&this.D(a,c);return a.mode===v.Sparse?this.visitSparseUnion(a,{length:b,nullCount:c}):this.visitDenseUnion(a,{length:b,nullCount:c})}visitDenseUnion(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,typeIds:this.ib(a),valueOffsets:this.aa(a),children:this.visitMany(a.children)})}visitSparseUnion(a,{length:b,nullCount:c}=
W(this)){return P({type:a,length:b,nullCount:c,typeIds:this.ib(a),children:this.visitMany(a.children)})}visitDictionary(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a.indices),dictionary:this.dictionaries.get(a.id)})}visitInterval(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),data:this.F(a)})}visitDuration(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,
c),data:this.F(a)})}visitFixedSizeList(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),child:this.visit(a.children[0])})}visitMap(a,{length:b,nullCount:c}=W(this)){return P({type:a,length:b,nullCount:c,nullBitmap:this.D(a,c),valueOffsets:this.aa(a),child:this.visit(a.children[0])})}D(a,b){var c=Di(this);return b>0&&this.F(a,c)||new Uint8Array(0)}aa(a){return this.F(a)}ib(a){return this.F(a)}F(a,{length:b,offset:c}=Di(this)){return this.bytes.subarray(c,
c+b)}}
class Fi extends Ei{constructor(a,b,c,d,e){super(new Uint8Array(0),b,c,d,e);this.sources=a}D(a,b){({offset:a}=Di(this));return b<=0?new Uint8Array(0):vg(this.sources[a])}aa(a){({offset:b}=Di(this));var b;return p(Uint8Array,p(a.OffsetArrayType,this.sources[b]))}ib(a){({offset:b}=Di(this));var b;return p(Uint8Array,p(a.ArrayType,this.sources[b]))}F(a,{offset:b}=Di(this)){const c=this.sources;if(J.isTimestamp(a)||(J.isInt(a)||J.isTime(a))&&a.bitWidth===64||J.isDuration(a)||J.isDate(a)&&a.unit===Ea.MILLISECOND)return p(Uint8Array,
vi.convertArray(c[b]));if(J.isDecimal(a))return p(Uint8Array,wi.convertArray(c[b]));if(J.isBinary(a)||J.isLargeBinary(a)||J.isFixedSizeBinary(a))return Gi(c[b]);if(J.isBool(a))return vg(c[b]);if(J.isUtf8(a)||J.isLargeUtf8(a))return ca.encode(c[b].join(""));if(J.isInterval(a))switch(a.unit){case y.DAY_TIME:return yi(c[b]);case y.MONTH_DAY_NANO:return zi(c[b])}return p(Uint8Array,p(a.ArrayType,c[b].map(d=>+d)))}}
function Gi(a){a=a.join("");const b=new Uint8Array(a.length/2);for(let c=0;c<a.length;c+=2)b[c>>1]=Number.parseInt(a.slice(c,c+2),16);return b}class Hi extends Ei{constructor(a,b,c,d,e){super(new Uint8Array(0),b,c,d,e);this.$b=a}F(a,b=Di(this)){return this.$b[this.zb]}};class Ii extends ih{constructor(a){super(a);this.o=new bh(Uint8Array)}get byteLength(){let a=this.L+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,p(Uint8Array,b))}T(a,b){const c=this.j;b=ah(this.o,b).buffer;let d=0;for(const [e,f]of a)f===void 0?c.set(e,0):(a=f.length,b.set(f,d),c.set(e,a),d+=a)}};class Ji extends ih{constructor(a){super(a);this.o=new bh(Uint8Array)}get byteLength(){let a=this.L+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,p(Uint8Array,b))}T(a,b){const c=this.j;b=ah(this.o,b).buffer;let d=0;for(const [e,f]of a)f===void 0?c.set(e,BigInt(0)):(a=f.length,b.set(f,d),c.set(e,BigInt(a)),d+=a)}};class Ki extends fh{constructor(a){super(a);this.o=new dh}setValue(a,b){this.o.set(a,+b)}};class Li extends gh{}Li.prototype.B=Te;class Mi extends Li{}Mi.prototype.B=Oe;class Ni extends Li{}Ni.prototype.B=Pe;class Oi extends gh{}Oi.prototype.B=df;class Pi extends fh{constructor({type:a,nullValues:b,dictionaryHashFunction:c}){super({type:new ve(a.dictionary,a.indices,a.id,a.isOrdered)});this.G=null;this.za=0;this.tb=Object.create(null);this.indices=Qi({type:this.type.indices,nullValues:b});this.dictionary=Qi({type:this.type.dictionary,nullValues:null});typeof c==="function"&&(this.valueToKey=c)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+
this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(a){return this.indices.isValid(a)}setValid(a,b){const c=this.indices;b=c.setValid(a,b);this.length=c.length;return b}setValue(a,b){const c=this.tb,d=this.valueToKey(b);let e=c[d];e===void 0&&(c[d]=e=this.za+this.dictionary.append(b).length-1);return this.indices.setValue(a,e)}flush(){var a=
this.type;const b=this.Tb,c=this.dictionary.toVector();a=this.indices.flush().clone(a);a.dictionary=b?b.concat(c):c;this.finished||(this.za+=c.length);this.Tb=a.dictionary;this.clear();return a}finish(){this.indices.finish();this.dictionary.finish();this.za=0;this.tb=Object.create(null);return super.finish()}clear(){this.indices.clear();this.dictionary.clear();return super.clear()}valueToKey(a){return typeof a==="string"?a:`${a}`}};class Ri extends gh{}Ri.prototype.B=Qe;class Si extends fh{setValue(a,b){const [c]=this.children;a*=this.stride;for(let d=-1,e=this.stride;++d<e;)c.set(a+d,b[d])}setValid(a,b){super.setValid(a,b)||this.children[0].setValid((a+1)*this.stride-1,!1);return b}addChild(a,b="0"){if(this.numChildren>0)throw Error("FixedSizeListBuilder can only have one child.");const c=this.children.push(a);this.type=new me(this.type.listSize,new T(b,a.type,!0));return c}};class Ti extends gh{setValue(a,b){this.o.set(a,b)}}class Ui extends Ti{setValue(a,b){super.setValue(a,He(b))}}class Vi extends Ti{}class Wi extends Ti{};class Xi extends gh{}Xi.prototype.B=pf;class Yi extends Xi{}Yi.prototype.B=nf;class bj extends Xi{}bj.prototype.B=mf;class cj extends Xi{}cj.prototype.B=of;class dj extends gh{}dj.prototype.B=uf;class ej extends dj{}ej.prototype.B=qf;class fj extends dj{}fj.prototype.B=rf;class gj extends dj{}gj.prototype.B=sf;class hj extends dj{}hj.prototype.B=tf;class ij extends gh{setValue(a,b){this.o.set(a,b)}}class jj extends ij{}class kj extends ij{}class lj extends ij{}class mj extends ij{}class nj extends ij{}class oj extends ij{}class pj extends ij{}class qj extends ij{};class rj extends ih{constructor(a){super(a);this.j=new eh(a.type)}addChild(a,b="0"){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new Wd(new T(b,a.type,!0));return this.numChildren-1}T(a){const b=this.j,[c]=this.children;for(const [d,e]of a)if(typeof e==="undefined")b.set(d,0);else{a=e;const f=a.length,g=b.set(d,f).buffer[d];for(let k=-1;++k<f;)c.set(g+k,a[k])}}};class sj extends ih{set(a,b){return super.set(a,b)}setValue(a,b){b=b instanceof Map?b:new Map(Object.entries(b));const c=this.I||(this.I=new Map),d=c.get(a);d&&(this.L-=d.size);this.L+=b.size;c.set(a,b)}addChild(a,b=`${this.numChildren}`){if(this.numChildren>0)throw Error("ListBuilder can only have one child.");this.children[this.numChildren]=a;this.type=new qe(new T(b,a.type,!0),this.type.keysSorted);return this.numChildren-1}T(a){const b=this.j,[c]=this.children;for(const [d,e]of a)if(e===void 0)b.set(d,
0);else{let {[d]:f,[d+1]:g}=b.set(d,e.size).buffer;for(const k of e.entries())if(c.set(f,k),++f>=g)break}}};class tj extends fh{setValue(){}setValid(a,b){this.length=Math.max(a+1,this.length);return b}};class uj extends fh{setValue(a,b){const c=this.children,d=this.type;switch(Array.isArray(b)||b.constructor){case !0:return d.children.forEach((e,f)=>c[f].set(a,b[f]));case Map:return d.children.forEach((e,f)=>c[f].set(a,b.get(e.name)));default:return d.children.forEach((e,f)=>c[f].set(a,b[e.name]))}}setValid(a,b){super.setValid(a,b)||this.children.forEach(c=>c.setValid(a,b));return b}addChild(a,b=`${this.numChildren}`){const c=this.children.push(a);this.type=new K([...this.type.children,new T(b,a.type,
!0)]);return c}};class vj extends gh{}vj.prototype.B=Ye;class wj extends vj{}wj.prototype.B=Ue;class xj extends vj{}xj.prototype.B=Ve;class yj extends vj{}yj.prototype.B=We;class zj extends vj{}zj.prototype.B=Xe;class Aj extends gh{}Aj.prototype.B=cf;class Bj extends Aj{}Bj.prototype.B=Ze;class Cj extends Aj{}Cj.prototype.B=$e;class Dj extends Aj{}Dj.prototype.B=af;class Ej extends Aj{}Ej.prototype.B=bf;class Fj extends fh{constructor(a){super(a);this.Z=new ch(Int8Array,0,1);typeof a.valueToChildTypeId==="function"&&(this.wb=a.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(a,b){return this.set(this.length,a,b)}set(a,b,c){c===void 0&&(c=this.wb(this,b,a));this.setValue(a,b,c);return this}setValue(a,b,c){this.Z.set(a,c);this.children[this.type.typeIdToChildIndex[c]]?.set(a,b);this.length=Math.max(a+1,this.length)}addChild(a,b=`${this.children.length}`){const c=
this.children.push(a),d=this.type,e=d.mode,f=d.typeIds;a=[...d.children,new T(b,a.type)];this.type=new ce(e,[...f,c],a);return c}wb(){throw Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.");}}class Gj extends Fj{}
class Hj extends Fj{constructor(a){super(a);this.j=new ch(Int32Array)}setValue(a,b,c){c=this.Z.set(a,c).buffer[a];c=this.getChildAt(this.type.typeIdToChildIndex[c]);const d=this.j.set(a,c.length).buffer[a];c?.set(d,b);this.length=Math.max(a+1,this.length)}};class Ij extends ih{constructor(a){super(a);this.o=new bh(Uint8Array)}get byteLength(){let a=this.L+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,ca.encode(b))}T(){}}Ij.prototype.T=Ii.prototype.T;class Jj extends ih{constructor(a){super(a);this.o=new bh(Uint8Array)}get byteLength(){let a=this.L+this.length*4;this.j&&(a+=this.j.byteLength);this.o&&(a+=this.o.byteLength);this.G&&(a+=this.G.byteLength);return a}setValue(a,b){return super.setValue(a,ca.encode(b))}T(){}}Jj.prototype.T=Ji.prototype.T;class Kj extends Ae{visitNull(){return tj}visitBool(){return Ki}visitInt(){return ij}visitInt8(){return jj}visitInt16(){return kj}visitInt32(){return lj}visitInt64(){return mj}visitUint8(){return nj}visitUint16(){return oj}visitUint32(){return pj}visitUint64(){return qj}visitFloat(){return Ti}visitFloat16(){return Ui}visitFloat32(){return Vi}visitFloat64(){return Wi}visitUtf8(){return Ij}visitLargeUtf8(){return Jj}visitBinary(){return Ii}visitLargeBinary(){return Ji}visitFixedSizeBinary(){return Ri}visitDate(){return Li}visitDateDay(){return Mi}visitDateMillisecond(){return Ni}visitTimestamp(){return vj}visitTimestampSecond(){return wj}visitTimestampMillisecond(){return xj}visitTimestampMicrosecond(){return yj}visitTimestampNanosecond(){return zj}visitTime(){return Aj}visitTimeSecond(){return Bj}visitTimeMillisecond(){return Cj}visitTimeMicrosecond(){return Dj}visitTimeNanosecond(){return Ej}visitDecimal(){return Oi}visitList(){return rj}visitStruct(){return uj}visitUnion(){return Fj}visitDenseUnion(){return Hj}visitSparseUnion(){return Gj}visitDictionary(){return Pi}visitInterval(){return Xi}visitIntervalDayTime(){return Yi}visitIntervalYearMonth(){return bj}visitIntervalMonthDayNano(){return cj}visitDuration(){return dj}visitDurationSecond(){return ej}visitDurationMillisecond(){return fj}visitDurationMicrosecond(){return gj}visitDurationNanosecond(){return hj}visitFixedSizeList(){return Si}visitMap(){return sj}}
const Lj=new Kj;function Mj(a,b,c){return b===c||Array.isArray(b)&&Array.isArray(c)&&b.length===c.length&&b.every((d,e)=>a.compareFields(d,c[e]))}class Nj extends Ae{compareSchemas(a,b){return a===b||b instanceof a.constructor&&Mj(this,a.fields,b.fields)}compareFields(a,b){return a===b||b instanceof a.constructor&&a.name===b.name&&a.nullable===b.nullable&&this.visit(a.type,b.type)}}function Oj(a,b){return b instanceof a.constructor}function Pj(a,b){return a===b||Oj(a,b)}
function Qj(a,b){return a===b||Oj(a,b)&&a.bitWidth===b.bitWidth&&a.isSigned===b.isSigned}function Rj(a,b){return a===b||Oj(a,b)&&a.precision===b.precision}function Sj(a,b){return a===b||Oj(a,b)&&a.unit===b.unit}function Tj(a,b){return a===b||Oj(a,b)&&a.unit===b.unit&&a.timezone===b.timezone}function Uj(a,b){return a===b||Oj(a,b)&&a.unit===b.unit&&a.bitWidth===b.bitWidth}
function Vj(a,b){return a===b||Oj(a,b)&&a.mode===b.mode&&a.typeIds.every((c,d)=>c===b.typeIds[d])&&Mj(Wj,a.children,b.children)}function Xj(a,b){return a===b||Oj(a,b)&&a.unit===b.unit}function Yj(a,b){return a===b||Oj(a,b)&&a.unit===b.unit}h=Nj.prototype;h.visitNull=Pj;h.visitBool=Pj;h.visitInt=Qj;h.visitInt8=Qj;h.visitInt16=Qj;h.visitInt32=Qj;h.visitInt64=Qj;h.visitUint8=Qj;h.visitUint16=Qj;h.visitUint32=Qj;h.visitUint64=Qj;h.visitFloat=Rj;h.visitFloat16=Rj;h.visitFloat32=Rj;h.visitFloat64=Rj;
h.visitUtf8=Pj;h.visitLargeUtf8=Pj;h.visitBinary=Pj;h.visitLargeBinary=Pj;h.visitFixedSizeBinary=function(a,b){return a===b||Oj(a,b)&&a.byteWidth===b.byteWidth};h.visitDate=Sj;h.visitDateDay=Sj;h.visitDateMillisecond=Sj;h.visitTimestamp=Tj;h.visitTimestampSecond=Tj;h.visitTimestampMillisecond=Tj;h.visitTimestampMicrosecond=Tj;h.visitTimestampNanosecond=Tj;h.visitTime=Uj;h.visitTimeSecond=Uj;h.visitTimeMillisecond=Uj;h.visitTimeMicrosecond=Uj;h.visitTimeNanosecond=Uj;h.visitDecimal=Pj;
h.visitList=function(a,b){return a===b||Oj(a,b)&&a.children.length===b.children.length&&Mj(Wj,a.children,b.children)};h.visitStruct=function(a,b){return a===b||Oj(a,b)&&a.children.length===b.children.length&&Mj(Wj,a.children,b.children)};h.visitUnion=Vj;h.visitDenseUnion=Vj;h.visitSparseUnion=Vj;h.visitDictionary=function(a,b){return a===b||Oj(a,b)&&a.id===b.id&&a.isOrdered===b.isOrdered&&Wj.visit(a.indices,b.indices)&&Wj.visit(a.dictionary,b.dictionary)};h.visitInterval=Xj;
h.visitIntervalDayTime=Xj;h.visitIntervalYearMonth=Xj;h.visitIntervalMonthDayNano=Xj;h.visitDuration=Yj;h.visitDurationSecond=Yj;h.visitDurationMillisecond=Yj;h.visitDurationMicrosecond=Yj;h.visitDurationNanosecond=Yj;h.visitFixedSizeList=function(a,b){return a===b||Oj(a,b)&&a.listSize===b.listSize&&a.children.length===b.children.length&&Mj(Wj,a.children,b.children)};
h.visitMap=function(a,b){return a===b||Oj(a,b)&&a.keysSorted===b.keysSorted&&a.children.length===b.children.length&&Mj(Wj,a.children,b.children)};const Wj=new Nj;function Zj(a,b){return Wj.compareSchemas(a,b)}function ak(a,b){return Wj.visit(a,b)};function Qi(a){var b=a.type;const c=new (Lj.getVisitFn(b)())(a);if(b.children&&b.children.length>0){const d=a.children||[],e={nullValues:a.nullValues};a=Array.isArray(d)?(f,g)=>d[g]||e:({name:f})=>d[f]||e;for(const [f,g]of b.children.entries()){b=g.type;const k=a(g,f);c.children.push(Qi({...k,type:b}))}}return c}
function bk(a,b){if(a instanceof O||a instanceof M||a.type instanceof J||ArrayBuffer.isView(a))return Xg(a);b={type:b??ck(a),nullValues:[null]};a=[...dk(b)(a)];a=a.length===1?a[0]:a.reduce((c,d)=>c.concat(d));return J.isDictionary(a.type)?a.memoize():a}
function ck(a){if(a.length===0)return new uc;var b=0;let c=0,d=0,e=0,f=0,g=0,k=0,n=0;for(const q of a)if(q==null)++b;else{switch(typeof q){case "bigint":++g;continue;case "boolean":++k;continue;case "number":++e;continue;case "string":++f;continue;case "object":Array.isArray(q)?++c:Object.prototype.toString.call(q)==="[object Date]"?++n:++d;continue}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.");}if(e+b===a.length)return new Nc;if(f+b===a.length)return new ve(new Wc,
new Bc);if(g+b===a.length)return new Cc;if(k+b===a.length)return new dd;if(n+b===a.length)return new Ed;if(c+b===a.length){const q=ck(a[a.findIndex(t=>t!=null)]);if(a.every(t=>t==null||ak(q,ck(t))))return new Wd(new T("",q,!0))}else if(d+b===a.length){b=new Map;for(const q of a)for(const t of Object.keys(q))b.has(t)||q[t]==null||b.set(t,new T(t,ck([q[t]]),!0));return new K([...b.values()])}throw new TypeError("Unable to infer Vector type from input values, explicit type declaration expected.");}
function dk(a){const {queueingStrategy:b="count"}=a,{highWaterMark:c=b!=="bytes"?Number.POSITIVE_INFINITY:16384}=a,d=b!=="bytes"?"length":"byteLength";return function*(e){let f=0;const g=Qi(a);for(const k of e)g.append(k)[d]>=c&&++f&&(yield g.toVector());if(g.finish().length>0||f===0)yield g.toVector()}};function ek(a,b){return fk(a,b.map(c=>c.data.concat()))}function fk(a,b){const c=[...a.fields],d=[],e={fb:b.reduce((va,mb)=>Math.max(va,mb.length),0)};let f=0,g=0,k=-1;const n=b.length;let q,t=[];for(;e.fb-- >0;){g=Number.POSITIVE_INFINITY;for(k=-1;++k<n;)t[k]=q=b[k].shift(),g=Math.min(g,q?q.length:g);Number.isFinite(g)&&(t=gk(c,g,t,b,e),g>0&&(d[f++]=P({type:new K(c),length:g,nullCount:0,children:t.slice()})))}return[a=a.assign(c),d.map(va=>new X(a,va))]}
function gk(a,b,c,d,e){const f=(b+63&-64)>>3;for(let k=-1,n=d.length;++k<n;){const q=c[k];var g=q?.length;g>=b?g===b?c[k]=q:(c[k]=q.slice(0,b),e.fb=Math.max(e.fb,d[k].unshift(q.slice(b,g-b)))):(g=a[k],a[k]=g.clone({nullable:!0}),c[k]=q?.Oa(b)??P({type:g.type,length:b,nullCount:b,nullBitmap:new Uint8Array(f)}))}return c};class hk{constructor(...a){if(a.length===0)return this.batches=[],this.schema=new S([]),this.j=[0],this;let b,c;a[0]instanceof S&&(b=a.shift());a.at(-1)instanceof Uint32Array&&(c=a.pop());const d=e=>{if(e){if(e instanceof X)return[e];if(e instanceof hk)return e.batches;if(e instanceof O){if(e.type instanceof K)return[new X(new S(e.type.children),e)]}else{if(Array.isArray(e))return e.flatMap(g=>d(g));if(typeof e[Symbol.iterator]==="function")return[...e].flatMap(g=>d(g));if(typeof e==="object"){var f=
Object.keys(e);const g=f.map(k=>new M([e[k]]));f=b??new S(f.map((k,n)=>new T(String(k),g[n].type,g[n].nullable)));[,f]=ek(f,g);return f.length===0?[new X(e)]:f}}}return[]};a=a.flatMap(e=>d(e));b=b??a[0]?.schema??new S([]);if(!(b instanceof S))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const e of a){if(!(e instanceof X))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Zj(b,e.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.");
}this.schema=b;this.batches=a;this.j=c??Hg(this.data)}get data(){return this.batches.map(({data:a})=>a)}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce((a,b)=>a+b.length,0)}get nullCount(){this.P===-1&&(this.P=Gg(this.data));return this.P}isValid(){return!1}get(){return null}at(a){return this.get(a<0?this.numRows+a:a)}set(){}indexOf(){return-1}[Symbol.iterator](){return this.batches.length>0?Tg.visit(new M(this.data)):[][Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...a){const b=
this.schema;a=this.data.concat(a.flatMap(({data:c})=>c));return new hk(b,a.map(c=>new X(b,c)))}slice(a,b){const c=this.schema;[a,b]=ig({length:this.numRows},a,b);a=Ig(this.data,this.j,a,b);return new hk(c,a.map(d=>new X(c,d)))}getChild(a){return this.getChildAt(this.schema.fields.findIndex(b=>b.name===a))}getChildAt(a){if(a>-1&&a<this.schema.fields.length){const c=this.data.map(d=>d.children[a]);if(c.length===0){var {type:b}=this.schema.fields[a];b=P({type:b,length:0,nullCount:0});c.push(b.Oa(this.numRows))}return new M(c)}return null}setChild(a,
b){return this.setChildAt(this.schema.fields?.findIndex(c=>c.name===a),b)}setChildAt(a,b){let c=this.schema;var d=[...this.batches];if(a>-1&&a<this.numCols){b||=new M([P({type:new uc,length:this.numRows})]);d=c.fields.slice();const e=d[a].clone({type:b.type}),f=this.schema.fields.map((g,k)=>this.getChildAt(k));[d[a],f[a]]=[e,b];[c,d]=ek(c,f)}return new hk(c,d)}select(a){const b=this.schema.fields.reduce((c,d,e)=>c.set(d.name,e),new Map);return this.selectAt(a.map(c=>b.get(c)).filter(c=>c>-1))}selectAt(a){const b=
this.schema.selectAt(a),c=this.batches.map(d=>d.selectAt(a));return new hk(b,c)}assign(a){const b=this.schema.fields,[c,d]=a.schema.fields.reduce((g,k,n)=>{const [q,t]=g,va=b.findIndex(mb=>mb.name===k.name);~va?t[va]=n:q.push(n);return g},[[],[]]),e=this.schema.assign(a.schema),f=[...b.map((g,k)=>[k,d[k]]).map(([g,k])=>k===void 0?this.getChildAt(g):a.getChildAt(k)),...c.map(g=>a.getChildAt(g))].filter(Boolean);return new hk(...ek(e,f))}}var ik=Symbol.toStringTag,jk=hk.prototype;jk.schema=null;
jk.batches=[];jk.j=new Uint32Array([0]);jk.P=-1;jk[Symbol.isConcatSpreadable]=!0;jk.isValid=Lg(Kg);jk.get=Lg(zf.getVisitFn(G.Struct));jk.set=Mg(jf.getVisitFn(G.Struct));jk.indexOf=Ng(Qg.getVisitFn(G.Struct));hk[ik]="Table";class X{constructor(...a){switch(a.length){case 2:[this.schema]=a;if(!(this.schema instanceof S))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[,this.data=P({nullCount:0,type:new K(this.schema.fields),children:this.schema.fields.map(g=>P({type:g.type,nullCount:0}))})]=a;if(!(this.data instanceof O))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=kk(this.schema,this.data.children);break;case 1:const [b]=a,{fields:c,
children:d,length:e}=Object.keys(b).reduce((g,k,n)=>{g.children[n]=b[k];g.length=Math.max(g.length,b[k].length);g.fields[n]=T.new({name:k,type:b[k].type,nullable:!0});return g},{length:0,fields:[],children:[]});a=new S(c);const f=P({type:new K(c),length:e,children:d,nullCount:0});[this.schema,this.data]=kk(a,f.children,e);break;default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.");}}get dictionaries(){return this.Sb||(this.Sb=
lk(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(a){return this.data.getValid(a)}get(a){return zf.visit(this.data,a)}at(a){return this.get(a<0?this.numRows+a:a)}set(a,b){return jf.visit(this.data,a,b)}indexOf(a,b){return Qg.visit(this.data,a,b)}[Symbol.iterator](){return Tg.visit(new M([this.data]))}toArray(){return[...this]}concat(...a){return new hk(this.schema,[this,
...a])}slice(a,b){[a]=(new M([this.data])).slice(a,b).data;return new X(this.schema,a)}getChild(a){return this.getChildAt(this.schema.fields?.findIndex(b=>b.name===a))}getChildAt(a){return a>-1&&a<this.schema.fields.length?new M([this.data.children[a]]):null}setChild(a,b){return this.setChildAt(this.schema.fields?.findIndex(c=>c.name===a),b)}setChildAt(a,b){var c=this.schema,d=this.data;if(a>-1&&a<this.numCols){b||=new M([P({type:new uc,length:this.numRows})]);const e=c.fields.slice();d=d.children.slice();
c=e[a].clone({type:b.type});[e[a],d[a]]=[c,b.data[0]];c=new S(e,new Map(this.schema.metadata));d=P({type:new K(e),children:d})}return new X(c,d)}select(a){const b=this.schema.select(a),c=new K(b.fields),d=[];for(const e of a)a=this.schema.fields.findIndex(f=>f.name===e),~a&&(d[a]=this.data.children[a]);return new X(b,P({type:c,length:this.numRows,children:d}))}selectAt(a){const b=this.schema.selectAt(a);a=a.map(c=>this.data.children[c]).filter(Boolean);a=P({type:new K(b.fields),length:this.numRows,
children:a});return new X(b,a)}}var mk=Symbol.toStringTag,nk=X.prototype;nk.P=-1;nk[Symbol.isConcatSpreadable]=!0;X[mk]="RecordBatch";function kk(a,b,c=b.reduce((d,e)=>Math.max(d,e.length),0)){const d=[...a.fields],e=[...b],f=(c+63&-64)>>3;for(const [g,k]of a.fields.entries()){const n=b[g];n&&n.length===c||(d[g]=k.clone({nullable:!0}),e[g]=n?.Oa(c)??P({type:k.type,length:c,nullCount:c,nullBitmap:new Uint8Array(f)}))}return[a.assign(d),P({type:new K(d),length:c,children:e})]}
function lk(a,b,c=new Map){if((a?.length??0)>0&&a?.length===b?.length)for(let e=-1,f=a.length;++e<f;){var {type:d}=a[e];const g=b[e];for(const k of[g,...(g?.dictionary?.data||[])])lk(d.children,k?.children,c);if(J.isDictionary(d))if(d=d.id,!c.has(d))g?.dictionary&&c.set(d,g.dictionary);else if(c.get(d)!==g.dictionary)throw Error("Cannot create Schema containing two different dictionaries with the same Id");}return c}
class ok extends X{constructor(a){var b=a.fields.map(c=>P({type:c.type}));b=P({type:new K(a.fields),nullCount:0,children:b});super(a,b)}};const pk=a=>`Expected ${F[a]} Message in stream, but was null or length 0.`,qk=a=>`Header pointer of flatbuffer-encoded ${F[a]} Message is null or length 0.`,rk=(a,b)=>`Expected to read ${a} metadata bytes, but only read ${b}.`,sk=(a,b)=>`Expected to read ${a} bytes for message body, but only read ${b}.`;
class tk{constructor(a){this.source=a instanceof ki?a:new ki(a)}[Symbol.iterator](){return this}next(){let a;return(a=this.readMetadataLength()).done||a.value===-1&&(a=this.readMetadataLength()).done||(a=this.readMetadata(a.value)).done?U:a}throw(a){return this.source.throw(a)}return(a){return this.source.return(a)}readMessage(a){let b;if((b=this.next()).done)return null;if(a!=null&&b.value.headerType!==a)throw Error(pk(a));return b.value}readMessageBody(a){if(a<=0)return new Uint8Array(0);var b=
this.source.read(a);b=p(Uint8Array,b);if(b.byteLength<a)throw Error(sk(a,b.byteLength));return b.byteOffset%8===0&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}readSchema(a=!1){const b=F.Schema,c=this.readMessage(b)?.header();if(a&&!c)throw Error(qk(b));return c}readMetadataLength(){var a=this.source.read(4);a=(a&&new Sa(a))?.v(0)||0;return{done:a===0,value:a}}readMetadata(a){const b=this.source.read(a);if(!b)return U;if(b.byteLength<a)throw Error(rk(a,b.byteLength));return{done:!1,
value:Gh.decode(b)}}}
class uk{constructor(a,b){this.source=a instanceof mi?a:m(a)&&l(a.stat)&&typeof a.fd==="number"?new pi(a,b):new mi(a)}[Symbol.asyncIterator](){return this}async next(){let a;return(a=await this.readMetadataLength()).done||a.value===-1&&(a=await this.readMetadataLength()).done||(a=await this.readMetadata(a.value)).done?U:a}async throw(a){return await this.source.throw(a)}async return(a){return await this.source.return(a)}async readMessage(a){let b;if((b=await this.next()).done)return null;if(a!=null&&
b.value.headerType!==a)throw Error(pk(a));return b.value}async readMessageBody(a){if(a<=0)return new Uint8Array(0);var b=await this.source.read(a);b=p(Uint8Array,b);if(b.byteLength<a)throw Error(sk(a,b.byteLength));return b.byteOffset%8===0&&b.byteOffset+b.byteLength<=b.buffer.byteLength?b:b.slice()}async readSchema(a=!1){const b=F.Schema,c=(await this.readMessage(b))?.header();if(a&&!c)throw Error(qk(b));return c}async readMetadataLength(){var a=await this.source.read(4);a=(a&&new Sa(a))?.v(0)||
0;return{done:a===0,value:a}}async readMetadata(a){const b=await this.source.read(a);if(!b)return U;if(b.byteLength<a)throw Error(rk(a,b.byteLength));return{done:!1,value:Gh.decode(b)}}}
class vk extends tk{constructor(a){super(new Uint8Array(0));this.S=!1;this.xa=[];this.Y=this.pb=0;this.la=a instanceof ei?a:new ei(a)}next(){var a=this.la;if(!this.S)return this.S=!0,{done:!1,value:Gh.fromJSON(a.schema,F.Schema)};if(this.Y<a.dictionaries.length)return a=a.dictionaries[this.Y++],this.xa=a.data.columns,{done:!1,value:Gh.fromJSON(a,F.DictionaryBatch)};if(this.pb<a.batches.length)return a=a.batches[this.pb++],this.xa=a.columns,{done:!1,value:Gh.fromJSON(a,F.RecordBatch)};this.xa=[];return U}readMessageBody(){function a(b){return(b||
[]).reduce((c,d)=>[...c,...(d.VALIDITY&&[d.VALIDITY]||[]),...(d.TYPE_ID&&[d.TYPE_ID]||[]),...(d.OFFSET&&[d.OFFSET]||[]),...(d.DATA&&[d.DATA]||[]),...a(d.children)],[])}return a(this.xa)}readMessage(a){let b;if((b=this.next()).done)return null;if(a!=null&&b.value.headerType!==a)throw Error(pk(a));return b.value}readSchema(){const a=F.Schema,b=this.readMessage(a),c=b?.header();if(!b||!c)throw Error(qk(a));return c}}const wk=new Uint8Array(6);for(let a=0;a<6;a+=1)wk[a]="ARROW1".codePointAt(a);
function xk(a){for(let b=-1,c=wk.length;++b<c;)if(wk[b]!==a[0+b])return!1;return!0}const yk=wk.length,zk=yk+4,Ak=yk*2+4;class Bk{constructor(){this.Mb=new Uint8Array([4,34,77,24]);this.Ma=7}Hb(a){const b=new Uint8Array([1,2,3,4,5,6,7,8]);a=a.encode(b);return this.Va(a)}Va(a){return this.Ta(a)&&this.Ua(a)&&(a[4]&192)>>6===1}Ta(a){return a.length>=this.Ma}Ua(a){return this.Mb.every((b,c)=>a[c]===b)}}
class Ck{constructor(){this.Ob=new Uint8Array([40,181,47,253]);this.Ma=6}Hb(a){const b=new Uint8Array([1,2,3,4,5,6,7,8]);a=a.encode(b);return this.Va(a)}Va(a){return this.Ta(a)&&this.Ua(a)}Ta(a){return a.length>=this.Ma}Ua(a){return this.Ob.every((b,c)=>a[c]===b)}}const Dk={[ib.LZ4_FRAME]:new Bk,[ib.ZSTD]:new Ck};class Ek{constructor(){this.registry={}}set(a,b){if(b?.encode&&typeof b.encode==="function"&&!Dk[a].Hb(b))throw Error(`Encoder for ${ib[a]} is not valid.`);this.registry[a]=b}get(a){return this.registry?.[a]||null}}const Fk=new Ek;class Gk extends hi{constructor(a){super();this.u=a}get closed(){return this.u.closed}get schema(){return this.u.schema}get autoDestroy(){return this.u.autoDestroy}get dictionaries(){return this.u.dictionaries}get numDictionaries(){return this.u.numDictionaries}get numRecordBatches(){return this.u.numRecordBatches}get footer(){return this.u.isFile()?this.u.footer:null}isSync(){return this.u.isSync()}isAsync(){return this.u.isAsync()}isFile(){return this.u.isFile()}isStream(){return this.u.isStream()}next(){return this.u.next()}throw(a){return this.u.throw(a)}return(a){return this.u.return(a)}cancel(){return this.u.cancel()}reset(a){this.u.reset(a);
this.ub=this.ob=void 0;return this}open(a){a=this.u.open(a);return m(a)&&l(a.then)?a.then(()=>this):this}readRecordBatch(a){return this.u.isFile()?this.u.readRecordBatch(a):null}[Symbol.iterator](){return this.u[Symbol.iterator]()}[Symbol.asyncIterator](){return this.u[Symbol.asyncIterator]()}toDOMStream(){return ra(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return sa(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}static throughNode(){throw Error('"throughNode" not available in this environment');
}static throughDOM(){throw Error('"throughDOM" not available in this environment');}static from(a){return a instanceof Gk?a:m(a)&&m(a.schema)?new Hk(new Ik(a)):m(a)&&l(a.stat)&&typeof a.fd==="number"?Jk(a):m(a)&&l(a.then)?(async()=>await Gk.from(await a))():m(a)&&ea(a.body)||ea(a)||fa(a)||m(a)&&l(a[Symbol.asyncIterator])?Kk(new mi(a)):Lk(new ki(a))}static readAll(a){return a instanceof Gk?a.isSync()?Mk(a):Nk(a):m(a)&&m(a.schema)||ArrayBuffer.isView(a)||m(a)&&l(a[Symbol.iterator])||m(a)&&"done"in a&&
"value"in a?Mk(a):Nk(a)}}class Hk extends Gk{constructor(a){super(a);this.u=a}readAll(){return[...this]}[Symbol.iterator](){return this.u[Symbol.iterator]()}async*[Symbol.asyncIterator](){yield*this[Symbol.iterator]()}}class Ok extends Gk{constructor(a){super(a);this.u=a}async readAll(){const a=[];for await(const b of this)a.push(b);return a}[Symbol.iterator](){throw Error("AsyncRecordBatchStreamReader is not Iterable");}[Symbol.asyncIterator](){return this.u[Symbol.asyncIterator]()}}
class Pk extends Hk{constructor(a){super(a);this.u=a}}class Qk extends Ok{constructor(a){super(a);this.u=a}}function Rk(a,b,c){const d=[],e=[];let f=0;for(const {offset:k,length:n}of a.buffers)if(n===0)d.push(new Uint8Array(0)),e.push(new Ch(f,0));else{var g=new Sa(b.subarray(k,k+n));a=I(Ma(g,0));g=g.bytes().subarray(8);a=a===-1?g:c.decode(g);d.push(a);f+=(f+7&-8)-f;e.push(new Ch(f,a.length));f+=a.length}return{Fb:d,buffers:e}}
function Sk(a,b,c,d){return(new Hi(c,b.H,b.buffers,a.dictionaries,a.schema.ta)).visitMany(d)}function Tk(a,b,c){if(b.compression!=null){const d=Fk.get(b.compression.type);if(d?.decode&&typeof d.decode==="function"){const {Fb:e,buffers:f}=Rk(b,c,d);c=Sk(a,b,e,a.schema.fields);b=new vh(b.length,b.H,f,null)}else throw Error("Record batch is compressed but codec not found");}else c=a.Wa(b,c,a.schema.fields);b=P({type:new K(a.schema.fields),length:b.length,children:c});return new X(a.schema,b)}
function Uk(a,b,c){const d=b.id,e=b.Ka;var f=a.schema;const g=a.dictionaries.get(d);f=f.dictionaries.get(d);if(b.data.compression!=null){const k=Fk.get(b.data.compression.type);if(k?.decode&&typeof k.decode==="function"){const {Fb:n,buffers:q}=Rk(b.data,c,k);a=Sk(a,b.data,n,[f]);new Jh(new vh(b.data.length,b.data.H,q,null),d,e)}else throw Error("Dictionary batch is compressed but codec not found");}else a=a.Wa(b.data,c,[f]);return(g&&e?g.concat(new M(a)):new M(a)).memoize()}
class Vk{get numDictionaries(){return this.Y}get numRecordBatches(){return this.R}constructor(a=new Map){this.closed=!1;this.autoDestroy=!0;this.R=this.Y=0;this.dictionaries=a}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(a){this.R=this.Y=0;this.schema=a;this.dictionaries=new Map;return this}Wa(a,b,c){return(new Ei(b,a.H,a.buffers,this.dictionaries,this.schema.ta)).visitMany(c)}}
class Wk extends Vk{constructor(a){super();this.A=m(a)&&m(a.schema)?new vk(this.K=a):new tk(this.K=a)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset().A.return(),this.dictionaries=this.A=null)}open(a){this.closed||(this.autoDestroy=Xk(this,a),this.schema||(this.schema=this.A.readSchema())||this.cancel());return this}throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset().A.throw(a):U}return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?this.reset().A.return(a):U}next(){if(this.closed)return U;for(var a,b=this.A;a=this.na();)if(a.isSchema())this.reset(a.header());else{if(a.isRecordBatch()){this.R++;var c=a.header();b=b.readMessageBody(a.bodyLength);return{done:!1,value:Tk(this,c,b)}}a.isDictionaryBatch()&&(this.Y++,c=a.header(),a=b.readMessageBody(a.bodyLength),a=Uk(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&this.R===0?(this.R++,{done:!1,value:new ok(this.schema)}):this.return()}na(){return this.A.readMessage(void 0)}}
class Yk extends Vk{constructor(a,b){super(b);this.A=new uk(this.K=a)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}async cancel(){!this.closed&&(this.closed=!0)&&(await this.reset().A.return(),this.dictionaries=this.A=null)}async open(a){this.closed||(this.autoDestroy=Xk(this,a),this.schema||(this.schema=await this.A.readSchema())||await this.cancel());return this}async throw(a){return!this.closed&&this.autoDestroy&&(this.closed=!0)?await this.reset().A.throw(a):U}async return(a){return!this.closed&&
this.autoDestroy&&(this.closed=!0)?await this.reset().A.return(a):U}async next(){if(this.closed)return U;for(var a,b=this.A;a=await this.na();)if(a.isSchema())await this.reset(a.header());else{if(a.isRecordBatch()){this.R++;var c=a.header();b=await b.readMessageBody(a.bodyLength);return{done:!1,value:Tk(this,c,b)}}a.isDictionaryBatch()&&(this.Y++,c=a.header(),a=await b.readMessageBody(a.bodyLength),a=Uk(this,c,a),this.dictionaries.set(c.id,a))}return this.schema&&this.R===0?(this.R++,{done:!1,value:new ok(this.schema)}):
await this.return()}async na(){return await this.A.readMessage(void 0)}}
class Zk extends Wk{get footer(){return this.m}get numDictionaries(){return this.m?this.m.numDictionaries:0}get numRecordBatches(){return this.m?this.m.numRecordBatches:0}constructor(a){super(a instanceof oi?a:new oi(a))}isSync(){return!0}isFile(){return!0}open(a){if(!this.closed&&!this.m){this.schema=(this.m=this.$a()).schema;for(const b of nh(this.m))b&&this.Za(this.Y++)}return super.open(a)}readRecordBatch(a){if(this.closed)return null;this.m||this.open();if((a=this.m?.ea(a))&&this.K.seek(a.offset)){var b=
this.A.readMessage(F.RecordBatch);if(b?.isRecordBatch())return a=b.header(),b=this.A.readMessageBody(b.bodyLength),Tk(this,a,b)}return null}Za(a){if((a=this.m?.Ja(a))&&this.K.seek(a.offset)){var b=this.A.readMessage(F.DictionaryBatch);b?.isDictionaryBatch()&&(a=b.header(),b=this.A.readMessageBody(b.bodyLength),b=Uk(this,a,b),this.dictionaries.set(a.id,b))}}$a(){var a=this.K;const b=a.size-zk,c=a.v(b);a=a.fa(b-c,c);return oh.decode(a)}na(){this.m||this.open();if(this.m&&this.R<this.numRecordBatches){const a=
this.m?.ea(this.R);if(a&&this.K.seek(a.offset))return this.A.readMessage(void 0)}return null}}
class $k extends Yk{get footer(){return this.m}get numDictionaries(){return this.m?this.m.numDictionaries:0}get numRecordBatches(){return this.m?this.m.numRecordBatches:0}constructor(a){var b=[];const c=typeof b[0]!=="number"?b.shift():void 0;b=b[0]instanceof Map?b.shift():void 0;super(a instanceof pi?a:new pi(a,c),b)}isFile(){return!0}isAsync(){return!0}async open(a){if(!this.closed&&!this.m){this.schema=(this.m=await this.$a()).schema;for(const b of nh(this.m))b&&await this.Za(this.Y++)}return await super.open(a)}async readRecordBatch(a){if(this.closed)return null;
this.m||await this.open();if((a=this.m?.ea(a))&&await this.K.seek(a.offset)){var b=await this.A.readMessage(F.RecordBatch);if(b?.isRecordBatch())return a=b.header(),b=await this.A.readMessageBody(b.bodyLength),Tk(this,a,b)}return null}async Za(a){if((a=this.m?.Ja(a))&&await this.K.seek(a.offset)){var b=await this.A.readMessage(F.DictionaryBatch);b?.isDictionaryBatch()&&(a=b.header(),b=await this.A.readMessageBody(b.bodyLength),b=Uk(this,a,b),this.dictionaries.set(a.id,b))}}async $a(){var a=this.K;
a.I&&await a.I;const b=a.size-zk,c=await a.v(b);a=await a.fa(b-c,c);return oh.decode(a)}async na(){this.m||await this.open();if(this.m&&this.R<this.numRecordBatches){const a=this.m.ea(this.R);if(a&&await this.K.seek(a.offset))return await this.A.readMessage(void 0)}return null}}class Ik extends Wk{Wa(a,b,c){return(new Fi(b,a.H,a.buffers,this.dictionaries,this.schema.ta)).visitMany(c)}}function Xk(a,b){return b&&typeof b.autoDestroy==="boolean"?b.autoDestroy:a.autoDestroy}
function*Mk(a){a=Gk.from(a);try{if(!a.open({autoDestroy:!1}).closed){do yield a;while(!a.reset().open().closed)}}finally{a.cancel()}}async function*Nk(a){a=await Gk.from(a);try{if(!(await a.open({autoDestroy:!1})).closed){do yield a;while(!(await a.reset().open()).closed)}}finally{await a.cancel()}}function Lk(a){const b=a.peek(yk+7&-8);return b&&b.byteLength>=4?xk(b)?new Pk(new Zk(a.read())):new Hk(new Wk(a)):new Hk(new Wk(function*(){}()))}
async function Kk(a){const b=await a.peek(yk+7&-8);return b&&b.byteLength>=4?xk(b)?new Pk(new Zk(await a.read())):new Ok(new Yk(a)):new Ok(new Yk(async function*(){}()))}async function Jk(a){const {size:b}=await a.stat();a=new pi(a,b);return b>=Ak&&xk(await a.fa(0,yk+7&-8))?new Qk(new $k(a)):new Ok(new Yk(a))};class al extends Ae{static Ga(...a){const b=d=>d.flatMap(e=>Array.isArray(e)?b(e):e instanceof X?e.data.children:e.data),c=new al;c.visitMany(b(a));return c}constructor(){super();this.ya=0;this.Xa=[];this.Na=[];this.Qb=[]}visit(a){if(a instanceof M)return this.visitMany(a.data),this;const b=a.type;if(!J.isDictionary(b)){const c=a.length;if(c>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(J.isUnion(b))this.H.push(new Ah(c,0));else{const d=a.nullCount;J.isNull(b)||
bl.call(this,d<=0?new Uint8Array(0):ug(a.offset,c,a.nullBitmap));this.H.push(new Ah(c,d))}}return super.visit(a)}visitNull(){return this}visitDictionary(a){return this.visit(a.clone(a.type.indices))}get H(){return this.Xa}get buffers(){return this.Na}get byteLength(){return this.ya}get ca(){return this.Qb}}function bl(a){const b=a.byteLength+7&-8;this.buffers.push(a);this.ca.push(new Ch(this.ya,b));this.ya+=b;return this}function cl(a){return bl.call(this,a.values.subarray(0,a.length*a.stride))}
function dl(a){const b=a.length,c=a.values;a=a.valueOffsets;const d=I(a[0]);var e=I(a[b]);e=Math.min(e-d,c.byteLength-d);bl.call(this,pa(-d,b+1,a));bl.call(this,c.subarray(d,d+e));return this}function el(a){const b=a.length,c=a.valueOffsets;if(c){const {[0]:d,[b]:e}=c;bl.call(this,pa(-d,b+1,c));return this.visit(a.children[0].slice(d,e-d))}return this.visit(a.children[0])}function fl(a){return this.visitMany(a.type.children.map((b,c)=>a.children[c]).filter(Boolean))[0]}h=al.prototype;
h.visitBool=function(a){let b;return a.nullCount>=a.length?bl.call(this,new Uint8Array(0)):(b=a.values)instanceof Uint8Array?bl.call(this,ug(a.offset,a.length,b)):bl.call(this,vg(a.values))};h.visitInt=cl;h.visitFloat=cl;h.visitUtf8=dl;h.visitLargeUtf8=dl;h.visitBinary=dl;h.visitLargeBinary=dl;h.visitFixedSizeBinary=cl;h.visitDate=cl;h.visitTimestamp=cl;h.visitTime=cl;h.visitDecimal=cl;h.visitList=el;h.visitStruct=fl;
h.visitUnion=function(a){const b=a.type,c=a.length,d=a.typeIds,e=a.valueOffsets;bl.call(this,d);if(b.mode===v.Sparse)return fl.call(this,a);if(b.mode===v.Dense){if(a.offset<=0)return bl.call(this,e),fl.call(this,a);const f=new Int32Array(c),g=Object.create(null),k=Object.create(null);for(let n,q,t=-1;++t<c;)(n=d[t])!==void 0&&((q=g[n])===void 0&&(q=g[n]=e[t]),f[t]=e[t]-q,k[n]=(k[n]??0)+1);bl.call(this,f);this.visitMany(a.children.map((n,q)=>{q=b.typeIds[q];return n.slice(g[q],Math.min(c,k[q]))}))}return this};
h.visitInterval=cl;h.visitDuration=cl;h.visitFixedSizeList=el;h.visitMap=el;class gl extends Ae{visit(a){return a==null?void 0:super.visit(a)}visitNull({typeId:a}){return{name:D[a].toLowerCase()}}visitInt({typeId:a,bitWidth:b,isSigned:c}){return{name:D[a].toLowerCase(),bitWidth:b,isSigned:c}}visitFloat({typeId:a,precision:b}){return{name:D[a].toLowerCase(),precision:w[b]}}visitBinary({typeId:a}){return{name:D[a].toLowerCase()}}visitLargeBinary({typeId:a}){return{name:D[a].toLowerCase()}}visitBool({typeId:a}){return{name:D[a].toLowerCase()}}visitUtf8({typeId:a}){return{name:D[a].toLowerCase()}}visitLargeUtf8({typeId:a}){return{name:D[a].toLowerCase()}}visitDecimal({typeId:a,
scale:b,precision:c,bitWidth:d}){return{name:D[a].toLowerCase(),scale:b,precision:c,bitWidth:d}}visitDate({typeId:a,unit:b}){return{name:D[a].toLowerCase(),unit:Ea[b]}}visitTime({typeId:a,unit:b,bitWidth:c}){return{name:D[a].toLowerCase(),unit:x[b],bitWidth:c}}visitTimestamp({typeId:a,timezone:b,unit:c}){return{name:D[a].toLowerCase(),unit:x[c],timezone:b}}visitInterval({typeId:a,unit:b}){return{name:D[a].toLowerCase(),unit:y[b]}}visitDuration({typeId:a,unit:b}){return{name:D[a].toLocaleLowerCase(),
unit:x[b]}}visitList({typeId:a}){return{name:D[a].toLowerCase()}}visitStruct({typeId:a}){return{name:D[a].toLowerCase()}}visitUnion({typeId:a,mode:b,typeIds:c}){return{name:D[a].toLowerCase(),mode:v[b].toUpperCase(),typeIds:[...c]}}visitDictionary(a){return this.visit(a.dictionary)}visitFixedSizeBinary({typeId:a,byteWidth:b}){return{name:D[a].toLowerCase(),byteWidth:b}}visitFixedSizeList({typeId:a,listSize:b}){return{name:D[a].toLowerCase(),listSize:b}}visitMap({typeId:a,keysSorted:b}){return{name:D[a].toLowerCase(),
keysSorted:b}}};class hl extends Ae{static Ga(...a){const b=new hl;return a.map(({schema:c,data:d})=>b.visitMany(c.fields,d.children))}visit({name:a},b){const c=b.length,d=b.offset,e=b.nullCount,f=b.nullBitmap,g=J.isDictionary(b.type)?b.type.indices:b.type,k=Object.assign([],b.buffers,{[$b.VALIDITY]:void 0});return{name:a,count:c,VALIDITY:J.isNull(g)||J.isUnion(g)?void 0:e<=0?Array.from({length:c},()=>1):[...(new wg(f,d,c,null,tg))],...super.visit(b.clone(g,d,c,0,k))}}visitNull(){return{}}visitBool({values:a,offset:b,
length:c}){return{DATA:[...(new wg(a,b,c,null,sg))]}}visitInt(a){return{DATA:a.type.bitWidth<64?[...a.values]:[...il(a.values,2)]}}visitFloat(a){return{DATA:[...a.values]}}visitUtf8(a){return{DATA:[...(new M([a]))],OFFSET:[...a.valueOffsets]}}visitLargeUtf8(a){return{DATA:[...(new M([a]))],OFFSET:[...il(a.valueOffsets,2)]}}visitBinary(a){return{DATA:[...jl(new M([a]))],OFFSET:[...a.valueOffsets]}}visitLargeBinary(a){return{DATA:[...jl(new M([a]))],OFFSET:[...il(a.valueOffsets,2)]}}visitFixedSizeBinary(a){return{DATA:[...jl(new M([a]))]}}visitDate(a){return{DATA:a.type.unit===
Ea.DAY?[...a.values]:[...il(a.values,2)]}}visitTimestamp(a){return{DATA:[...il(a.values,2)]}}visitTime(a){return{DATA:a.type.unit<x.MICROSECOND?[...a.values]:[...il(a.values,2)]}}visitDecimal(a){return{DATA:[...il(a.values,4)]}}visitList(a){return{OFFSET:[...a.valueOffsets],children:this.visitMany(a.type.children,a.children)}}visitStruct(a){return{children:this.visitMany(a.type.children,a.children)}}visitUnion(a){return{TYPE_ID:[...a.typeIds],OFFSET:a.type.mode===v.Dense?[...a.valueOffsets]:void 0,
children:this.visitMany(a.type.children,a.children)}}visitInterval(a){switch(a.type.unit){case y.YEAR_MONTH:return{DATA:[...a.values]};case y.DAY_TIME:return{DATA:Ai(a.values)};case y.MONTH_DAY_NANO:return{DATA:Bi(a.values,!0)}}}visitDuration(a){return{DATA:[...il(a.values,2)]}}visitFixedSizeList(a){return{children:this.visitMany(a.type.children,a.children)}}visitMap(a){return{OFFSET:[...a.valueOffsets],children:this.visitMany(a.type.children,a.children)}}}
function*jl(a){for(const b of a)yield b.reduce((c,d)=>`${c}${("0"+(d&255).toString(16)).slice(-2)}`,"").toUpperCase()}function*il(a,b){a=new Uint32Array(a.buffer);for(let c=-1,d=a.length/b;++c<d;)yield`${pc.new(a.subarray((c+0)*b,(c+1)*b),!1)}`};function Y(a,b){a.oa&&(b=p(Uint8Array,b))&&b.byteLength>0&&(a.J.write(b),a.ma+=b.byteLength);return a}function kl(a,b){return b>0?Y(a,new Uint8Array(b)):a}
function ll(a,b){let {byteLength:c,H:d,ca:e,buffers:f}=al.Ga(b);if(a.O!=null){var g=f;b=Fk.get(a.O.type);if(!b?.encode||typeof b.encode!=="function")throw Error(`Codec for compression type "${ib[a.O.type]}" has invalid encode method`);a=0;const q=[],t=[];for(const va of g){var k=p(Uint8Array,va);if(k.length===0)q.push(new Uint8Array(0),new Uint8Array(0)),t.push(new Ch(a,0));else{var n=b.encode(k);k=(g=n.length<k.length)?n:k;g=g?k.length:-1;n=new Sa(new Uint8Array(8));n.X(0,BigInt(g));q.push(n.bytes(),
new Uint8Array(k));a+=(a+7&-8)-a;g=8+k.length;t.push(new Ch(a,g));a+=g}}({byteLength:c,ca:e,buffers:f}={byteLength:a+((a+7&-8)-a),ca:t,buffers:q})}return{byteLength:c,H:d,ca:e,buffers:f}}function ml(a,b){const c=a.O!=null?2:1,d=Array(c);for(let f=0;f<b.length;f+=c){var e=0;for(let g=-1;++g<c;)d[g]=b[f+g],e+=d[g].byteLength;if(e!==0){for(const g of d)Y(a,g);e=(e+7&-8)-e;e>0&&kl(a,e)}}return a}
class nl extends hi{static throughNode(){throw Error('"throughNode" not available in this environment');}static throughDOM(){throw Error('"throughDOM" not available in this environment');}constructor(a){super();this.ma=0;this.oa=!1;this.O=null;this.J=new ji;this.S=null;this.ka=[];this.Aa=[];this.Ca=new Map;this.Ra=new Map;m(a)||(a={autoDestroy:!0,Lb:!1,ra:null});this.wa=typeof a.autoDestroy==="boolean"?a.autoDestroy:!0;this.qa=typeof a.Lb==="boolean"?a.Lb:!1;if(a.ra!=null){if(this.qa)throw Error("Legacy IPC format does not support columnar compression. Use modern IPC format (writeLegacyIpcFormat=false).");
if(Object.values(ib).includes(a.ra))this.O=new Kh(a.ra);else{const b=Object.values(ib).filter(c=>typeof c==="string");throw Error(`Unsupported compressionType: ${a.ra} Available types: ${b.join(", ")}`);}}else this.O=null}toString(a=!1){return this.J.toString(a)}toUint8Array(a=!1){return this.J.toUint8Array(a)}writeAll(a){return m(a)&&l(a.then)?a.then(b=>this.writeAll(b)):m(a)&&l(a[Symbol.asyncIterator])?ol(this,a):pl(this,a)}get closed(){return this.J.closed}[Symbol.asyncIterator](){return this.J[Symbol.asyncIterator]()}toDOMStream(a){return this.J.toDOMStream(a)}toNodeStream(a){return this.J.toNodeStream(a)}close(){return this.reset().J.close()}abort(a){return this.reset().J.abort(a)}finish(){this.wa?
this.close():this.reset(this.J,this.S);return this}reset(a=this.J,b=null){a===this.J||a instanceof ji?this.J=a:(this.J=new ji,a&&m(a)&&l(a.abort)&&l(a.getWriter)&&!da(a)?this.toDOMStream({type:"bytes"}).pipeTo(a):a&&m(a)&&l(a.end)&&l(a.write)&&typeof a.writable==="boolean"&&!da(a)&&gi(this.toNodeStream({kc:!1}),a));this.oa&&this.S&&this.Ea(this.S);this.oa=!1;this.ka=[];this.Aa=[];this.Ca=new Map;this.Ra=new Map;b&&Zj(b,this.S)||(b==null?(this.ma=0,this.S=null):(this.oa=!0,this.S=b,this.ab(b)));return this}write(a){let b=
null;if(this.J){if(a==null||a instanceof hk&&!(b=a.schema)||a instanceof X&&!(b=a.schema))return this.finish()&&void 0}else throw Error("RecordBatchWriter is closed");if(b&&!Zj(b,this.S)){if(this.oa&&this.wa)return this.close();this.reset(this.J,b)}a instanceof X?a instanceof ok||this.xb(a):a instanceof hk?this.writeAll(a.batches):m(a)&&l(a[Symbol.iterator])&&this.writeAll(a)}Fa(a){const b=Gh.encode(a),c=b.byteLength,d=this.qa?4:8,e=c+d+7&-8,f=e-c-d;a.headerType===F.RecordBatch?this.Aa.push(new qh(e,
a.bodyLength,this.ma)):a.headerType===F.DictionaryBatch&&this.ka.push(new qh(e,a.bodyLength,this.ma));this.qa||Y(this,Int32Array.of(-1));Y(this,Int32Array.of(e-d));c>0&&Y(this,b);return kl(this,f)}ab(a){this.Fa(Gh.from(a))}Ea(){return this.qa?Y(this,Int32Array.of(0)):Y(this,Int32Array.of(-1,0))}xb(a){const {byteLength:b,H:c,ca:d,buffers:e}=ll(this,a);var f=new vh(a.numRows,c,d,this.O);f=Gh.from(f,b);ml(this.Da(a).Fa(f),e)}pa(a,b,c=!1){const {byteLength:d,H:e,ca:f,buffers:g}=ll(this,new M([a]));a=
new vh(a.length,e,f,this.O);b=new Jh(a,b,c);b=Gh.from(b,d);return ml(this.Fa(b),g)}Da(a){for(const [b,c]of a.dictionaries){a=c?.data??[];const d=this.Ca.get(b),e=this.Ra.get(b)??0;if(!d||d.data[0]!==a[0])for(const [f,g]of a.entries())this.pa(g,b,f>0);else if(e<a.length)for(const f of a.slice(e))this.pa(f,b,!0);this.Ca.set(b,c);this.Ra.set(b,a.length)}return this}}
class ql extends nl{static writeAll(a,b){const c=new ql(b);return m(a)&&l(a.then)?a.then(d=>c.writeAll(d)):m(a)&&l(a[Symbol.asyncIterator])?ol(c,a):pl(c,a)}}
class rl extends nl{static writeAll(a,b){const c=new rl(b);return m(a)&&l(a.then)?a.then(d=>c.writeAll(d)):m(a)&&l(a[Symbol.asyncIterator])?ol(c,a):pl(c,a)}constructor(a){super(a);this.wa=!0;this.qa=!1}ab(){kl(Y(this,wk),2)}pa(a,b,c=!1){if(!c&&this.Ca.has(b))throw Error("The Arrow File format does not support replacement dictionaries. ");return super.pa(a,b,c)}Ea(a){const b=oh.encode(new oh(a,u.V5,this.Aa,this.ka));a=Y(Y(super.Ea(a),b),Int32Array.of(b.byteLength));return Y(a,wk)}}
class sl extends nl{static writeAll(a){return(new sl).writeAll(a)}constructor(){super();this.wa=!0;this.$=[];this.Ba=[]}Fa(){return this}Ea(){return this}ab(a){Y(this,`{\n  "schema": ${JSON.stringify({fields:a.fields.map(b=>tl(b))},null,2)}`)}Da(a){a.dictionaries.size>0&&this.Ba.push(a);return this}pa(a,b,c=!1){Y(this,this.ka.length===0?"    ":",\n    ");Y(this,ul(a,b,c));this.ka.push(new qh(0,0,0));return this}xb(a){this.Da(a);this.$.push(a)}close(){if(this.Ba.length>0){Y(this,',\n  "dictionaries": [\n');
for(var a of this.Ba)super.Da(a);Y(this,"\n  ]")}if(this.$.length>0){for(let b=-1,c=this.$.length;++b<c;){Y(this,b===0?',\n  "batches": [\n    ':",\n    ");a=this.$[b];const [d]=hl.Ga(a);a=JSON.stringify({count:a.numRows,columns:d},null,2);Y(this,a);this.Aa.push(new qh(0,0,0))}Y(this,"\n  ]")}this.S&&Y(this,"\n}");this.Ba=[];this.$=[];return super.close()}}function pl(a,b){let c=b;b instanceof hk&&(c=b.batches,a.reset(void 0,b.schema));for(const d of c)a.write(d);return a.finish()}
async function ol(a,b){for await(const c of b)a.write(c);return a.finish()}function tl({name:a,type:b,nullable:c}){const d=new gl;return{name:a,nullable:c,type:d.visit(b),children:(b.children||[]).map(e=>tl(e)),dictionary:J.isDictionary(b)?{id:b.id,isOrdered:b.isOrdered,indexType:d.visit(b.indices)}:void 0}}function ul(a,b,c=!1){const [d]=hl.Ga(new X({[b]:a}));return JSON.stringify({id:b,isDelta:c,data:{count:a.length,columns:d}},null,2)};function vl(a,b){function c(g,k){let n,q,t=g.desiredSize||null;for(;!(q=k.next(e?t:null)).done;)if(ArrayBuffer.isView(q.value)&&(n=p(Uint8Array,q.value))&&(t!=null&&e&&(t=t-n.byteLength+1),q.value=n),g.enqueue(q.value),t!=null&&--t<=0)return;g.close()}let d=null;const e=b?.type==="bytes"||!1,f=b?.highWaterMark||2**24;return new ReadableStream({...b,start(g){c(g,d||=a[Symbol.iterator]())},pull(g){d?c(g,d):g.close()},cancel(){d?.return&&d.return();d=null}},{highWaterMark:e?f:void 0,...b})}
function wl(a,b){async function c(g,k){let n,q,t=g.desiredSize||null;for(;!(q=await k.next(e?t:null)).done;)if(ArrayBuffer.isView(q.value)&&(n=p(Uint8Array,q.value))&&(t!=null&&e&&(t=t-n.byteLength+1),q.value=n),g.enqueue(q.value),t!=null&&--t<=0)return;g.close()}let d=null;const e=b?.type==="bytes"||!1,f=b?.highWaterMark||2**24;return new ReadableStream({...b,async start(g){await c(g,d||=a[Symbol.asyncIterator]())},async pull(g){d?await c(g,d):g.close()},async cancel(){d?.return&&await d.return();
d=null}},{highWaterMark:e?f:void 0,...b})};function xl(a,b,c){c!=null&&(a.ia>=c.desiredSize&&++a.Ya&&yl(a,c,b.toVector()),b.finished&&((b.length>0||a.Ya===0)&&++a.Ya&&yl(a,c,b.toVector()),!a.rb&&(a.rb=!0)&&yl(a,c,null)))}function yl(a,b,c){a.ia=0;a.ja=null;c==null?b.close():b.enqueue(c)}
class zl{constructor(a){this.Ya=0;this.rb=!1;this.ia=0;const {readableStrategy:b,writableStrategy:c,queueingStrategy:d="count",...e}=a;this.ja=null;this.ba=Qi(e);this.Ub=d!=="bytes"?Al:Bl;({highWaterMark:a=d==="bytes"?16384:1E3}={...b});const {highWaterMark:f=d==="bytes"?16384:1E3}={...c};this.readable=new ReadableStream({cancel:()=>{this.ba.clear()},pull:g=>{xl(this,this.ba,this.ja=g)},start:g=>{xl(this,this.ba,this.ja=g)}},{highWaterMark:a,size:d!=="bytes"?Al:Bl});this.writable=new WritableStream({abort:()=>
{this.ba.clear()},write:()=>{xl(this,this.ba,this.ja)},close:()=>{xl(this,this.ba.finish(),this.ja)}},{highWaterMark:f,size:g=>{const k=this.ia;this.ia=this.Ub(this.ba.append(g));return this.ia-k}})}}const Al=a=>a?.length??0,Bl=a=>a?.byteLength??0;function Cl(a,b){async function c(){return await (await Gk.from(e)).open(b)}async function d(k,n){let q=k.desiredSize,t;for(;!(t=await n.next()).done;)if(k.enqueue(t.value),q!=null&&--q<=0)return;k.close()}const e=new ji;let f=null;const g=new ReadableStream({async cancel(){await e.close()},async start(k){await d(k,f||=await c())},async pull(k){f?await d(k,f):k.close()}});return{writable:new WritableStream(e,{highWaterMark:16384,...a}),readable:g}};function Dl(a,b){async function c(f){let g,k=f.desiredSize;for(;g=await e.read(k||null);)if(f.enqueue(g),k!=null&&(k-=g.byteLength)<=0)return;f.close()}const d=new this(a),e=new mi(d);b=new ReadableStream({async cancel(){await e.cancel()},async pull(f){await c(f)},async start(f){await c(f)}},{highWaterMark:16384,...b});return{writable:new WritableStream(d,a),readable:b}};function El(a){a=Gk.from(a);return m(a)&&l(a.then)?a.then(b=>El(b)):a.isAsync()?a.readAll().then(b=>new hk(b)):new hk(a.readAll())};const Fl={...qc,...xi,...Ag,...Ie,...r,...rg,...cc,...Ci,compareSchemas:Zj,compareFields:function(a,b){return Wj.compareFields(a,b)},compareTypes:ak};ra=function(a,b){if(m(a)&&l(a[Symbol.asyncIterator]))return wl(a,b);if(m(a)&&l(a[Symbol.iterator]))return vl(a,b);throw Error("toDOMStream() must be called with an Iterable or AsyncIterable");};fh.throughDOM=function(a){return new zl(a)};Gk.throughDOM=Cl;Pk.throughDOM=Cl;Hk.throughDOM=Cl;nl.throughDOM=Dl;rl.throughDOM=Dl;ql.throughDOM=Dl;var Z={};Z.AsyncByteQueue=ji;Z.AsyncByteStream=mi;Z.AsyncMessageReader=uk;Z.AsyncRecordBatchFileReader=Qk;Z.AsyncRecordBatchStreamReader=Ok;Z.Binary=Oc;
Z.BinaryBuilder=Ii;Z.Bool=dd;Z.BoolBuilder=Ki;Z.BufferType=$b;Z.Builder=fh;Z.ByteStream=ki;Z.CompressionType=ib;Z.Data=O;Z.DataType=J;Z.DateBuilder=Li;Z.DateDay=pd;Z.DateDayBuilder=Mi;Z.DateMillisecond=qd;Z.DateMillisecondBuilder=Ni;Z.DateUnit=Ea;Z.Date_=ld;Z.Decimal=hd;Z.DecimalBuilder=Oi;Z.DenseUnion=ge;Z.DenseUnionBuilder=Hj;Z.Dictionary=ve;Z.DictionaryBuilder=Pi;Z.Duration=Od;Z.DurationBuilder=dj;Z.DurationMicrosecond=Ud;Z.DurationMicrosecondBuilder=gj;Z.DurationMillisecond=Td;
Z.DurationMillisecondBuilder=fj;Z.DurationNanosecond=Vd;Z.DurationNanosecondBuilder=hj;Z.DurationSecond=Sd;Z.DurationSecondBuilder=ej;Z.Field=T;Z.FixedSizeBinary=ie;Z.FixedSizeBinaryBuilder=Ri;Z.FixedSizeList=me;Z.FixedSizeListBuilder=Si;Z.Float=Hc;Z.Float16=Lc;Z.Float16Builder=Ui;Z.Float32=Mc;Z.Float32Builder=Vi;Z.Float64=Nc;Z.Float64Builder=Wi;Z.FloatBuilder=Ti;Z.Int=vc;Z.Int16=Ac;Z.Int16Builder=kj;Z.Int32=Bc;Z.Int32Builder=lj;Z.Int64=Cc;Z.Int64Builder=mj;Z.Int8=zc;Z.Int8Builder=jj;
Z.IntBuilder=ij;Z.Interval=Hd;Z.IntervalBuilder=Xi;Z.IntervalDayTime=Ld;Z.IntervalDayTimeBuilder=Yi;Z.IntervalMonthDayNano=Nd;Z.IntervalMonthDayNanoBuilder=cj;Z.IntervalUnit=y;Z.IntervalYearMonth=Md;Z.IntervalYearMonthBuilder=bj;Z.JSONMessageReader=vk;Z.LargeBinary=Sc;Z.LargeBinaryBuilder=Ji;Z.LargeUtf8=$c;Z.LargeUtf8Builder=Jj;Z.List=Wd;Z.ListBuilder=rj;Z.MapBuilder=sj;Z.MapRow=ag;Z.Map_=qe;Z.Message=Gh;Z.MessageHeader=F;Z.MessageReader=tk;Z.MetadataVersion=u;Z.Null=uc;Z.NullBuilder=tj;
Z.Precision=w;Z.RecordBatch=X;Z.RecordBatchFileReader=Pk;Z.RecordBatchFileWriter=rl;Z.RecordBatchJSONWriter=sl;Z.RecordBatchReader=Gk;Z.RecordBatchStreamReader=Hk;Z.RecordBatchStreamWriter=ql;Z.RecordBatchWriter=nl;Z.Schema=S;Z.SparseUnion=he;Z.SparseUnionBuilder=Gj;Z.Struct=K;Z.StructBuilder=uj;Z.StructRow=xf;Z.Table=hk;Z.Time=rd;Z.TimeBuilder=Aj;Z.TimeMicrosecond=xd;Z.TimeMicrosecondBuilder=Dj;Z.TimeMillisecond=wd;Z.TimeMillisecondBuilder=Cj;Z.TimeNanosecond=yd;Z.TimeNanosecondBuilder=Ej;
Z.TimeSecond=vd;Z.TimeSecondBuilder=Bj;Z.TimeUnit=x;Z.Timestamp=zd;Z.TimestampBuilder=vj;Z.TimestampMicrosecond=Fd;Z.TimestampMicrosecondBuilder=yj;Z.TimestampMillisecond=Ed;Z.TimestampMillisecondBuilder=xj;Z.TimestampNanosecond=Gd;Z.TimestampNanosecondBuilder=zj;Z.TimestampSecond=Dd;Z.TimestampSecondBuilder=wj;Z.Type=G;Z.Uint16=Ec;Z.Uint16Builder=oj;Z.Uint32=Fc;Z.Uint32Builder=pj;Z.Uint64=Gc;Z.Uint64Builder=qj;Z.Uint8=Dc;Z.Uint8Builder=nj;Z.Union=ce;Z.UnionBuilder=Fj;Z.UnionMode=v;Z.Utf8=Wc;
Z.Utf8Builder=Ij;Z.Vector=M;Z.Visitor=Ae;Z.builderThroughAsyncIterable=function(a){const {queueingStrategy:b="count"}=a,{highWaterMark:c=b!=="bytes"?Number.POSITIVE_INFINITY:16384}=a,d=b!=="bytes"?"length":"byteLength";return async function*(e){let f=0;const g=Qi(a);for await(const k of e)g.append(k)[d]>=c&&++f&&(yield g.toVector());if(g.finish().length>0||f===0)yield g.toVector()}};Z.builderThroughIterable=dk;Z.compressionRegistry=Fk;Z.makeBuilder=Qi;Z.makeData=P;
Z.makeTable=function(a){const b={};a=Object.entries(a);for(const [c,d]of a)b[c]=Xg(d);return new hk(b)};Z.makeVector=Xg;Z.tableFromArrays=function(a){const b={};a=Object.entries(a);for(const [c,d]of a)b[c]=bk(d);return new hk(b)};Z.tableFromIPC=El;Z.tableFromJSON=function(a){a=bk(a);a=new X(new S(a.type.children),a.data[0]);return new hk(a)};Z.tableToIPC=function(a,b="stream",c=null){return(b==="stream"?ql:rl).writeAll(a,{ra:c}).toUint8Array(!0)};Z.util=Fl;Z.vectorFromArray=bk;Object.assign(arguments[0],Z);}.bind(this))));

//# sourceMappingURL=Arrow.esnext.min.js.map
